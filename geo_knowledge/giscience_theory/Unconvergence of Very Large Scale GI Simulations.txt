arXiv:1612.06984v1  [astro-ph.EP]  21 Dec 2016
Publ. Astron. Soc. Japan (2014) 00(0), 1–5
doi: 10.1093/pasj/xxx000
1
Unconvergence of Very Large Scale GI
Simulations
Natsuki HOSONO1,2, Masaki IWASAWA,2, Ataru TANIKAWA3,2, Keigo
NITADORI2, Takayuki MURANUSHI2 and Junichiro MAKINO4,2,5
1Graduate School of Advanced Integrated Studies in Human Survivability, Kyoto University, 1
Nakaadachi-cho, Yoshida, Sakyo-ku, Kyoto 606-8306, Japan
2RIKEN Advanced Institute for Computational Science, 7-1-26 Minatojima-minami-machi,
Chuo-ku, Kobe, Hyogo, Japan
3Department of Earth and Astronomy, College of Arts and Science, The University of Tokyo,
3-8-1 Komaba, Meguro-ku, Tokyo, Japan
4Department of Planetology, Graduate School of Science Faculty of Science, Kobe University,
1-1, Rokkodai-cho, Nada-ku, Kobe, Hyogo 657-8501, Japan
5Earth-Life Science Institute, Tokyo Institute of Technology, 2-12-1 Ookayama, Meguro-ku,
Tokyo, Japan
∗E-mail: hosono.natsuki.2a@kyoto-u.ac.jp
Received 2016 December 9; Accepted 2016 December 21
Abstract
The giant impact (GI) is one of the most important hypotheses both in planetary science and
geoscience, since it is related to the origin of the Moon and also the initial condition of the
Earth. A number of numerical simulations have been done using the smoothed particle hydro-
dynamics (SPH) method. However, GI hypothesis is currently in a crisis. The “canonical” GI
scenario failed to explain the identical isotope ratio between the Earth and the Moon. On the
other hand, little has been known about the reliability of the result of GI simulations. In this
paper, we discuss the effect of the resolution on the results of the GI simulations by varying
the number of particles from 3 × 103 to 108. We found that the results does not converge, but
shows oscillatory behaviour. We discuss the origin of this oscillatory behaviour.
Key words: Moon — planets and satellites: formation — Earth
1 Introduction
The giant impact (GI) hypothesis plays an important role both in planetary science and geoscience. It was ﬁrst suggested as the origin
of the Moon by Hartmann and Davis (1975) and Cameron and Ward (1976). According to the GI scenario, a Mars-sized impactor
hits the proto-Earth and generates substantial amounts of the debris disc around the proto-Earth, which later accumulates into the
Earth’s Moon. Since this scenario can explain characteristic features of the current Earth-Moon system such as the large angular
momentum and the small core of the Moon, it has become widely accepted as the standard scenario for the formation of the Moon.
So far, a number of numerical simulations for this scenario have been carried out mainly by the smoothed particle hydrodynamics
(SPH; Lucy 1977; Gingold and Monaghan 1977) method (e.g., Benz et al. 1986; Canup and Asphaug 2001; Nakajima and Stevenson
2014).
However, the GI scenario is currently in a crisis; recent high-precision isotope ratio measurement revealed that the isotope ratios
c
⃝2014. Astronomical Society of Japan.

2
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
of the bulk of the Moon in several elements are very close to that of the Earth (e.g., Wiechert et al. 2001; Touboul et al. 2007; Georg
et al. 2007; Zhang et al. 2012). The proto-Earth and the impactor are likely to have different isotope ratios because the isotope ratio
of an object reﬂects the place where the object was formed. A simple explanation for this close agreement of the isotope ratios is
that the Moon was formed from a proto-Earth dominated disc. Previous studies based on numerical simulations, however, concluded
that the so-called “canonical” GI scenarios would result in impactor-dominated discs. This discrepancy should be resolved.
Lately, several re-investigations of numerical simulations of GI have been reported. Simulations with methods other than the stan-
dard SPH method have been done, e.g., static mesh (Wada et al. 2006), adaptive mesh (Canup et al. 2013) and Density Independent
SPH (DISPH; Hosono et al. 2016). Wada et al. (2006) concluded that the results with static mesh code were signiﬁcantly different
from those with the standard SPH. They, however, adopted much simpler equation of state to represent the bodies. Thus, it is not
straightforward to compare their results to those of other works. Canup et al. (2013) concluded that the results with adaptive mesh
give similar results to those with the standard SPH. Hosono et al. (2016) performed the numerical simulations of GI using DISPH,
an improved formulation of SPH, and concluded that DISPH tends to form more compact disc than the standard SPH does.
Resolution is also important for the validity of numerical simulations. Thus, it is very important to test the convergence in
terms of the resolution, namely, the dependence of the results on the number of SPH particles used in a simulation. We expect the
numerical solutions to converge to the physical solution, in the limit of the inﬁnite number of particles. Canup et al. (2013) varied
the number of particles from 104 to 106 and compared the results. They concluded that the predicted moon masses obtained from
each simulation are similar. However, if we closely investigate their results, we can see that the disc structures are rather different.
Teodoro et al. (2014) performed a much higher resolution run (108 particles). Unfortunately, however, they only showed snapshots
at the early stage of the impact. In order to test the numerical convergence, we need to follow for the longer time evolutions, at least
for 24 hrs.
In this paper, we present the results of GI simulations with up to 108 particles, focusing on the disc properties. This paper is
organised as follows. In section 2, we describe the numerical method. In section 3, we present the initial condition. In section 4, we
show the results of numerical simulations and also the analysis. In section 5, we summarise this paper.
2 Numerical Method
In this paper, we employed the standard SPH (for review, see Monaghan 1992). We adopted the Wendland C6 kernel and the number
of neighbour particles for each particle is ∼250. To handle the shock, we used Monaghan (1997)’s artiﬁcial viscosity. In order to
suppress spurious shear viscosity, we adapted the Balsara switch (Balsara 1995). We solve the self-gravity using the Barnes-Hut tree
algorithm (Barnes and Hut 1986). The opening angle for the self-gravity is set to 0.5.
In order to achieve efﬁcient parallelization, we applied “Framework for Developing Particle Simulator”1 (FDPS,
Iwasawa et al. 2015; Iwasawa et al. 2016). The central idea of FDPS is to separate a code into two parts: a complex part asso-
ciated with parallelization and another for the calculation of actual interactions between two particles. FDPS utilises the tree method
to search neighbour lists necessary for the hydrodynamical force and to calculate long-range force quickly. FDPS can take the full
responsibility for the parallelization.
3 Initial conditions
In numerical simulations of GI with SPH, each object is represented by a collection of SPH particles. For both the proto-Earth
and the impactor, we assumed that they are differentiated to 30% core (iron) and 70% mantle (granite). To represent granite and
iron, we used the Tillotson equation of state (Melosh 1989). We ﬁrst place equal-mass particles in 3D Cartesian lattice and then
let the particles relax to hydrostatic equilibrium by introducing the damping term (Monaghan 1994). The initial speciﬁc internal
energy for each particle is set to 0.1GM⊕/R⊕, where G, M⊕and R⊕are the gravitational constant, the mass of the current Earth
(6.0×1024 kg) and the radius of the current Earth (6400 km). The end time of this process is set to about ten times of the dynamical
time. At the end of this process, the velocity of each particle is of the order of 1% of the typical impact velocity (∼10 km/s). The
target-to-impactor mass ratio is assumed to be 0.1.
After this process, we performed the actual impact simulations. The initial angular momentum in the system is set to 1.2 times
the current angular momentum of the Earth-Moon system (3.5 × 1034 kgm2/s). The impactor velocity at inﬁnity is set to zero so
that the impactor takes a parabolic orbit. Neither objects have initial rotations.
In this paper, we focus on the effect of the resolution to the results. Hence, we ﬁxed the orbital parameter for all runs and varied
1 https://github.com/FDPS/FDPS

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
3
the resolutions, namely, the total number of particles N. In this paper, we show the results with N ∼3 × 103,104,3 × 104,105,3 ×
105,106,3 × 106,107,3 × 107 and 108.
4 Results
4.1 Predicted moon mass
In order to compare the results of runs with different numbers of particles quantitively, we use the predicted moon mass (e.g., Ida
et al. 1997; Kokubo et al. 2000; Canup and Asphaug 2001) deﬁned as
MM = 1.9
Ldisc
√GM⊕RRoche
−1.1Mdisc −1.9Mescape,
(1)
where Ldisc,RRoche,Mdisc and Mescape are the disc angular momentum, the Roche limit (∼2.9R⊕), disc mass and the mass which
will escape during the disc evolution. We assumed Mescape to be 0.05Mdisc following Canup and Asphaug (2001). The angular
momentum and mass of the disc are given by the sum of the angular momenta and the masses of disc particles.
Figure 1 shows the dependence of the disc quantities on the number of particles. From this ﬁgure we can classify the results
into four categories; very-low-resolution runs (N ≤104), low-resolution runs (3× 104 ≤N ≤105), high-resolution runs (3× 105 ≤
N ≤107) and ultra-high-resolution runs (3 × 107 ≤N). In the very-low-resolution regime, there is no clear dependence of results
to the resolution, since MM, Mdisc and Ldisc all behave differently. In the low-resolution regime, all show increase as the number of
particles is increased, and in the high-resolution regime, it seems all show convergence. However, this apparent convergence turns
out to be an illusion, when we further increase the number of particles and enter the ultra-high-resolution regime, where all values
are diverging with no sign of convergence. In the following, we investigate why this apparent unconvergence occurred in ultra-high
resolutions.
Figures 2a and b show the time evolutions of Ldisc/√GM⊕RRoche, Mdisc and MM for all runs. This ﬁgure clearly shows that,
in the very-low-resolution runs and low-resolution runs, the evolution of the disc depends on the resolution. In particular, very-low-
resolution runs show results quite different from the rest of runs for the whole simulation period [see the top panel of Fig. 2a]. This
means that in very-low-resolution runs the number of particles is not enough to resolve the early phase of the simulation, when the
impact itself took place (t < 3 hrs). On the other hand, low-resolution runs give similar results for the ﬁrst 7 hrs, which means that
the early phase is well resolved. After 7 hrs, however, the disc properties start to deviate.
On the other hand, high-resolution runs give very similar results. The disc properties at the end time of the simulations converge
to within less than 10% [see the bottom panel of Fig. 2b]. Ultra-high-resolution runs, however, again show the divergence of the
disc properties. If we closely inspect Fig. 2b, we ﬁnd that in all runs sudden decreases of Mdisc and Ldisc take place at t = 8 −9
hrs, and that time for N = 1 × 108 is the latest of all. Similar, but less clear changes are also visible for runs in Fig. 2a, except for
very-low-resolution runs. Thus, it seems that the mechanism of this sudden decrease might be related to the apparent unconvergence
of ultra-high-resolution runs. In the next subsection, we will investigate what physical mechanism caused these sudden changes and
why and how they depend on the resolution.
4.2 Formation and fallback of clumps
Figures 3 and 4 show the snapshots of the results for t < 10 hrs for each run and ﬁgure 5 shows the angular momentum distribution
of high- and ultra-high-resolution runs. In the case of very-low-resolution runs, no clump is formed in the orbit, while in other
runs a clump is formed in the orbit (see the panels from t = 5 to 7 hrs), which eventually falls back to the proto-Earth (t = 8 −9
hrs). However, the distributions of particles around the clumps depend on the resolution. In ultra-high-resolution runs, particles
with rather high angular momentum ahead of the clump (see the bottom-most row of Fig. 5). These particles affect the angular
momentum transfer between the clump and the disc. As a result, the time of the second collision of the clump depends on the
resolution. Once a clump is formed, the disc properties are controlled by the clump. Since the properties of a clump would depend
on the resolution of the disc, runs with different resolutions give different results.
Figure 6 shows the radial distribution of the cumulative mass for the runs with the number of particles greater than 106. At t = 1
hr, in all runs, the results are similar. In t ≥5 hrs, however, the differences in the distribution of the mass show up, which come from
the angular momentum transfer between the clump and the disc, as we stated above. In the run with 108 particles, since the clump
is more massive than those in the other runs, the disc loses more mass when the clump falls to the proto-Earth. Thus, the disc mass
for the run with 108 particles after the second collision is smaller than those in other runs (see Fig. 2b).

4
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
 0.8
 1
 1.2
 1.4
 1.6
 1.8
 2
mass
Very-low
Low
High
Ultra-high
 1.2
 1.4
 1.6
 1.8
 2
 3x103
 1x104  3x104
 1x105  3x105
 1x106  3x106
 1x107  3x107
 1x108
angular momentum
Number of particles
Fig. 1. Disc properties vs. number of particles. The upper panel shows the disc mass (blue circles) and predicted moon mass (red squares) normalised by
the current Lunar mass, while the lower panel shows Ldisc/p
GM⊕RRoche.
5 Summary
In order to investigate the effect of the resolution on results of numerical simulations of GI, we carried out runs with a wide range
of the number of particles with the standard SPH. The overall evolutions are similar. After the ﬁrst collision of the impactor, large
amounts of impactor debris are ejected to the orbit. The remnant of the impactor then forms a large clump in the orbit and then falls
back to the proto-Earth. This clump changes the detail of the behaviour of those of the properties of the disc, such as the angular
momentum distribution. Thus, a small change in the mass and behaviour of the clump caused a large variation in the disc mass and
the predicted moon mass. This is the reason why the result is apparently not converged for very large number of particles.
Note that our conclusion is consistent with previous work. Canup et al. (2013) performed runs with N = 104,105 and 106 and
concluded that the disc properties converged to within ∼10%. We, however, found that at the ultra-high-resolution regime, the
results change as the number of particles is increased.
The results we show here are certainly not the ﬁnal ones. Recently the reliability of the standard SPH was questioned in the
context of the treatment of the core-mantle boundary and free surface (Hosono et al. 2016). In order to test the reliability of
numerical simulations of GI, we need to combine scheme comparisons and resolution comparisons. We plan to perform runs with
108 (or higher) particles with the standard SPH and also DISPH.
Acknowledgement
We thank Yutaka Maruyama, Naohito Nakasato and Daisuke Namekata for the cooperations on FDPS. We also thank Miyuki
Tsubouchi for the management of the FDPS developing team. We are indebted to Takayuki R. Saitoh for his helpful discussion about
SPH. We used computational resources the K computer provided by the RIKEN Advanced Institute for Computational Science
through the HPCI System Research project (Project ID:ra000008).

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
5
 1
 2
 3
 4
 5
Mdisk
(a)Lower resolution
3x103
1x104
3x104
1x105
3x105
 1
 2
 3
 4
Ldisk / (G M⊕ RRoche)1/2
 1
 2
 3
 4
 8
 12
 16
 20
 24
MM
time (hrs)
Fig. 2a. Time evolutions of Mdisc, Ldisc/p
GM⊕RRoche, and MM normalised by the current Lunar mass, respectively. The meaning of symbols are
indicated in the top panel. The number of particles is 3 × 103 to 3 × 105.
References
Balsara, D. S. 1995, Journal of Computational Physics, 121, 357–372
Barnes, J., Hut, P. 1986, Nature, 324, 446–449
Benz, W., Slattery, W. L., Cameron, A. G. W. 1986, Icarus, 66, 515–535
Cameron, A. G. W., Ward, W. R. 1976, Vol. 7 of Lunar and Planetary
Science Conference
Canup, R. M., Asphaug, E. 2001, Nature, 412, 708–712
Canup, R. M., Barr, A. C., Crawford, D. A. 2013, Icarus, 222, 200–219
Georg, R. B., Halliday, A. N., Schauble, E. A., Reynolds, B. C. 2007,
Nature, 447, 1102–1106
Gingold, R. A., Monaghan, J. J. 1977, MNRAS, 181, 375–389
Hartmann, W. K., Davis, D. R. 1975, Icarus, 24, 504–514
Hosono, N., Saitoh, T. R., Makino, J., Genda, H., Ida, S. 2016, Icarus,
271, 131–157
Ida, S., Canup, R. M., Stewart, G. R. 1997, Nature, 389, 353–357
Iwasawa, M., Tanikawa, A., Hosono, N., Nitadori, K., Muranushi, T.,
Makino, J. 2015, WOLFHPC’15. ACM, New York, NY, USA, 1:1–
1:10
Iwasawa, M., Tanikawa, A., Hosono, N., Nitadori, K., Muranushi, T.,
Makino, J. 2016, ArXiv e-prints
Kokubo, E., Ida, S., Makino, J. 2000, Icarus, 148, 419–436
Lucy, L. B. 1977, AJ, 82, 1013–1024
Melosh, H. J. 1989, Impact cratering: A geologic process
Monaghan, J. J. 1992, ARA&A, 30, 543–574
Monaghan, J. J. 1994, Journal of Computational Physics, 110, 399–406
Monaghan, J. J. 1997, Journal of Computational Physics, 136, 298–307
Nakajima, M., Stevenson, D. J. 2014, Icarus, 233, 259–267
Teodoro, L. F. A., Warren, M. S., Fryer, C., Eke, V., Zahnle, K. 2014,
Vol. 45 of Lunar and Planetary Science Conference, 2703
Touboul, M., Kleine, T., Bourdon, B., Palme, H., Wieler, R. 2007, Nature,
450, 1206–1209
Wada, K., Kokubo, E., Makino, J. 2006, ApJ, 638, 1180–1186
Wiechert, U., Halliday, A. N., Lee, D.-C., Snyder, G. A., Taylor, L. A.,
Rumble, D. 2001, Science, 294, 345–348
Zhang, J., Dauphas, N., Davis, A. M., Leya, I., Fedkin, A. 2012, Nature
Geoscience, 5, 251–255

6
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
 1
 2
 3
 4
 5
Mdisk
(b)Higher resolution
1x106
3x106
1x107
3x107
1x108
 1
 2
 3
 4
Ldisk / (G M⊕ RRoche)1/2
 1
 2
 3
 4
 8
 12
 16
 20
 24
MM
time (hrs)
Fig. 2b. Same as Fig. 2a, but for N = 1 × 106 to N = 1 × 108.

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
7
Fig. 3. Snapshots from runs of GI. The snapshot time and number of particles are given in the left-top corner and right-top corner, respectively. Orange and
red particles indicate mantle particles of the proto-Earth and the impactor, respectively. Grey and black particles indicate core particles of the proto-Earth and
the impactor, respectively. An animation of this ﬁgure is available at https://vimeo.com/194156367.

8
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
Fig. 3. Continued.

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
9
Fig. 4. Same as Fig. 3, but reduces the number of plotted particles is reduced to 106. Only the results of higher resolution runs are shown.

10
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
Fig. 4. Continued.

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
11
Fig. 5. Same as Fig. 3, but shows the distributions of speciﬁc angular momentum (Ldisc/p
GM⊕RRoche). Only the particles within [−10,10] × [−10,10]
are shown.

12
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
1 h
2 h
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
Radius [RE]
3 h
Radius [RE]
4 h
Fig. 6. Radius vs. the cumulative mass from t = 1 to 10 hrs with an interval of 1 hr. The horizontal axis is shown in log scale. The colours for each curve are
the same to those of Fig. 2b.

Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
13
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
5 h
6 h
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
Radius [RE]
7 h
Radius [RE]
8 h
Fig. 6. Continued.

14
Publications of the Astronomical Society of Japan, (2014), Vol. 00, No. 0
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
9 h
10 h
1
1.02
1.04
1.06
1.08
1.1
Mass [ME]
Radius [RE]
11 h
Radius [RE]
12 h
Fig. 6. Continued.
