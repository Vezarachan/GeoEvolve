Nonparametric directional variogram estimation in the presence of
outlier blocks
Jana Gierse1* and Roland Fried1
1*Department of Statistics, TU Dortmund University, Vogelpothsweg 87, Dortmund, 44227,
North Rhine-Westphalia, Germany.
*Corresponding author(s). E-mail(s): gierse@statistik.tu-dortmund.de;
Contributing authors: fried@statistik.tu-dortmund.de;
Abstract
This paper proposes robust estimators of the variogram, a statistical tool that is commonly used in geostatis-
tics to capture the spatial dependence structure of data. The new estimators are based on the highly robust
minimum covariance determinant estimator and estimate the directional variogram for several lags jointly.
Simulations and breakdown considerations confirm the good robustness properties of the new estimators.
While Genton’s estimator based on the robust estimation of the variance of pairwise sums and differences
performs well in case of isolated outliers, the new estimators based on robust estimation of multivariate vari-
ance and covariance matrices perform superior to the established alternatives in the presence of outlier blocks
in the data. The methods are illustrated by an application to satellite data, where outlier blocks may occur
because of e.g. clouds.
Keywords: Breakdown point, MCD estimator, Robustness, Spatial data, Temporary changes
MSC Classification: 62H11 , 86A32
1 Introduction
Investigating spatial data, a basic objective is the determination of the spatial dependency between the data.
The variogram is a popular measure of spatial dependency and its estimation is therefore often one of the
first steps in spatial data analysis. The estimated variogram can be used for example for kriging, that is, for
prediction at unobserved locations.
Assuming {Z(s), s ∈I} with an index set I ⊂Rd to be an intrinsic stationary random field, its variogram
for a given lag h is
2γ(h) = Var (Z(s) −Z(s + h)) , for s, s + h ∈I.
Thereby, intrinsic stationarity means that the increments Z(s)−Z(s+h) are weakly stationary, with a constant
mean and translation-invariant covariance. A common additional assumption is that {Z(s), s ∈I} is mean
stationary.
The popular Matheron variogram estimator proposed by Matheron (1962) is defined as
2bγM(h) =
1
|N(h)|
X
(si,sj)∈N(h)
(Z(si) −Z(sj))2
1
arXiv:2412.01464v2  [stat.ME]  28 Mar 2025

with N(h) = {(si, sj) ∈I2 : sj −si = h} being the set of all pairs of locations with a distance of h and |N(h)|
being the cardinality of N(h). Especially for irregular grids N(h) is often extended to contain not only pairs
with distance exactly equal to h but also with a distance in a tolerance region T(h) around h. In case of mean
stationarity and without the consideration of tolerance regions T(h) this estimator is unbiased and consistent.
However, it is not robust as a single outlier can affect it heavily so that it gets worthless (Genton, 1998a).
Because of this deficiency, Cressie and Hawkins (1980) proposed taking the square roots of the differences
instead of their squares to reduce the effect of outliers. However, this estimator is not really robust either, since
the effect of a single outlier is not bounded (Genton, 1998a). More about this estimator and the Matheron
estimator e.g. regarding inference can be found in Bowman and Crujeiras (2013).
Genton (1998a) proposes usage of robust scale estimators like the highly robust and yet (under Gaussianity)
rather efficient Qn estimator introduced by Rousseeuw and Croux (1993) to obtain robust variogram estimators.
The resulting Genton variogram estimator is
2bγG(h) =

c · (|Vi(h) −Vj(h)| : i < j)(k)
2
with k =

[|N(h)|/2] + 1
2

, [a] denoting the integer part of a, c being a consistency factor, which is approximately
equal to 2.22 in large Gaussian samples, and (·)(k) denotes the k-quantile. Furthermore, Vi(h) is the i-th element
of the set V (h) = {Z(sl) −Z(sm) : (sl, sm) ∈N(h)} containing all differences for locations with distance h.
This estimator, in contrast is robust with a spatial breakdown point of at least 25% for two-dimensional data.
The spatial breakdown point reflects the fact that for spatial data the position of the outliers is important and
thus considers the worst spatial configuration for the outliers (Genton, 1998b; Lark, 2008).
Lark (2000) and Kerry and Oliver (2007) compare these estimators in the possible presence of isolated outliers
using simulations. Both works verify the robustness of the Genton estimator in such scenarios. Furthermore,
they find the Cressie estimator to be less influenced by outliers than the Matheron estimator the effects of
outliers are still noteworthy.
Our particular interest in this work is in spatially aggregated outliers that occur not isolated but in blocks
of several close-by outlying observations. Block outliers can be considered as spatial change-points in the data,
which have been considered recently in other contexts (Otto and Schmid, 2016; Garthoff and Otto, 2017). An
example of such outliers is clouds in satellite data. Consider for example data collected by the Landsat 8 satellite
belonging to the NASA Landsat project. This satellite collects data of the earth’s land surface on 9 different
spectral bands (Knight and Kvaran, 2014). Such data are strongly affected by weather effects. For example,
clouds lead to measurement problems across possibly large regions and therefore to contamination in the form
of outlier blocks. A further example of data with an outlier block is a soil survey with a leaking pipeline leading
to contamination in an area around the leak. Kerry and Oliver (2007) investigated the Matheron estimator
in the case of spatially aggregated outliers but did not consider the Genton estimator in this respect. In our
simulations, reported in Section 4.4, we find that this estimator is strongly influenced by block outliers.
A common assumption for random fields, usually made for convenience, is isotropy (Sherman, 2011, p. 87).
This means that the spatial dependency between two locations s, t ∈I only depends on the Euclidean distance
between s and t, but not on the direction. As mentioned in Sherman (2011, p. 87 ff.) falsely assuming isotropy
can lead to some undesirable effects in the analysis. The assumption of isotropy is not reasonable or at least
questionable in many applications. Considering, for example, crop yields, it is reasonable that the dependency
structure depends on the wind direction, since the wind is important for the transportation of the pollen (Guan
et al, 2004). Estimation of the dependency structure for different directions and therefore estimation of the
variogram in different directions is necessary to check for isotropy or to consider anisotropy in the analysis. We
focus here on the variogram estimation for anisotropic random fields.
We suggest two directional variogram estimators for data observed on a regular grid. Both estimators are
based on the highly robust Minimum Covariance Determinant (MCD) estimator of multivariate location and
scatter introduced by Rousseeuw (1985) and achieve robustness especially against block outliers. The MCD has
already been used in time series analysis to construct a robust autocorrelation estimator with good performance
in the presence of outlier patches (D¨urre et al, 2015). We use the MCD to construct variogram estimators which
jointly estimate the variogram at several spatial lags. Two different constructions are investigated here. The first
one is based on vectors of subsequent observations and estimates the variance and the covariances for different
lags using the MCD. In the second approach vectors of pairwise differences of the spatial process are built, so
that the variogram is directly captured on the main diagonal of the variance-covariance matrix of the vectors.
2

We investigate the efficiency and the robustness of these and other proposals in worst case and in block outlier
configurations in the following.
The rest of the paper is organized as follows. The MCD estimator is explained in Section 2. Section 3
describes the MCD based variogram estimators constructed here. We evaluate the estimators theoretically and
via simulation in Section 4. Section 5 contains an application to data taken by the Landsat 8 satellite. Section
6 provides a summary and an outlook.
2 MCD Estimator
The Minimum Covariance Determinant (MCD) estimator is an affine equivariant and highly robust estimator of
multivariate location and scatter, which was introduced by Rousseeuw (1985). The idea is to search for the k(n)
data points leading to the confidence ellipsoid with the smallest covariance determinant. The estimated location
is the center of this ellipsoid and the estimated covariance matrix reflects its shape. Given p−dimensional
data points x1, . . . , xn, the (raw) MCD location and scatter estimator using a tuning constant k(n) with
⌊(n+p+1)/2⌋≤k(n) ≤n is defined as follows (Hubert and Debruyne, 2010):
1. Search the k(n) observations for which the sample covariance matrix has minimal determinant.
2. Define bµ to be the mean of these k observations.
3. Set bΣ to the sample covariance matrix of these observations multiplied by a consistency factor c.
The consistency factor depends on the distribution of the data, on the dimension of the vectors, and on the
ratio of k(n) to n and ensures that the estimator is Fisher-consistent. For independent identically normally
distributed data the consistency factor is c = α/Fχ2
p+2(χ2
p,α) asymptotically, whereby α = limn→∞k(n)/n, Fχ2q is
the distribution function and χ2
q,α the α-quantile of the χ2−distribution with q degrees of freedom (Croux and
Haesbroeck, 1999). Pison et al (2002) determine additional finite-sample correction factors to correct bias in
small samples.
The MCD estimator of location and scatter is consistent and asymptotically normally distributed in case
of elliptical distributions (Butler et al, 1993). It is highly robust with a finite sample breakdown point of
[(n −p + 2)/2] /n, which is 0.5 asymptotically, if k(n) = [(n+p+1)/2] and the sample is in general position
(Roelant et al, 2009). Accordingly, almost half of the observations can be replaced by arbitrary values before the
estimator can exceed all bounds. Unfortunately, this estimator has rather low efficiency in case of an underlying
normal distribution if k(n) is chosen small to achieve high robustness. A reweighting step is often included to
increase the efficiency of the MCD while retaining its robustness widely. The reweighted MCD is defined as
bµ =
Pn
i=1 W(d2
i )xi
Pn
i=1 W(d2
i )
bΣ = c∗
1
n
n
X
i=1
W(d2
i ) (xi −bµ) (xi −bµ)T
with d2
i = (xi −bµ0)T bΣ
−1
0
(xi −bµ0), W(·) a weight function, bµ0, bΣ0 the initial MCD estimation, and c∗a
consistency factor. A common choice for the weight function is W(d2) = I
 d2 ≤χ2
p,0.975

with I(·) denoting an
indicator function. The reweighting step improves the efficiency of the estimator while retaining the breakdown
point, if the weight function is bounded and becomes zero for large distances di (Lopuha¨a and Rousseeuw, 1991;
Lopuha¨a, 1999).
Exact computation of the MCD estimator requires evaluation of all
  n
k(n)

subsets of size k(n) (Hubert and
Debruyne, 2010). In our simulations we use the FAST-MCD algorithm suggested by Rousseeuw and Driessen
(1999), which reduces the computation time a lot but does not necessarily lead to the global optimum. Further
algorithms have been suggested by Hawkins and Olive (2002), Hubert et al (2012) and Todorov (1992).
3 Directional MCD variogram estimator
Now we use the MCD estimator to estimate the variogram at several lags jointly. We consider two different
approaches to construct directional variogram estimations based on the MCD. In the first approach vectors of
3

pairwise differences are built such that the variogram is directly captured on the main diagonal of the variance-
covariance matrix (Section 3.1). In the second approach vectors of the data at different locations are built such
that the variogram can be calculated from the estimated variance-covariance matrix (Section 3.2).
The MCD variogram estimators are constructed for directional variogram estimation in the four directions
south-north (S-N), east-west (E-W), southwest-northeast (SW-NE) and southeast-northwest (SE-NW) under
the assumption of observing a random field {Z(s), s ∈I} on a two-dimensional regular grid I = {1, . . . , nx} ×
{1, . . . , ny} of size n = nx × ny. An example for data observed on a regular grid are satellite data. In the
following both MCD variogram estimators are explained for estimation in the E-W direction (along the x-axis).
Estimation in the other directions works analogously and is briefly explained at the end of both subsections.
3.1 MCD variogram estimator based on differences
Now consider an intrinsically stationary and mean stationary random field Z(s). For the MCD variogram
estimator based on differences (MCD.diff) vectors of differences between the observations are built such that the
main diagonal of the estimated variance-covariance matrix captures the variogram up to the lag vector hhmax.
More precisely, vectors with the following structure are built
W =





Z(s) −Z(s + h1)
Z(s) −Z(s + h2)
...
Z(s) −Z(s + hhmax)





(1)
for lag vectors h1, . . . , hhmax as described in Section 3.1. Due to the assumption of intrinsic stationarity all
vectors with this form have the same covariance matrix. Thereby, the variance of the first component equals
the variogram at lag h1, the variance of the second component the variogram at lag h2, and so on.
The lag vectors hl = (l, 0)T , l = 1, . . . , hmax, for estimation in the E-W direction lead to the nW =
ny · (nx −hmax) vectors



Z((x1, y1)T ) −Z((x2, y1)T )
...
Z((x1, y1)T ) −Z((xhmax+1, y1)T )


, . . . ,



Z((xnx−hmax, yny)T ) −Z((xnx−hmax+1, yny)T )
...
Z((xnx−hmax, yny)T ) −Z((xnx, yny)T )



The first component is a pairwise difference of the process for two locations with an Euclidean distance of
||h1|| = 1 in E-W direction, the second component a pairwise difference for lag ||h2|| = 2 in the same direction
and so on. The variance-covariance matrix of these vectors is estimated using the MCD estimator. MCD.diff is
then given by
(2bγ(h1), . . . , 2bγ(hhmax))T = diag

bΣMCD

.
For estimation of the variogram in one of the other directions the vectors are adapted such that the l-th
component of each vector is a pairwise difference for lag hl, l = 1, . . . , hmax in the desired direction.
3.2 MCD variogram based on the original data
For the first approach, which is called MCD.org in the following, we need the assumption that Z(s) is weakly
stationary, i.e., that it is mean stationary and that the covariances are translation-invariant. This is somewhat
stronger than the assumption of intrinsic stationarity assumed e.g. for the Matheron estimator. The n = nx · ny
spatial coordinates are labeled with s1 = (x1, y1)T , . . . , sn = (xnx, yny)T . Thereby let xi, i = 1, . . . , nx, be the
east-west coordinate (on the x-axis) and yj, j = 1, . . . , ny, the north-south coordinate (on the y-axis).
Under the assumption of weak stationarity we have the following relationship between covariances of the
process and the variogram
2γ(h) = 2[Var(Z(s)) −Cov(Z(s), Z(s + h))].
(2)
4

Therefore, a variogram estimation can be derived from estimations of the variance and the covariance. If hmax
is the number of lags to be estimated, hmax + 1 dimensional vectors with the following structure are built
V =





Z(s)
Z(s + h1)
...
Z(s + hhmax)




,
(3)
with h1, . . . , hhmax being lag vectors in one of the four directions. The choice of hmax depends on the data and
the aim of the analysis. However, hmax should not be larger than necessary, because the higher hmax the fewer
vectors are available for the estimation. We consider equidistant choices h1, . . . , hhmax here, but other choices
are also possible. For estimation in the E-W direction e.g. we use the vectors hl = (l, 0)T , l = 1, . . . , hmax. In
this case, hmax = ||hhmax|| holds. Due to the assumption of translation-invariant covariances, these vectors have
the variance-covariance matrix
ΣV =









a0
a1 a2 . . . ahmax
a1
a0
... ...
...
a2
... ... ...
a2
...
... ... ...
a1
ahmax . . . a2 a1
a0









∈R(hmax+1)×(hmax+1)
(4)
with a0 = Var(Z(s)), a1 = Cov(Z(s), Z(s + h1)), a2 = Cov(Z(s), Z(s + h2)) and so on. We apply the raw or
the reweighted MCD estimator to estimate the variances and covariances in this matrix and use formula (2) to
obtain the variogram estimation.
For estimation in E-W direction we have the following nV = ny · (nx −hmax) vectors available:



Z((x1, y1)T )
...
Z((xhmax+1, y1)T )


, . . . ,



Z((xnx−hmax, y1)T )
...
Z((xnx, y1)T )


, . . . ,



Z((xnx−hmax, yny)T )
...
Z((xnx, yny)T )



Thus, for each y-coordinate in north-south direction we build vectors with hmax + 1 subsequent observations in
the E-W direction. The MCD estimator is then used to estimate the variance-covariance matrix of the vectors.
As seen in formula (4), several different estimations for the variance of the process are obtained on the main
diagonal and several estimations for the covariance at lag ||hl|| on the l-th minor diagonal. By averaging the
different estimates and using formula (2) we obtain estimations bγ(hl), l = 1, . . . , hmax.
Directional variogram estimations in S-N, SW-NE or SE-NW direction can be calculated analogously. For
this we build vectors with the structure of formula (3) with h1, . . . , hhmax being lag vectors in the direction of
interest. For estimation in north-south direction, e.g., vectors of subsequent observations in north-south direction
are constructed for each west-east coordinate. For the estimation in SW-NE hl = (l, l)T , l = 1, . . . , hmax and for
the estimation in SE-NW hl = (l, −l)T , l = 1, . . . , hmax. Note, in these two cases hmax ̸= ||hhmax||.
4 Evaluation of the estimators
In the following we evaluate characteristics of the estimators such as efficiency, consistency and robustness
as measured e.g. by breakdown points. Theoretical derivations are difficult due to the spatial dependency of
the data and the complexity of the MCD estimator. Therefore we use some simplifications in the theoretical
considerations and additional simulations to investigate the behavior of the estimators and compare them to
the common Matheron and Genton variogram estimators.
In the simulations we consider a Gaussian random field Z(s) on a two-dimensional regular grid of size 15×15
corresponding to a total sample size of n = 225 observations with a geometric anisotropic variogram. Geometric
anisotropy means that the dependence structure can be converted to an isotropic one through rotation with
angle and rescaling of the coordinate axes. The rotation matrix R, the rescaling matrix T and the variogram
5

are given by
R =

cos(θ)
sin(θ)
−sin(θ) cos(θ)

,
T =
 
1 0
0 1
b
1
2
!
,
2γ(h) = 2γ0
p
hT RT T T T Rh

with 2γ0(·) an isotropic variogram (Sherman, 2011, pp. 91).
For the isotropic variogram 2γ0(||h||) we choose a spherical variogram with a range R = 5 and a sill β = 2. The
rotation angle θ is 3·π/8 and the ratio b is equal to 2. The formula of the spherical variogram is
2γ0(||h||) = β
3||h||
2R
−||h||3
2R3

I(0 < ||h|| < R) + βI(||h|| ≥R).
The variogram for the different directions is illustrated in Figure 1. For the directions E-W and S-N lags up to
hmax = 7, with ||h7|| = 7, are chosen. For the SW-NE and SE-NW direction we set hmax = 5 and use, e.g.,
the vectors hi = (i, i)T , i = 1, . . . , 5 with ||h5|| = 7.07 for the SW-NE direction. Therefore, for the E-W and
SE-NW direction the largest estimated lag is smaller than the range of the true variogram, while for the S-N
and SW-NE direction the largest estimated lag is higher than the range. In all simulations 1000 samples are
used for each setting. Our aim is the estimation of the variogram γ(h) of the process Z(s).
The simulations are performed on a HPC cluster using the software R 4.4.0 (R Core Team, 2024). The R-
package RandomFields (Schlather et al, 2020) is used for the simulation of the Gaussian random field. The
MCD estimator is calculated using robustbase (Maechler et al, 2021). All values are rounded to 2 decimal
places. MCD.org.re and MCD.diff.re are in the following the MCD variogram estimators using the reweighted
version of the MCD estimator. In further simulations not presented here, we considered further grid sizes, other
variogram models and different values of hmax. The results are qualitatively similar to the results presented in
the following. In graphical illustrations, we connect the point estimations for different lags by a line to improve
the visualization.
0.5
1.0
1.5
2.0
0.0
2.5
5.0
7.5
10.0
12.5
||h||
2γ(h)
direction
E−W
S−N
SE−NW
SW−NE
Fig. 1 Geometric anisotropic spherical variogram for different directions used for the generation of the data
4.1 Correction factors
The MCD scale estimation needs to be multiplied with a consistency factor, which depends on the distribution
of the data and the dimension of the vectors (Croux and Haesbroeck, 1999). For small sample sizes Pison et al
(2002) derive an additional finite-sample correction factor for the MCD scale, which depends on the sample size
and correct the bias for small samples. Due to the spatial dependency of the data theoretical derivation of a
consistency factor for MCD.org and MCD.diff are difficult. Therefore, we use the consistency factor of the MCD
estimator for normally distributed data here. In simulations we see that these correction factors work well also
in our context, particularly if the size of the grid is large.
6

direction
estimator
S-N
E-W
SW-NE
SE-NW
Matheron
1.00
1.00
1.00
1.00
Genton
1.03
1.03
1.02
1.03
MCD.diff
0.96
0.97
0.90
0.91
MCD.diff.re
1.19
1.17
1.19
1.16
MCD.org
0.95
0.96
0.88
0.91
MCD.org.re
1.20
1.18
1.19
1.19
Table 1 Simulated finite sample correction factors
for the variogram estimators in all four directions in
case of a regular 15× 15 grid
We derive additional finite-sample bias correction factors for variogram estimation by MCD.org and MCD.diff
using simulations for further improvement, particularly in case of small grids. These factors are to be applied
in addition to the asymptotic correction factors. For the sake of fairness in the following simulations, we also
determine such correction factors for the Matheron and the Genton estimator. For this we generate 1000 samples
for each of several scenarios. Let bγl(hi) be the semivariogram estimation for lag hi, i = 1, . . . , hmax and dataset
l = 1, . . . , 1000. Then our simulated correction factors are obtained as
copt =
 
1
hmax
hmax−1
X
i=1
1
1000
1000
X
l=1
bγl(hi)
γ(hi)
!−1
.
(5)
We only average over all lags except the largest one because all robust estimators investigated here (including
the one of Genton) reflect the correct shape of the true variogram for small lags but not for large lags. Especially
for the largest lag the estimators generally underestimate the true variogram. Averaging across all lags would
thus lead to worse results.
The simulated finite sample correction factors are reported for all estimators and all four directions in Table
1. For the raw MCD estimators (MCD.org and MCD.diff) the simulated factors for the E-W and S-N direction
are similar and a little higher than those for the SW-NE and SE-NW direction. Due to the rotational symmetry
of the grid the same number of vectors can be built for estimation in E-W and S-N direction, which is larger
than that for estimation in SW-NE and SE-NW direction (see Table 1 in the appendix). The correction factors
for these estimators seem to depend on the number of vectors. The simulated values for the reweighted versions
MCD.org.re and MCD.diff.re are similar for all four directions. They are higher than those for the raw estimators
and in particular, they are larger than 1. The reweighted MCD estimators underestimate the variogram, whereas
the raw MCD estimators overestimate.
In Table 2 in the appendix the simulated correction factors for two other variogram models are shown. The
left half is for an exponential variogram model and the right half for a Gaussian variogram model. We see that
especially for the reweighted estimators the correction factors depends on the unknown true variogram model,
and this also applies to the Genton estimator. For the raw MCD estimators the influence of the unknown true
model seems to be small. Further simulations not reported here indicate that the correction factor is mostly
determined by the number of vectors available for the estimation, which depends on the grid size, by hmax and
the direction. The more vectors can be built, the closer the additional finite-sample correction factor gets to 1.
For large grids like a 50 × 50 grid the simulated correction factors for all estimators are almost equal to one and
can thus be ignored, irrespective of the true variogram model.
Note that these additional correction factors are not far from 1 especially for the raw MCD estimators, i.e.,
neglecting them just results in a small positive bias.
4.2 Gaussian data
We first consider simulation results for non-contaminated Gaussian random fields as described at the beginning
of Section 4. Figure 2 shows the estimated bias and Figure 3 the root of the mean square error rMSE for the
estimation in all four directions of the Matheron estimator, the Genton estimator, the raw MCD estimators
(MCD.org and MCD.diff) and the reweighted MCD estimator (MCD.org.re and MCD.diff.re). In Figure 1 we
see that the variograms for the E-W and the SE-NW direction are almost identical, and the same applies to the
variograms for the S-N and SW-NE direction. This also applies to the bias. The estimated bias and rMSE for
the E-W and SE-NW direction (Figure 2 a, c and 3 a, c) are similar, just like the estimated bias for the S-N
and SW-NE direction (Figure 2 b, d and 3 b, d). This matches the true variograms for the different directions
7

(see Figure 1), because the true variogram of the S-N and SW-NE direction are the same, just like the true
variogram for the E-W and the SE-NW direction.
Figure 2 shows that the Matheron estimator is nearly unbiased for all lags and all directions, while the other
estimators show some bias and underestimate for lager lags. Considering first the E-W and SE-NW direction, we
see that the Genton estimator is nearly unbiased for small lags and underestimates the true variogram for lager
lags. The raw and the reweighted MCD.diff estimator in these two directions have a bias similar to that of the
Genton estimator. In contrast, MCD.org and MCD.org.re are also nearly unbiased for small lags but strongly
underestimate for the largest lag for estimation in these two directions. It seems that these two estimators have
a problem with estimating the largest lag if hmax is smaller than the range of the true variogram. For the other
two directions S-N and SW-NE all estimators except the Matheron estimator overestimate the variogram slightly
for small lags and underestimate for lager lags. Especially for the larger lags the Genton estimator shows smaller
bias than the MCD estimators but the differences are small. In general, the bias of the raw MCD estimators
(MCD.org and MCD.diff) and the reweighted MCD estimators (MCD.org.re and MCD.diff.re) are very similar.
−0.6
−0.4
−0.2
0.0
2
4
6
||h||
Bias
a
−0.6
−0.4
−0.2
0.0
2
4
6
||h||
Bias
b
−0.6
−0.4
−0.2
0.0
2
4
6
||h||
Bias
c
−0.6
−0.4
−0.2
0.0
2
4
6
||h||
Bias
d
estimator
Genton
Matheron
MCD.diff
MCD.diff.re
MCD.org
MCD.org.re
Fig. 2 Estimated bias of the variogram estimation in E-W (a), S-N (b), SE-NW (c) and SW-NE (d) direction by several estimators
Figure 3 illustrates that the Matheron estimator is the most efficient estimator in terms of the rMSE in case
of observations from a Gaussian random field without outliers. The rMSE of the Genton estimator is close to that
of the Matheron estimator. The MCD based estimators are less efficient than these, but the reweighting reduces
this loss substantially. MCD.org turns out to be more efficient than MCD.diff in all situations considered here.
8

0.0
0.5
1.0
2
4
6
||h||
MSE
a
0.0
0.5
1.0
2
4
6
||h||
MSE
b
0.0
0.5
1.0
2
4
6
||h||
MSE
c
0.0
0.5
1.0
2
4
6
||h||
MSE
d
estimator
Genton
Matheron
MCD.diff
MCD.diff.re
MCD.org
MCD.org.re
Fig. 3 Root mean squared errors of the variogram estimations in E-W (a), S-N (b), SE-NW (c) and SW-NE (d) direction
4.3 Consistency
The consistency of MCD based variogram estimation can be argued analytically under some assumptions con-
cerning the dependence structure and some modification. In this subsection we assume my−dependence in the
north-south direction and mx−dependence in the east-west direction for some positive integers mx and my, and
we consider variogram estimation in the latter direction. Z((x, y)T ) and Z((x + h, y)T ) are independent then
for ||h|| > mx. Modified versions of the two MCD variogram estimators, which skip my rows and use only non-
overlapping vectors with a minimal difference of mx + 1 between the components of different vectors in E-W
direction, can easily be seen to be consistent as nx · ny increases to infinity because of the consistency of the
MCD when applied to independent vectors (Butler et al, 1993).
Such modified estimators use only a small part of the available observations and of the possible vectors
we can built. The efficiency can be increased by averaging the results across all the different possibilities to
choose independent vectors for such modified MCD variograms. For example, for estimation in E-W direction
we can build non-overlapping vectors with a minimal distance of mx + 1 starting the first vector in each row
with Z((1, y)T ), or we can shift all vectors starting the first vector with Z((2, y)T ), etc., and similarly we can
select different subsets of independent rows from the grid. The average of the resulting different modified MCD
variogram estimations will again be consistent in such scenarios as the mean of consistent estimators is also
consistent. Thereby, a set of independent vectors is only used if it consists of more than 2·hmax vectors to avoid
singularity problems with the MCD estimator. A drawback of this approach are that knowledge of suitable values
mx and my is needed. Another more relevant drawback is reduced robustness as compared to the estimators
defined in Section 3, as we will see in Table 3 in Subsection 4.4. We nevertheless consider this (averaged and)
modified MCD based variance estimator as a theoretically more tractable and consistent benchmark in the
following.
We investigate the behavior of all estimators including the average modified versions (name affix ”.mod”)
for increasing grid sizes and the isotropic Gaussian process described at the beginning of Section 4. The average
modified versions need knowledge of mx and my. Here we use the true values mx = 8 and my = 5. The different
9

grid sizes and the corresponding number of vectors used in the multivariate estimations can be found in Table
1 in the appendix.
−0.25
0.00
0.25
0.50
Matheron
Genton
MCD.diff
MCD.diff.mod
MCD.diff.re
MCD.diff.mod.re
MCD.org
MCD.org.mod
MCD.org.re MCD.org.mod.re
estimator
estimation error
(1,0)T
−1
0
1
2
3
4
Matheron
Genton
MCD.diff
MCD.diff.mod
MCD.diff.re
MCD.diff.mod.re
MCD.org
MCD.org.mod
MCD.org.re MCD.org.mod.re
estimator
estimation error
(4,0)T
−2
0
2
4
6
Matheron
Genton
MCD.diff
MCD.diff.mod
MCD.diff.re
MCD.diff.mod.re
MCD.org
MCD.org.mod
MCD.org.re MCD.org.mod.re
estimator
estimation error
(7,0)T
grid
15x15
25x25
50x50
75x75
Fig. 4 Boxplots of the estimation errors obtained by several estimators including the average modified versions in case of different
grid sizes and three different lag vectors for the estimation in E-W direction in case of data from a Gaussian model
Figure 4 shows boxplots of the resulting estimation errors for the E-W direction and three different lags.
The variances of these errors are larger for higher lags, but all the variances decrease as the grid size increases.
For small grid sizes, the Matheron and the Genton estimators have much smaller variances than those based on
the MCD. Concerning bias, the Matheron estimator shows the best behavior in general. The average modified
MCD estimators (name affix ”.mod”) show especially for small grid sizes a smaller variance than MCD.org
and MCD.diff. The multivariate estimators based on the original data (raw and reweighted MCD.org and
MCD.org.mod) have particularly for small grid sizes smaller variance than the multivariate estimators based
on differences (raw and reweighted MCD.diff and MCD.diff.mod). Reweighting (name affix ”.re”) improves the
efficiency of the multivariate estimators introduced in Section 3 as it reduces the variance without increasing the
bias. The estimators get approximately unbiased as the grid size increases, except for the raw and the reweighted
MCD.org and MCD.org.mod which underestimate the true variogram at the largest lag for all grid sizes. In
E-W direction ||hhmax|| is smaller than the range of the true variogram. As already seen in subsection 4.2, the
multivariate estimator based on the original data has problems with estimating the largest lag in such cases.
10

−2
0
2
4
6
Matheron
Genton
MCD.diff
MCD.diff.mod
MCD.diff.re
MCD.diff.mod.re
MCD.org
MCD.org.mod
MCD.org.re MCD.org.mod.re
estimator
estimation error
(0,7)T
grid
15x15
25x25
50x50
75x75
Fig. 5 Boxplot of the estimation errors in S-N direction for several estimators including the average modified versions for different
grid sizes and the lag vector h = (0, 7)T
Figure 5 shows boxplots of the estimation errors for the largest lag vector (0, 7)T in S-N direction. In this
case ||hhmax|| is larger than the range of the true variogram. For this case the multivariate MCD estimators
based on the original data are also unbiased for large grid sizes. As the true range of the variogram is unknown
it might be beneficial to ignore the largest estimated lag for MCD.org and MCD.org.re.
4.4 Contamination with block outliers
Now we investigate the robustness of the estimators against outliers, starting with the breakdown point of the
modified MCD.org and MCD.diff estimators. We consider directional variogram estimation, building the vectors
e.g. row by row for estimation in E-W direction. For the reason of simplicity we look at the one-dimensional
case ny = 1, so that the number of data points is n = nx. An outlier block then corresponds to a sequence of
subsequent outliers, which could be caused by a temporary level shift or by measurement problems resulting in
a stretch of data with another level or a higher variance. We investigate the worst case to find the finite sample
explosion breakdown point. Therefore, we determine the minimal length of an outlier block which can cause
arbitrarily large values of the estimator.
We start with the modified version of the MCD based estimators introduced in Subsection 4.3. Assuming an
m-dependent process we build vectors with a minimal distance of m + 1 between subsequent vectors. We can
build up to n∗= ⌊nx−hmax–1
hmax+1+m +1⌋non-overlapping vectors with hmax being the maximal lag we want to estimate.
Here and in the following we assume these vectors to be in general position, so that the MCD scatter estimator
with k = ⌊n+p+1
2
⌋has the maximal finite sample breakdown point of εMCD = n−k+1
n
. Thereby, n is the number
of vectors, k the size of the subsets considered by the MCD estimator and p the dimension of the vectors (Roelant
et al, 2009). Here, n = n∗and p = hmax + 1 if the modified MCD.org is used and p = hmax if the modified
MCD.diff is used. The number ℓ∗of disturbed vectors needs to be at least ⌈εMCD · n∗⌉= n∗−⌊n∗+p+1
2
⌋+ 1
to carry the estimator beyond all bounds. To disturb ℓ> 1 vectors the block must at least have a length of
lℓ= 1 + (ℓ−2)(m + hmax + 1) + m + 1 because the vectors have a distance of m. The minimal block length
disturbing ℓ∗vectors is determined by lℓ∗= ln∗−⌊n∗+p+1
2
⌋+1. This leads to the following breakdown point due
to one block,
εBlock
mod =
ln∗−⌊n∗+p+1
2
⌋+1
nx
= 1 + (n∗−⌊n∗+p+1
2
⌋−1)(m + hmax + 1) + m + 1
nx
,
which depends on hmax, nx, m and p. The larger hmax and m, the smaller n∗and the breakdown point. If hmax
and m are large and nx is rather small, the lower bound of εBlock
mod
becomes small. In case of nx = 50, m = 1
and hmax = 4, we get n∗= 8. This leads to the breakdown point εBlock
mod
=
3
50 = 0.06 (MCD.org.mod) and
εBlock
mod
=
9
50 = 0.18 (MCD.diff.mod). Furthermore we must choose hmax carefully to ensure that n∗is larger
than the dimension of the vectors hmax + 1. In case of nx = 50, m = 5 and hmax = 6 lags, we only can build 4
vectors for the modified MCD and cannot use this estimator. Averaging the estimates obtained from different
partitions as suggested in Subsection 4.3 does not change this value.
11

Next we discuss explosion of MCD.org and MCD.diff in case of an outlier sequence in one-dimensional data.
A sequence of l outliers disturbs up to hmax + l vectors, and the number of vectors which can be built is
n∗= nx −hmax. Thus hmax + l needs to be at least equal to ⌈εMCD · n∗⌉= n∗−⌊n∗+p+1
2
⌋+ 1 to break the
estimator. This corresponds to a minimal sequence length lmin = n∗−⌊n∗+p+1
2
⌋+ 1 −hmax and the following
explosion breakdown point due to an outlier block
εBlock
MCD.var = lmin
nx
= n∗−⌊n∗+p+1
2
⌋+ 1 −hmax
nx
.
In case of nx = 50 and hmax = 4 we have εBlock
MCD.var = 0.34 for MCD.org and εBlock
MCD.var = 0.36 for MCD.diff,
which is much higher than the bounds for the modified estimators derived above. The larger hmax, the smaller
get these lower bounds for explosion breakdown.
Finally, we consider breakdown of the Genton estimator for such scenarios, i.e. in the one dimensional case.
This estimator treats each lag separately. Let h be the lag for which we want to estimate the variogram. An
outlier block of length l disturbs at most l + min(l, h) differences. We can build n⋆= nx −h differences for the
estimation at lag h. The Genton estimator applies the Qn estimator of Rousseeuw and Croux (1993) with the
finite sample explosion breakdown point εQn = ⌊n⋆+1
2
⌋/n⋆to these differences. The minimal number of differences
which needs to be contaminated for breakdown is ⌈εQn · (nx −h)⌉. The minimal length of an outlier block to
break the estimator thus is lmin = max{⌈εQn · (nx −h)⌉−h, ⌈εQn · (nx −h)⌉/2}. This leads us to
εBlock
Genton(h) = lmin
nx
= max{⌈εQn · (nx −h)⌉−h, ⌈εQn · (nx −h)⌉/2}
nx
.
In case of nx = 50 and h = 4 we have εQn = 0.5, lmin = 19 and therefore εBlock
Genton(4) = 0.38, which is similar to
the breakdown points for MCD.org and MCD.diff.
These considerations correspond to breakdown points in the one dimensional case. Moreover, the Qn under-
lying the Genton estimator is known to show a noteworthy bias already in case of contamination rates much
smaller than its breakdown point. Now we investigate the performance of the estimators in several 2-dimensional
block outlier scenarios via simulations. We consider the following statistical model with several contamination
rates and contamination distributions with different expectations and variances. The process of interest is the
Gaussian Random Field Z(s) described at the beginning of Chapter 3. But instead of Z(s) we observe a Process
Y (s). For each location s0 = (x0, y0)T we define a block neighborhood N(s0) containing ⌈ϵ · n⌉locations, where
ϵ the fraction of outliers. This neighborhood is selected to be as quadratic as possible with s0 being as central
as possible. Furthermore, let W ∼N(µ0, σ2
0) be a normally distributed random variable, which describes the
outlier distribution, and I a discrete random variable with a uniform distribution on all locations s1, . . . , sn. I
selects one location s0 = (x0, y0)T randomly and all locations in N(s0) belong to a block of substitutive outliers.
The observed Process Y (s) is defined as
Y (s)|(I = s0) =
(
Z(s),
if s /∈N(s0)
W,
if s ∈N(s0).
We positioned the outlier block randomly since simulations not reported here revealed that the position of the
outlier block influences the performance of the estimators. We obtained similar results in case of additive instead
of substitutive outliers.
Table 3 in the appendix reports the bias and the rMSE of the estimations in E-W and S-N direction for
different contamination rates ϵ and different contamination distributions. The best result for each scenario and
each lag is underlined. As expected, the higher the contamination rate and the more extreme the contamination
distribution, the larger get the biases. The biases of the Genton and even more the Matheron estimator increase
more than those of the MCD based estimators, with the reweighted MCD.org delivering the best results regarding
both bias and rMSE in most cases. Here, reweighting improves the variance without increasing the bias. However,
the reweighted estimators have the disadvantage that the correction factors depend on the true variogram
model for small grid sizes, whereas this dependence is much lower for the other estimators. The modified MCD
estimators described in Section 4.3 perform in some cases even worse than the Matheron estimator. The modified
MCD estimators are in most cases less robust than the MCD estimators described in section 3. Due to this
inferior performance, the modified versions will not be investigated further.
12

−0.5
0.0
0.5
1.0
2
4
6
||h||
Bias
a
−0.5
0.0
0.5
1.0
2
4
6
||h||
Bias
b
0
1
2
2
4
6
||h||
Bias
0
1
2
2
4
6
||h||
Bias
1
2
3
4
2
4
6
||h||
Bias
1
2
3
4
2
4
6
||h||
Bias
estimator
Genton
Matheron
MCD.diff
MCD.diff.re
MCD.org
MCD.org.re
Fig. 6 Bias estimation for a (15 × 15) regular grid and an outlier block from the N(3, 1) distribution with ϵ = 5% (first row),
ϵ = 15% (second row) and ϵ = 25% (third row) and for E-W direction (a) and S-N direction (b)
Figure 6 displays the bias of the different variogram estimators for a N(3, 1) distributed outlier block and a
contamination rate of 5% (first row), 15% (second row) and 25% (third row) for the estimation in E-W direction
(a) and S-N direction (b). Again we observe that the higher the contamination rate, the larger is the bias of
the estimators. The Matheron estimator and the Genton estimator are strongly influenced already by a small
outlier block. The differences between the MCD based estimators are not very large, with reweighting reducing
their bias. The reweighted MCD.org shows in general the smallest bias. As already seen in Sections 4.3 and 4.2,
the raw and the reweighted MCD.org have problems estimating the largest lag especially if ||hhmax|| is smaller
than the range of the variogram (E-W direction).
Figure 7 depicts the bias of the variogram estimations for estimation in SW-NE(a) and SE-NW (b) direction
in case of 10% contamination from three different contamination distributions, namely N(3, 1) in the first row,
N(5, 1) in the second row and N(0, 4) in the third row. Thereby, Figure 7 shows the same behavior as Figure 6. In
all situations the MCD based estimators are less biased than Matheron and Genton, with reweighting reducing
the bias. The bias of the reweighted MCD.org is somewhat smaller than that of the reweighted MCD.diff.
As expected, the Matheron estimator always shows the highest bias. Moreover, the bias is for all estimators
somewhat smaller for the estimation in SE-NW direction than in SW-NE direction.
13

0
1
2
2
4
6
||h||
Bias
a
0
1
2
2
4
6
||h||
Bias
b
0
2
4
2
4
6
||h||
Bias
0
2
4
2
4
6
||h||
Bias
0
1
2
3
4
2
4
6
||h||
Bias
0
1
2
3
4
2
4
6
||h||
Bias
estimator
Genton
Matheron
MCD.diff
MCD.diff.re
MCD.org
MCD.org.re
Fig. 7 Bias of the variogram estimation in SW-NE (a) and SE-NW (b) direction per lag of the different estimators for contaminated
normally distributed data with a contamination rate of 0.1 and three different contamination distributions: N(3, 1) (first row),
N(5, 1) (second row) and N(0, 4) (third row)
4.5 Contamination by isolated outliers
In this subsection we investigate the behavior of the estimators in case of outliers spread out randomly or
at isolated positions. First we consider explosion breakdown for special, but practically relevant scenarios. As
before we concentrate on the one-dimensional case ny = 1, so that the number of data points is n = nx.
For the construction of the modified version of the estimators we again assume an m−dependent process
and build vectors with a minimal distance of m+1 between subsequent vectors. Denoting the maximal lag to be
estimated by hmax, we can thus build n∗= ⌊nx−hmax–1
hmax+1+m + 1⌋non-overlapping vectors, and each outlier disturbs
at most one of these. The modified estimator breaks down if ⌈εMCD · n∗⌉= n∗−k + 1 = n∗−⌊n∗+p+1
2
⌋+ 1
vectors contain an outlier. The breakdown point thus is
εmod = n∗−⌊n∗+p+1
2
⌋+ 1
nx
.
and depends on hmax, nx, m and p. Again, the larger hmax and m, the smaller is n∗and the breakdown point.
In case of nx = 50, m = 1 and hmax = 4, we get n∗= 8. This leads to the rather small breakdown point
εmod =
2
50 = 0.04 (MCD.org.mod) and εmod =
3
50 = 0.06 (MCD.diff.mod). Averaging across the different
partitions of the data into non-overlapping vectors does not solve these problems.
Now we discuss breakdown of the estimators MCD.org and MCD.diff in case of one-dimensional data. As
opposed to their modified versions, MCD.org and MCD.diff use overlapping vectors, so that each outlier disturbs
14

up to hmax + 1 vectors, which is the worst case considered here. The number of vectors which can be built is
n∗= nx −hmax. The estimators can handle less than ⌈εMCD · n∗⌉= n∗−⌊n∗+p+1
2
⌋+ 1 contaminated vectors
without breakdown. Therefore breakdown requires at least n∗−⌊n∗+p+1
2
⌋+1
hmax+1
outliers in the data, leading to the
following breakdown point
εMCD.var ≥
 
n∗−⌊n∗+p+1
2
⌋+1
hmax+1
!
/nx.
This depends on hmax and nx and is small if hmax is large compared to nx. Considering the example above
(nx = 50, hmax = 4), we get n∗= 46 leading to εMCD.var = 0.084 (MCD.org) and εMCD.var = 0.088 (MCD.diff),
which is somewhat larger than the breakdown point of the modified estimators.
0.0
0.4
0.8
2
4
6
||h||
Bias
a
0
1
2
2
4
6
||h||
Bias
b
1.0
1.5
2.0
2.5
2
4
6
||h||
Bias
2
4
6
2
4
6
||h||
Bias
2.0
2.5
3.0
3.5
4.0
4.5
2
4
6
||h||
Bias
2.5
5.0
7.5
10.0
12.5
2
4
6
||h||
Bias
estimator
Genton
Matheron
MCD.diff
MCD.diff.re
MCD.org
MCD.org.re
Fig. 8 Bias of the variogram estimation in E-W direction per lag for several estimators in case of substitutive contamination by
a N(3, 1) (a) and N(5, 1) (b) distribution at random positions and contamination rate 0.05 (first row), 0.15 (second row) and 0.25
(third row)
Breakdown points consider worst case scenarios, and for MCD.org and MCD.mod these are lower bounds.
We include some simulations to investigate how the estimators perform in different cases and to compare them
with common variogram estimators. In these simulations we consider the following statistical model. The process
of interest is the Gaussian Random Field Z(s) described at the beginning of Chapter 3. Again we observe a
contaminated process Y (s) instead of Z(s). Here we randomly choose n0 = ⌈ϵ · n⌉different locations from all n
locations. Let Nn0 be the set with all these locations. Then all locations belonging to Nn0 come from the outlier
15

distribution, while all other points come from the process Z(s),
Y (s)|Nn0 =
(
Z(s),
if s /∈Nn0
W,
if s ∈Nn0.
Figure 8 displays the bias of the different variogram estimators for estimation in E-W direction in case of
a contaminating N(3, 1) (column a) and N(5, 1) (column b) distribution. In the first row the contamination
rate is 5%, in the second row it is 15% and in the last row 25%. In all situations the Matheron estimator is
strongly biased. For ϵ = 5% MCD.org, MCD.org.re, MCD.diff and MCD.diff.re are less biased than the Genton
estimator. For the larger contamination rates the Genton estimator shows the best results. For a contamination
rate of 15% or larger the results for the raw and the reweighted MCD.org and MCD.diff estimators are not
comparable to those for the Matheron estimator. The reweighted versions (MCD.org.re and MCD.diff.re) show
a somewhat smaller bias than the raw ones (MCD.org and MCD.diff). These findings are for moderately large
one-sided (positive) outliers which are located about 2 to 5 standard deviations from the center of the clean
data. Further simulations not reported here indicate that the performance of raw and reweighted MCD.org and
MCD.diff is much better than this and almost as good as that of the Genton estimator in case of two-sided
(both positive and negative) outliers with the same level as the uncontaminated data but a higher variance.
Summing up, MCD.org and MCD.diff perform good in case of small contamination rates but are worse than
the Genton estimator in case of stronger one-sided contamination at random positions.
5 Application to Satellite Data
Landsat 8 is a satellite belonging to the NASA landsat project. This satellite collects data of the earth’s land
surface on 9 different spectral bands in the visible and short-wave infrared spectral regions (Knight and Kvaran,
2014). We use open source data measured by landsat 8 on October 20, 2016, i.e., a single time point, in a small
region of the Brazilian amazon forest. The x-coordinates of the region lies between -7332135 and -7319535 and
the y-coordinates between -1011642 and -995142 in the EPSG:3857 format. This region has a size of 60 x 60 pixels
corresponding to 30 times 30 meters each. The data can be downloaded on https://earthexplorer.usgs.gov/.
Our interest here is investigating whether the assumption of isotropy is justified for the Normalized Difference
Vegetation Index (NDVI) index. Therefore we estimate its variogram in all four directions and compare the
estimates. The NDVI index is a vegetation index measuring the greenness of biomass. It is calculated using two
spectral bands and takes values between -1 and 1. The higher the value of the NDVI, the greener the biomass
(Myneni et al, 1995; Tucker, 1979).
−7332000
−7331500
−7331000
−7330500
−1000000
−999500
−999000
−998500
NDVI | 2016−10−20 P1D
0.65
0.70
0.75
0.80
0.85
Fig. 9 NDVI index in a small region in the Brazilian amazon forest on October 20, 2016 with contamination due to clouds on the
right hand side and at the top
16

The data can be seen in Figure 9. The NDVI value is quite similar for most pixels, so that the variance of
the data is small. Only a block of pixels on the right hand side and another one at the top have much smaller
NDVI values compared to the rest. Besides the spectral bands the landsat data also contain a quality band,
whichprovides information whether a pixel might be contaminated by clouds, cloud shadows, snow etc., or if it
is clear (U.S. Geological Survey, 2019). For the pixels showing a different behavior in Figure 9 the quality band
indicates clouds or cloud shadows. All other pixels are classified as clear. The data on the right hand side and
at the top thus appear to be outlier blocks.
A simple solution here thus is to use only the data classified as clear for the variogram estimations. In other
applications, however, such additional information is not available. We therefore take advantage of the fact that
here we have such additional information and compare the variogram estimation based on all data points with
the variogram estimation based only on clear data points. We estimate the variogram for the different directions
for both data sets using the Matheron estimator, the Genton estimator and both MCD variogram estimators.
Due to their better performance in the simulations in Section 4 we use the reweighted versions of the MCD
based estimators. Furthermore in Section 4.1 we see that for grid sizes larger than 50×50 the correction factors
for the MCD based estimators are nearly one and irrespective of the true variogram model. Therefore we do not
use these correction factors here. We use hmax = 4 for the estimation in E-W and S-N direction and hmax = 3
for estimation in the other two directions. Using the clear data without outliers the grid contains missing values.
For the calculation of the MCD based estimators all vectors containing missing values are deleted. Furthermore
the variation in the data is very small (the mad of the data with outliers is about 0.009). To get the variogram
estimation on a better scale we standardize both data sets (with and without outliers) using this standard
deviation.
2
4
6
1
2
3
4
||h||
2γ(h)
a
0.50
0.75
1.00
1.25
1.50
1
2
3
4
||h||
2γ(h)
b
estimator
Genton
Matheron
MCD.diff.re
MCD.org.re
outlier
with
without
Fig. 10 Variogram estimation for the S-N direction in a small region of the Brazilian amazon forest from data with and without
outliers. On the left hand side all estimators are shown (a) and on the right hand side the Matheron estimator is excluded for the
data with outliers (b)
Figure 10 shows the variogram estimations in the S-N direction. On the left hand side (a) we see that the
Matheron estimator is strongly influenced by the contaminated pixels. Therefore we exclude this estimator on
17

the right hand side (b) for a better comparison of the other estimators. The Genton estimator is more influenced
by the outlier blocks than the MCD based estimators. Using only the clear pixels, both the Genton and the
reweighted MCD based estimator provide estimations similar to the Matheron estimation, whereby the Genton
estimator provides better results for small lags and MCD.diff.re for large lags. The reweighted MCD based
estimator thus can be said to perform well when being applied to the full data set with the outlier block and
can therefore be used if no additional information about the quaility of the pixels is available.
Figure 11 shows the variogram estimation of the robust estimators (Genton, MCD.diff.re, MCD.org.re) for
the data with block outliers for all four directions (S-N: a, E-W: b, SW-NE: c, SE-NW:d). The variogram
estimations for the different directions are very similar. Accordingly, there seems to be little evidence against
the assumption of isotropy here.
0.50
0.75
1.00
1.25
1.50
1
2
3
4
||h||
2γ(h)
a
0.50
0.75
1.00
1.25
1.50
1
2
3
4
||h||
2γ(h)
b
0.9
1.2
1.5
2
3
4
||h||
2γ(h)
c
0.7
0.9
1.1
1.3
1.5
2
3
4
||h||
2γ(h)
d
estimator
Genton
MCD.diff.re
MCD.org.re
Fig. 11 Variogram estimation by the robust estimators in all four direction (S-N: a, E-W: b, SW-NE: c, SE-NW:d) for a small
region of the Brazilian amazon forest for data with block outliers
6 Summary
The variogram is an important measure of spatial dependency. We have proposed two new estimators which are
based on the highly robust multivariate minimum covariance determinant scale estimator (MCD) and compare
them to the commonly used variogram estimators by Matheron (1962) and Genton (1998a) in different respects.
The new estimators estimate the variogram for several lags jointly. One of them (MCD.org) assumes data
from a weakly stationary random field and applies the MCD to vectors of subsequent observations to estimate
the variance and covariances. The other estimator (MCD.diff) is based on vectors of pairwise differences such
that the variogram can be found at the diagonal of the variance-covariance matrix of these vectors. Both
estimators can be used for directional variogram estimation in the four main directions (east-west, north-south,
southeast-northwest, southwest-northeast). In case of isotropy a joint estimation can be obtained by averaging
the estimations for different directions.
18

We see that the Matheron estimator, as expected, performs best in the case of Gaussian Data without
outliers. However, the Matheron estimator is strongly influenced by outliers in the data (Lark, 2000; Kerry and
Oliver, 2007) and can thus be recommended only for clean data without outliers.
If the data contain isolated outliers, the Genton estimator delivers the best results. However, spatially aggregated
outliers occurring in blocks have much stronger effects on the Genton estimator.
The proposed MCD variogram estimators outperform the other estimators in case of outliers occurring in
a block. Thereby, reweighting reduces not only the variance of the estimators but also the bias, and MCD.org
performs better than MCD.diff regarding bias and rMSE. In case of small grids, unbiased estimation by the
reweighted estimators requires correction factors that depend on the unkown true variogram. For the raw
estimators the variability of these corrections is small. A possible approach is using an averaged correction
factor based on several plausible parametric models. For increasing grid sizes the variances of MCD.org and
MCD.diff decrease and MCD.diff gets unbiased, indicating its asymptotic consistency. MCD.org shows a small
bias even for large grid sizes for the largest lag if this lag is smaller than the range of the true variogram. This
bias can be reduced by omitting the largest lag from the considerations, but using vectors of unnecessarily high
dimension reduces the number of vectors available for estimation and thus increases the variance. Advantages of
the (reweighted) MCD.diff are that it gets unbiased for large grid sizes and requires only the weaker assumption
of intrinsic stationarity.
We recommend the MCD variogram estimators in the possible presence of outlier blocks. Especially for high
grid sizes we recommend usage of the reweighted version. In case of small grid sizes the raw versions may be
preferred, since their finite sample correction factors depend much less on the true unkown variogram model.
We have concentrated on the case of either one block or outliers at random positions. Further simulations not
reported here indicate that the performances of the estimators in mixed situations with both outlier blocks and
isolated outliers are in between.
Acknowledgements.
The authors gratefully acknowledge the computing time provided on the Linux HPC
cluster at TU Dortmund University (LiDO3), partially funded in the course of the Large-Scale Equipment
Initiative by the German Research Foundation (DFG) as project 271512359. Financial support by the Deutsche
Forschungsgemeinschaft (DFG, German Research Foundation; Project-ID 520388526; TRR 391: Spatio-temporal
Statistics for the Transition of Energy and Transport) is gratefully acknowledged.
Supplementary information.
An R-implementation for the simulation study in section 4 as well as the
R-Code for section 5 is available on GitHub, see https://github.com/JGierse/MCD-variogram-estimator.
Data availability statements.
The data are open source data and can be downloaded on https:
//earthexplorer.usgs.gov/. The x-coordinates of the region lies between -7332135 and -7319535 and the
y-coordinates between -1011642 and -995142 in the EPSG:3857 format.
19

Appendix
grid size
(nx × ny)
n
direction
number of vectors
(15 × 15)
225
E-W/S-N
120
SE-NW/SW-NE
100
(25 × 25)
625
E-W/S-N
450
SE-NW/SW-NE
400
(50 × 50)
2500
E-W/S-N
2150
SE-NW/SW-NE
2025
(75 × 75)
5625
E-W/S-N
5100
SE-NW/SW-NE
4900
Table 1 Number of vectors available for the multivariate
estimations for the different directions and grid sizes, setting
hmax = 7 for E-W and S-N, and hmax = 5 for SE-NW and
SW-NE
exponential
gaussian
direction
direction
estimator
S-N
E-W
SW-NE
SE-NW
S-N
E-W
SW-NE
SE-NW
Matheron
0.99
0.99
0.99
0.99
1.01
1.01
1.02
1.00
Genton
1.04
1.03
1.03
1.03
1.11
1.12
1.11
1.12
MCD.diff
0.99
0.97
0.93
0.94
1.01
1.00
0.93
0.95
MCD.diff.re
1.20
1.17
1.21
1.18
1.46
1.45
1.44
1.49
MCD.org
0.97
0.96
0.92
0.94
0.99
1.00
0.94
0.95
MCD.org.re
1.21
1.17
1.21
1.20
1.45
1.44
1.43
1.46
Table 2 Simulated finite sample correction factors for the variogram estimators in all
four directions in case of a regular 15× 15 grid for an exponential and an gaussian
variogram model
20

E-W
S-N
ϵ
0.05
0.15
0.05
0.15
distribution
N(3, 1)
N(0, 4)
N(3, 1)
N(0, 4)
N(3, 1)
N(0, 4)
N(3, 1)
N(0, 4)
estimator
lag
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
|Bias|
rMSE
Matheron
1
4.19
4.63
17.24
19.22
6.98
7.48
49.41
51.62
4.10
4.62
17.30
19.34
6.65
7.20
49.19
51.42
4
10.64
12.57
16.34
19.07
19.57
21.83
48.83
51.75
9.84
12.89
15.93
19.31
18.17
21.07
47.99
51.23
7
9.91
13.14
15.53
18.69
27.70
30.45
44.87
47.09
9.73
13.72
16.09
19.48
27.26
30.52
44.89
47.32
Genton
1
0.93
1.12
1.14
1.33
2.09
2.25
3.61
3.77
1.27
1.72
1.71
2.11
2.59
2.96
5.30
5.69
4
5.60
7.96
4.27
7.07
12.47
15.26
13.87
16.39
6.41
11.16
5.09
9.89
13.26
17.33
17.07
21.17
7
4.76
9.76
3.28
8.98
18.35
22.06
16.89
20.44
3.79
9.99
2.71
9.10
17.41
21.94
16.77
21.06
MCD.org
1
0.51
0.97
0.49
0.97
1.01
1.37
0.92
1.28
0.87
1.73
0.91
1.72
1.54
2.22
1.62
2.29
4
1.02
5.62
0.70
5.82
2.69
7.14
2.10
6.57
1.77
10.70
1.20
9.76
3.57
10.74
3.50
10.96
7
2.54
7.82
2.90
8.29
0.51
8.84
1.37
8.37
1.29
12.03
0.62
11.13
3.08
12.28
2.75
12.30
MCD.org.mod
1
1.47
1.85
3.23
4.08
2.67
2.97
5.84
6.29
1.89
2.65
5.80
7.66
3.65
4.28
10.94
12.08
4
1.94
5.65
8.18
12.15
3.77
6.58
19.33
22.40
2.92
8.85
14.70
22.27
4.72
9.83
35.20
41.37
7
-1.97
7.10
4.31
10.79
0.30
7.05
20.56
25.68
2.23
9.96
14.02
22.49
4.87
11.21
42.60
51.11
MCD.org.re
1
0.46
0.85
0.44
0.83
0.78
1.15
0.65
1.01
0.81
1.56
0.80
1.49
1.24
1.95
1.22
1.88
4
0.67
4.86
0.29
4.87
1.66
6.07
0.91
5.30
1.12
9.09
0.49
8.18
2.33
9.37
1.73
8.92
7
3.00
7.04
3.43
7.39
1.75
7.95
2.81
7.39
0.66
10.25
0.10
9.24
1.94
10.89
0.98
10.12
MCD.diff
1
0.54
1.26
0.54
1.22
1.12
1.63
1.09
1.58
0.86
2.26
0.99
2.31
1.68
2.75
1.82
2.94
4
1.27
6.63
1.02
6.85
3.35
8.29
2.71
7.63
1.88
11.30
1.53
11.20
4.14
11.72
4.11
12.47
7
0.88
10.01
0.48
10.69
3.86
12.54
2.29
10.75
0.20
11.20
0.69
10.59
2.84
13.23
2.13
12.41
MCD.diff.mod
1
1.31
1.98
2.24
3.54
2.22
3.03
3.48
4.71
1.65
2.94
4.44
7.71
3.35
4.94
7.26
11.23
4
1.81
6.11
6.76
10.98
3.15
6.63
16.41
20.39
2.67
9.61
14.50
23.53
4.22
10.24
34.52
43.27
7
0.87
9.00
6.50
12.50
2.63
9.08
22.64
26.98
0.47
9.55
13.47
22.20
3.77
10.40
47.77
55.87
MCD.diff.re
1
0.46
0.97
0.47
0.96
0.82
1.32
0.76
1.22
0.84
1.85
0.89
1.84
1.36
2.38
1.41
2.41
4
0.78
5.24
0.43
5.23
2.27
6.91
1.17
5.76
1.43
9.49
0.82
9.00
3.39
10.44
2.13
9.81
7
0.40
8.18
0.40
8.25
2.88
10.90
0.31
8.40
0.22
9.58
0.95
8.61
3.42
12.42
0.62
10.08
Table 3 Bias and rMSE for the estimation in E-W and S-N direction in case of different contamination rates ϵ and different contamination distributions for three different lags. All
values are multiplied by 10 for ease of presentation. The best value is underlined in each case
21

References
Bowman AW, Crujeiras RM (2013) Inference for variograms. Computational Statistics and Data Analysis 66:19–
31. https://doi.org/10.1016/j.csda.2013.02.027
Butler RW, Davies PL, Jhun M (1993) Asymptotics for the minimum covaraince determinant estimator. The
Annals of Statistics 21:1385–1400. https://doi.org/10.1214/aos/1176349264
Cressie N, Hawkins DM (1980) Robust estimation of the variogram: I. Journal of the International Association
for Mathematical Geology 12:115–125. https://doi.org/10.1007/BF01035243
Croux C, Haesbroeck G (1999) Influence function and efficiency of the minimum covariance determinant scatter
matrix estimator. Journal of Multivariate Analysis 71:161–190. https://doi.org/10.1006/jmva.1999.1839
D¨urre A, Fried R, Liboschik T (2015) Robust estimation of (partial) autocorrelation. WIREs Computational
Statistics 7:205–222. https://doi.org/10.1002/wics.1351
Garthoff R, Otto P (2017) Control charts for multivariate spatial autoregressive models. AStA Advances in
Statistical Analysis 101:67–94. https://doi.org/10.1007/s10182-016-0276-x
Genton MG (1998a) Highly robust variogram estimation. Mathematical Geology 30:213–221. https://doi.org/
10.1023/A:1021728614555
Genton MG (1998b) Spatial breakdown point of variogram estimators. Mathematical Geology 30:853–871.
https://doi.org/10.1023/A:1021778626251
Guan Y, Sherman M, Calvin JA (2004) A nonparametric test for spatial isotropy using subsampling. Journal
of the American Statistical Association 99:810–821. https://doi.org/10.1198/016214504000001150
Hawkins DM, Olive DJ (2002) Inconsistency of resampling algorithms for high-breakdown regression estimators
and a new algorithm. Journal of the American Statistical Association 97:136–159. https://doi.org/10.1198/
016214502753479293
Hubert M, Debruyne M (2010) Minimum covariance determinant. Wiley Interdisciplinary Reviews: Computa-
tional Statistics 2:36–43. https://doi.org/10.1002/wics.61
Hubert M, Rousseeuw PJ, Verdonck T (2012) A deterministic algorithm for robust location and scatter. Journal
of Computational and Graphical Statistics 21:618–637. https://doi.org/10.1080/10618600.2012.672100
Kerry R, Oliver MA (2007) Determining the effect of asymmetric data on the variogram. ii. outliers. Computers
and Geosciences 33:1233–1260. https://doi.org/10.1016/j.cageo.2007.05.009
Knight EJ, Kvaran G (2014) Landsat-8 operational land imager design, characterization and performance.
Remote Sensing 6:10286–10305. https://doi.org/10.3390/rs61110286
Lark MR (2008) Some results on the spatial breakdown point of robust point estimates of the variogram.
Mathematical Geosciences 40:729–751. https://doi.org/10.1007/s11004-008-9162-8
Lark RM (2000) A comparison of some robust estimators of the variogram for use in soil survey. European
Journal of Soil Science 51:137–157. https://doi.org/10.1046/j.1365-2389.2000.00280.x
Lopuha¨a HP (1999) Asymptotics of reweighted estimators of multivariate location and scatter. Annals of
Statistics 27:1638–1665. https://doi.org/10.1214/aos/1017939145
22

Lopuha¨a HP, Rousseeuw PJ (1991) Breakdown points of affine equivariant estimators of multivariate location
and covariance matrices. The Annals of Statistics 19:229–248. https://doi.org/doi:10.1214/aos/1176347978
Maechler M, Rousseeuw PJ, Croux C, et al (2021) robustbase: Basic robust statistics. URL http://robustbase.
r-forge.r-project.org/
Matheron G (1962) Trait´e de g´eostatistique appliqu´ee, Tome I. M´emoires du Bureau de Recherches G´eologiques
et Mini`eres
Myneni RB, Hall FG, Sellers PJ, et al (1995) The interpretation of spectral vegetation indexes. IEEE
Transactions on Geoscience and Remote Sensing 33:481–486. https://doi.org/10.1109/36.377948
Otto P, Schmid W (2016) Detection of spatial change points in the mean and covariances of multivari-
ate simultaneous autoregressive models. Biometrical Journal 58:1113–1137. https://doi.org/10.1002/bimj.
201500148
Pison G, Aelst SV, Willems G (2002) Small sample corrections for lts and mcd. Metrika 55:111–123. https:
//doi.org/10.1007/s001840200191
R Core Team (2024) R: A Language and Environment for Statistical Computing. R Foundation for Statistical
Computing, Vienna, Austria, URL https://www.R-project.org/
Roelant E, Aelst SV, Willems G (2009) The minimum weighted covariance determinant estimator. Metrika
70:177–204. https://doi.org/10.1007/s00184-008-0186-3
Rousseeuw PJ (1985) Multivariate estimation with high breakdown point. Mathematical Statistics and
Applications Vol B pp 283–297. https://doi.org/10.1007/978-94-009-5438-0 20
Rousseeuw PJ, Croux C (1993) Alternatives to the median absolute deviation. Journal of the American
Statistical Association 88:1273–1283. https://doi.org/10.1080/01621459.1993.10476408
Rousseeuw PJ, Driessen KV (1999) A fast algorithm for the minimum covariance determinant estimator.
Technometrics 41:212–223. https://doi.org/10.1080/00401706.1999.10485670
Schlather M, Malinowski A, Oesting M, et al (2020) Randomfields: Simulation and analysis of random fields.
URL https://cran.r-project.org/package=RandomFields
Sherman M (2011) Spatial Statistics and Spatio-Temporal Data, 1st edn. John Wiley and Sons
Todorov V (1992) Computing the minimum covariance determinant estimator (mcd) by simulated annealing.
Computational Statistics and Data Analysis 14:515–525. https://doi.org/10.1016/0167-9473(92)90067-P
Tucker CJ (1979) Red and photographic infrared linear combinations for monitoring vegetation. Remote Sensing
of Environment 8:127–150. https://doi.org/10.1016/0034-4257(79)90013-0
U.S. Geological Survey (2019) Landsat 8 data users handbook. Nasa URL https://landsat.usgs.gov/documents/
Landsat8DataUsersHandbook.pdf
23
