arXiv:0912.1479v1  [math.ST]  8 Dec 2009
Pointwise consistency of the kriging predictor
with known mean and covariance functions
Emmanuel Vazquez and Julien Bect
Abstract. This paper deals with several issues related to the pointwise consistency
of the kriging predictor when the mean and the covariance functions are known.
These questions are of general importance in the context of computer experiments.
The analysis is based on the properties of approximations in reproducing kernel
Hilbert spaces. We ﬁx an erroneous claim of Yakowitz and Szidarovszky (J. Mul-
tivariate Analysis, 1985) that the kriging predictor is pointwise consistent for all
continuous sample paths under some assumptions.
Key words: kriging; reproducing kernel Hilbert space; asymptotics; consistency
1 Introduction
The domain of computer experiments is concerned with making inferences about
the output of an expensive-to-run numerical simulation of some physical system,
which depends on a vector of factors with values in X ⊆Rd. The output of the sim-
ulator is formally an unknown function f : X →R. For example, to comply with
ever-increasing standards regarding pollutant emissions, numerical simulations are
used to determine the level of emissions of a combustion engine as a function of its
design parameters (Villemonteix, 2008). The emission of pollutants by an engine in-
volves coupled physical phenomena whose numerical simulation by a ﬁnite-element
method, for a ﬁxed set of design parameters of the engine, can take several hours on
high-end servers. It then becomes very helpful to collect the answers already pro-
vided by the expensive simulator, and to construct from them a simpler computer
model, that will provide approximate but cheaper answers about a quantity of inter-
est. This approximate model is often called a surrogate, or a metamodel, or an emu-
Emmanuel Vazquez · Julien Bect
SUPELEC, 3 rue Joliot-Curie, 91192 Gif-sur-Yvette, France
e-mail: emmanuel.vazquez@supelec.fr and julien.bect@supelec.fr
1

2
Emmanuel Vazquez and Julien Bect
lator of the actual simulator f. The quality of the answers given by the approximate
model depends on the quality of the approximation, which depends, in turn and in
part, on the choice of the evaluation points of f, also called experiments. The choice
of the evaluation points is usually called the design of experiments. Assuming that f
is continuous, it is an important question to know whether the approximate model
behaves consistently, in the sense that if the evaluation points xn are chosen sequen-
tially in such a way that a given point x ∈X is an accumulation point of {xn, n ≥1},
then the approximation at x converges to f(x).
Since the seminal paper of Sacks et al. (1989), kriging has been one of the most
popular methods for building approximations in the context of computer experi-
ments (see, e.g., Santner et al., 2003). In the framework of kriging, the unknown
function f is seen as a sample path of a stochastic process ξ, which turns the prob-
lem of approximation of f into a prediction problem for the process ξ. In this paper,
we shall assume that the mean and the covariance functions are known. Motivated
by the analysis of the expected improvement algorithm (Vazquez and Bect, 2009),
a popular kriging-based optimization algorithm, we discuss several issues related
to the pointwise consistency of the kriging predictor, that is, the convergence of the
kriging predictor to the true value of ξ at a ﬁxed point x ∈X. These issues are barely
documented in the literature, and we believe them to be of general importance for
the asymptotic analysis of sequential design procedures based on kriging.
The paper is organized as follows. Section 2 introduces notation and various
formulations of pointwise consistency, using the reproducing kernel Hilbert space
(RKHS) attached to ξ. Section 3 investigates whether L2-pointwise consistency at x
can hold when x is not in the adherence of the set {xn,n ≥1}. Conversely, assuming
that x is in the adherence, Section 4 studies the set of sample paths f = ξ(ω,·)
for which pointwise consistency holds. In particular, we ﬁx an erroneous claim of
Yakowitz and Szidarovszky (1985)—namely, that the kriging predictor is pointwise
consistent for all continuous sample paths under some assumptions.
2 Several formulations of pointwise consistency
Let ξ be a second-order process deﬁned on a probability space (Ω,A ,P), with
parameter x ∈X ⊆Rd. Without loss of generality, it will be assumed that the mean
of ξ is zero and that X = Rd. The covariance function of ξ will be denoted by
k(x,y) := E[ξ(x)ξ(y)], and the following assumption will be used throughout the
paper:
Assumption 1. The covariance function k is continuous.
The kriging predictor of ξ(x), based on the observations ξ(xi), i = 1,...,n, is the
orthogonal projection
bξ(x;xn) :=
n
∑
i=1
λ i(x;xn)ξ(xi)
(1)
of ξ(x) onto span{ξ(xi),i = 1,...,n}. The variance of the prediction error, also
called the kriging variance in the literature of geostatistics (see, e.g., Chil`es and

Pointwise consistency of kriging
3
Delﬁner, 1999), or the power function in the literature of radial basis functions (see,
e.g., Wu and Schaback, 1993), is
σ2(x;xn) := var
h
ξ(x)−bξ(x;xn)
i
= k(x,x)−∑
i
λ i(x;xn)k(x,xi).
For any x ∈Rd, and any sample path f = ξ(ω,·), ω ∈Ω, the values ξ(ω,x) =
f(x) and bξ(ω,x;xn) can be seen as the result of the application of an evaluation
functional to f. More precisely, let δx be the Dirac measure at x ∈Rd, and let λn,x
denote the measure with ﬁnite support deﬁned by λn,x := ∑n
i=1 λ i(x;xn)δxi. Then,
for all ω ∈Ω, ξ(ω,x) = ⟨δx, f ⟩and bξ(ω,x;xn) = ⟨λn,x, f ⟩. Pointwise consistency
at x ∈Rd, deﬁned in Section 1 as the convergence of bξ(ω,x;xn) to ξ(x), can thus
be seen as the convergence of λn,x to δx in some sense.
Let H be the RKHS of functions generated by k, and H ∗its dual space. De-
note by (·,·)H (resp. (·,·)H ∗) the inner product of H (resp. H ∗), and by ∥·∥H
(resp. ∥·∥H ∗) the corresponding norm. It is well-known (see, e.g., Wu and Sch-
aback, 1993) that
δx −λn,x
2
H ∗=
k(x,·)−∑i λ i(x;xn)k(xi,·)
2
H = σ2(x;xn).
Therefore, the convergence λn,x →δx holds strongly in H ∗if and only if the krig-
ing predictor is L2(Ω,A ,P)-consistent at x; that is, if σ2(x;xn) converges to zero.
Since k is continuous, it is easily seen that σ2(x;xn) →0 as soon as x is adherent
to {xn,n ≥1}. Indeed,
σ2(x,xn) ≤E[(ξ(x)−ξ(xϕn))2] = k(x,x)+ k(xϕn,xϕn)−2k(x,xϕn),
with (ϕn)n∈N a non-decreasing sequence such that ∀n ≥1, ϕn ≤n and xϕn →x.
As explained by Vazquez and Bect (2009), it is sometimes important to work with
covariance functions such that the converse holds. That leads to our ﬁrst open issue,
which will be discussed in Section 3:
Problem 1. Find necessary and sufﬁcient conditions on a continuous covariance k
such that σ2(x;xn) →0 implies that x is adherent to {xn,n ≥1}.
Moreover, since strong convergence in H ∗implies weak convergence in H ∗,
we have
lim
n→∞σ2(x;xn) = 0 =⇒∀f ∈H ,
lim
n→∞⟨λn,x, f ⟩= ⟨δx, f ⟩= f(x).
(2)
Therefore, if x is adherent to {xn, n ≥1}, pointwise consistency holds for all sample
paths f ∈H . However, this result is not satisfying from a Bayesian point of view
since P{ξ ∈H } = 0 if ξ is Gaussian (see, e.g., Lukic and Beder, 2001, Driscoll’s
theorem). In other words, modeling f as a Gaussian process means that f cannot be
expected to belong to H . This leads to our second problem:

4
Emmanuel Vazquez and Julien Bect
Problem 2. For a given covariance function k, describe the set of functions G such
that, for all sequences (xn)n≥1 in Rd and all x ∈Rd,
lim
n→∞σ2(x;xn) = 0 =⇒∀f ∈G ,
lim
n→∞⟨λn,x, f ⟩= f(x).
(3)
An important question related to this problem, to be discussed in Section 4, is to
know whether the set G contains the set C(Rd) of all continuous functions. Before
proceeding, we can already establish a result which ensures that considering the
kriging predictor is relevant from a Bayesian point of view.
Theorem 1. If ξ is Gaussian, then {ξ ̸∈G } is P-negligible.
Proof. If ξ is Gaussian, it is well-known that bξ(x;xn) = E[ξ(x) | Fn] a.s., where
Fn denotes the σ-algebra generated by ξ(x1), ..., ξ(xn). Note that (E[ξ(x) | Fn])
is an L2-bounded martingale sequence and therefore converges, a.s. and in L2-norm,
to a random variable ξ∞(see, e.g., Williams, 1991).
⊓⊔
3 Pointwise consistency in L2-norm and the No-Empty-Ball
property
The following deﬁnition has been introduced by Vazquez and Bect (2009):
Deﬁnition 1. A random process ξ has the No-Empty-Ball (NEB) property if, for all
sequences (xn)n≥1 in Rd and all x ∈Rd, the following assertions are equivalent:
i) x is an adherent point of the set {xn, n ≥1},
ii) σ2(x,xn) →0 when n →+∞.
The NEB property implies that there can be no empty ball centered at x if the pre-
diction error at x converges to zero—hence the name. Since k is continuous, the
implication 1.i ⇒1.ii is true. Therefore, Problem 1 amounts to ﬁnding necessary
and sufﬁcient conditions on k for ξ to have the NEB property.
Our contribution to the solution of Problem 1 will be twofold. First, we shall
prove that the following assumption, introduced by Yakowitz and Szidarovszky
(1985), is a sufﬁcient condition for the NEB property:
Assumption 2. The process ξ is second-order stationary and has spectral density S,
with the property that S−1 has at most polynomial growth.
In other words, Assumption 2 means that there exist C > 0 and r ∈N∗such that
S(u)(1 + |u|r) ≥C, almost everywhere on Rd. Note that this is an assumption
on k, which prevents it from being too regular. In particular, the so-called Gaussian
covariance,
k(x,y) = s2 e−α ∥x−y∥2,
s > 0, α > 0,
(4)
does not satisfy Assumption 2. In fact, and this is the second part of our contribution,
we shall show that ξ with covariance function (4) does not possess the NEB prop-

Pointwise consistency of kriging
5
erty. Assumption 2 still allows consideration of a large class of covariance functions,
which includes the class of (non-Gaussian) exponential covariances
k(x,y) = s2 e−α ∥x−y∥β ,
s > 0, α > 0, 0 < β < 2,
(5)
and the class of Mat´ern covariances (popularized by Stein, 1999).
To summarize, the main result of this section is:
Proposition 1.
i) If Assumption 2 holds, then ξ has the NEB property.
ii) If ξ has the Gaussian covariance given by (4), then ξ does not possess the NEB
property.
The proof of Proposition 1 is given in Section 5. To the best of our knowledge,
ﬁnding necessary and sufﬁcient conditions for the NEB property—in other words,
solving Problem 1—is still an open problem.
4 Pointwise consistency for continuous sample paths
An important question related to Problem 2 is to know whether the set G contains the
set C(Rd) of all continuous functions. Yakowitz and Szidarovszky (1985, Lemma
2.1) claim, but fail to establish, the following:
Claim 1. Let Assumption 2 hold. Assume that {xn, n ≥1} is bounded, and denote
by X0 its (compact) closure in Rd. Then, if x ∈X0,
∀f ∈C(Rd),
lim
n→∞⟨λn,x, f ⟩= f(x).
Their incorrect proof has two parts, the ﬁrst of which is correct; it says in essence
that, if x ∈X0 (i.e., if x is adherent to {xn, n ≥1}), then
∀f ∈S (Rd),
lim
n→∞⟨λn,x, f ⟩= f(x),
(6)
where S (Rd) is the vector space of rapidly decreasing functions1. In fact, this re-
sult stems from the weak convergence result (2), once it has been remarked that2
S (Rd) ⊂H under Assumption 2.
1 Recall that S (Rd) corresponds to those f ∈C∞(Rd) for which
sup
|ν|≤N
sup
x∈Rd (1+|x|2)N|(Dν f )(x)| < ∞
for N = 0,1,2,..., where Dν denotes differentiation of order ν.
2 Indeed, under Assumption 2, we have ∀f ∈S (Rd),
∥f ∥2
H =
1
(2π)d
Z
Rd
 ˜f(u)
2 S(u)−1du ≤
1
C(2π)d
Z
Rd
 ˜f(u)
2 (1+|u|r) du < +∞,
where ˜f is the Fourier transform of f (see, e.g., Wu and Schaback, 1993).

6
Emmanuel Vazquez and Julien Bect
The second part of the proof of Claim 1 is ﬂawed because the extension of the
convergence result from S (Rd) to C(Rd), on the ground that S (Rd) is dense
in C(Rd) for the topology of the uniform convergence on compact sets, does not
work as claimed by the authors. To get an insight into this, let f ∈C(Rd), and let
(φk) ∈S (Rd)N be a sequence that converges to f uniformly on X0. Then we can
write
|⟨λn,x, f ⟩−f(x)| ≤|⟨λn,x, f −φk ⟩|+ |⟨λn,x −δx,φk ⟩|+ |φk(x)−f(x)|
≤
 1 + ∥λn,x∥TV

sup
X0
|f −φk| + |⟨λn,x −δx,φk ⟩| ,
where ∥λn,x∥TV := ∑n
i=1|λ i(x;xn)| is the total variation norm of λn,x, also called the
Lebesgue constant (at x) in the literature of approximation theory. If we assume that
the Lebesgue constant is bounded by K > 0, then we get, using (6),
limsup
n→∞
|⟨λn,x, f ⟩−f(x)| ≤(1 + K) sup
X0
|f −φk| −−−→
k→∞0.
Conversely, if the Lebesgue constant is not bounded, the Banach-Steinhaus theorem
asserts that there exists a dense subset G of
 C(Rd),∥·∥∞

such that, for all f ∈G,
supn≥1|⟨λn,x, f ⟩| = +∞(see, e.g., Rudin, 1987, Section 5.8).
Unfortunately, little is known about Lebesgue constants in the literature of krig-
ing and kernel regression. To the best of our knowledge, whether the Lebesgue con-
stant is bounded remains an open problem—although there is empirical evidence
in De Marchi and Schaback (2008) that the Lebesgue constant could be bounded in
some cases.
Thus, the best result that we can state for now is a ﬁxed version of Yakowitz and
Szidarovszky (1985), Lemma 2.1.
Theorem 2. Let Assumption 2 hold. Assume that {xn, n ≥1} is bounded, and denote
by X0 its (compact) closure in Rd. Then, for all x ∈X0, the following assertions are
equivalent:
i) ∀f ∈C(Rd), limn→∞⟨λn,x, f ⟩= f(x),
ii) the Lebesgue constant at x is bounded.
5 Proof of Proposition 1
Assume that x ∈Rd is not adherent to {xn, n ≥1}. Then, there exists a C∞(Rd)
compactly supported function f such that f(x) ̸= 0 and f(xi) = 0, ∀i ∈{1,...,n}.
For such a function, the quantity ⟨λn,x, f ⟩cannot converge to f(x) since
⟨λn,x, f ⟩=
n
∑
i=1
λ i(x;xn) f(xi) = 0 ̸= f(x).
Under Assumption 2, S (Rd) ⊂H , as explained in Section 4. Thus, f ∈H ; and it
follows that λn,x cannot converge (weakly, hence strongly) to δx in H ∗. This proves
the ﬁrst assertion of Proposition 1.

Pointwise consistency of kriging
7
In order to prove the second assertion, pick any sequence (xn)n≥1 such that the
closure X0 of {xn, n ≥1} has a non-empty interior. We will show that σ2(x;xn) →0
for all x ∈Rd. Then, choosing x ̸∈X0 proves the claim.
Recall that bξ(x;xn) is the orthogonal projection of ξ(x) onto span{ξ(xi),i =
1,...,n} in L2 (Ω,A ,P). Using the fact that the mapping ξ(x) 7→k(x,·) extends
linearly to an isometry3 from span{ξ(y), y ∈Rd} to H , we get that
σ(x;xn) =
ξ(x)−bξ(x;xn)
 = dH (k(x,·), Hn) ,
where dH is the distance in H , and Hn is the subspace of H generated by k(xi,·),
i = 1,...,n. Therefore
lim
n→∞σ(x;xn) = lim
n→∞dH (k(x,·), Hn) = dH (k(x,·), H∞) ,
where H∞= ∪n≥1Hn. Any function f ∈H⊥
∞satisﬁes f(xi) = (f, k(xi,·)) = 0 and
therefore vanishes on X0, since H is a space of continuous functions. Corollary 3.9
of Steinwart et al. (2006) leads to the conclusion that f = 0 since X0 has a non-
empty interior. We have proved that H⊥
∞= {0}, hence that H∞= H since H∞is
a closed subspace. As a consequence, limn→∞σ(x;xn) = dH (kx, H∞) = 0, which
completes the proof.
⊓⊔
References
J.-P. Chil`es and P. Delﬁner. Geostatistics: Modeling Spatial Uncertainty. Wiley, New York, 1999.
S. De Marchi and R. Schaback. Stability of kernel-based interpolation. Adv. in Comp. Math., 2008.
doi: 10.1007/s10444-008-9093-4.
M. N. Lukic and J. H. Beder. Stochastic processes with sample paths in reproducing kernel Hilbert
spaces. Trans. Amer. Math. Soc., 353(10):3945–3969, 2001.
W. Rudin. Real and Complex Analysis. McGraw-Hill, New York, 3rd edition, 1987.
J. Sacks, W. J. Welch, T. J. Mitchell, and H. P. Wynn. Design and analysis of computer experiments.
Statist. Sci., 4(4):409–435, 1989.
T. J. Santner, B. J. Williams, and W. I. Notz. The Design and Analysis of Computer Experiments.
Springer, 2003.
M. L. Stein. Interpolation of Spatial Data: Some Theory for Kriging. Springer, New York, 1999.
I. Steinwart, D. Hush, and C. Scovel. An explicit description of the reproducing kernel Hilbert
spaces of Gaussian RBF kernels. IEEE Transactions on Information Theory, 52(10):4635–
4643, 2006.
E. Vazquez and J. Bect. On the convergence of the expected improvement algorithm. Preprint
available on arXiv, http://arxiv.org/abs/0712.3744v2, 2009.
J. Villemonteix. Optimisation de Fonctions Coˆuteuses. PhD thesis, Universit´e Paris-Sud XI, Fac-
ult´e des Sciences d’Orsay, 2008.
D. Williams. Probability with Martingales. Cambridge University Press, Cambridge, 1991.
Z. Wu and R. Schaback. Local error estimates for radial basis function interpolation of scattered
data. IMA J. Numer. Anal., 13:13–27, 1993.
S. J. Yakowitz and F. Szidarovszky. A comparison of kriging with nonparametric regression meth-
ods. J. Multivariate Analysis, 16:21–53, 1985.
3 often referred to as Lo`eve’s isometry (see, e.g., Lukic and Beder, 2001)
