Local Indicators of Mark Association for
Spatial Marked Point Processes
November 5, 2024
Matthias Eckardt1 and Mehdi Moradi2
1 Chair of Statistics, Humboldt-Universit¨at zu Berlin , Berlin, Germany
2 Department of Mathematics and Mathematical Statistics, Ume˚a University, Ume˚a,
Sweden
Abstract
The emergence of distinct local mark behaviours is becoming increasingly com-
mon in the applications of spatial marked point processes. This dynamic high-
lights the limitations of existing global mark correlation functions in accurately
identifying the true patterns of mark associations/variations among points as dis-
tinct mark behaviours might dominate one another, giving rise to an incomplete
understanding of mark associations. In this paper, we introduce a family of local
indicators of mark association (LIMA) functions for spatial marked point pro-
cesses. These functions are defined on general state spaces and can include marks
that are either real-valued or function-valued.
Unlike global mark correlation
functions, which are often distorted by the existence of distinct mark behaviours,
LIMA functions reliably identify all types of mark associations and variations
among points. Additionally, they accurately determine the interpoint distances
where individual points show significant mark associations. Through simulation
studies, featuring various scenarios, and four real applications in forestry, crimi-
nology, and urban mobility, we study spatial marked point processes in R2 and on
linear networks with either real-valued or function-valued marks, demonstrating
that LIMA functions significantly outperform the existing global mark correlation
functions.
Keywords: Function-valued marks; local mark behaviours; linear networks; mark asso-
ciation; mark correlation functions; mark variogram
1
arXiv:2411.01065v1  [stat.ME]  1 Nov 2024

1
Introduction
Nowadays, within different applications of spatial point processes, including forestry,
environmental sciences, criminology, epidemiology, seismology, etc, it is increasingly
becoming common to deal with locations of events that are labelled by some point-
specific information called marks. In such cases, the focus shifts from solely the spatial
distribution of points to the joint distribution of points and marks, aiming to identify
any mark associations among points alongside their spatial distribution.
The type
of such point-specific information leads to the existence of three general categories for
marks depending on the application in question, including integer-valued or categorised
marks (e.g., different types of crimes within applications of criminology), real-valued
marks (e.g., the diameter at breast height for trees in forestry), and object-valued marks
which cover any type of mark that does not fit into the previous categories. A common
example of object-valued marks includes situations where some functions/curves are
attached to the points, e.g., daily cycle distance profiles for bike stations over some
time period and population growth of cities over a period of some years (Ghorbani
et al., 2021; Eckardt et al., 2024a). Other examples of object-valued marks include
situations where marks are compositions, graphs, and manifolds, among other things.
A recent overview of the current state of spatial marked point processes is provided in
Eckardt and Moradi (2024a).
In cases where events are assigned integer-valued or categorical marks, it is com-
mon practice to employ cross/dot-type summary statistics to explore the distribution of
points having a specific mark around points having another type of mark. These sum-
mary statistics include cross/dot-type K-functions, pair correlation functions, empty
space distribution functions, nearest neighbour distance distribution functions, and J-
functions; these are currently available for marked point processes in R2 as well as those
on linear networks (Møller and Waagepetersen, 2004; Baddeley et al., 2014; Cronie and
van Lieshout, 2016; Eckardt and Moradi, 2024a).
If marks are real-valued, one in-
stead employs summary statistics such as Isham’s mark correlation function (Isham,
1985), Stoyan’s mark correlation function (Stoyan and Stoyan, 1994), Beisbart’s and
Kerscher’s mark correlation function (Beisbart and Kerscher, 2000), and Shimatani’s
and Schlather’s I functions (Shimatani, 2002; Schlather et al., 2004), which, from differ-
ent points of view, describe the average association among marks. Furthermore, there
exist other summary statistics such as the mark covariance function (Stoyan, 1984),
mark variogram (Cressie, 1993; W¨alder and Stoyan, 1996; Stoyan and W¨alder, 2000),
and mark differentiation function (Pommerening et al., 2011; Hui and Pommerening,
2014), which all, even though having distinct viewpoints, describe the average variation
among marks. These aforementioned mark correlation functions are initially introduced
for spatial marked point processes in R2, but later Eckardt and Moradi (2024a) pro-
posed their counterparts for spatial marked point processes on linear networks. Note
that one could always convert real-valued marks into categorical marks based on some
2

rules and then employ cross/dot-type summary statistics. Turning to object-valued
marks, the literature has mostly focused on function-valued marks. Second-order sum-
mary statistics for spatial marked point processes in R2 with function-valued marks are
proposed by Comas et al. (2011, 2013), where they generalised Stoyan’s mark correla-
tion function for some applications within forestry. Ghorbani et al. (2021) presented
a profound mathematical formulation for spatial point processes with function-valued
marks. Most recently, Eckardt et al. (2023) and Eckardt et al. (2024b) proposed an
extension of general mark correlation functions to multivariate spatial point processes
in R2 and network-constrained spatial marked point processes with function-valued
marks, respectively.
These aforementioned summary statistics generally explore either the interactions
between points with distinct types of marks, mark associations, or mark variations with
respect to a sequence of fixed interpoint distances. What they all have in common is
a focus on average behaviours, which, in turn, might often fail to capture all types
of behaviours due to the domination between different marks, resulting in erroneous
conclusions, especially in situations where marks are space-dependent. For instance,
consider scenarios where, at a fixed interpoint distance, a set of pairs of points exists,
and the associations of some pairs may overshadow those of others, masking the true
pattern of mark associations among the points (Chaudhuri et al., 2023). Therefore,
it is of great importance to study the contributions of each point to these average
behaviours individually in order to uncover all existing dependence structures among
marks, leading to a complete understanding of mark behaviours.
For unmarked point processes, studying local dependence structures dates back to
when Getis (1984) and Getis and Franklin (1987) proposed some second-order-based
statistics similar to K-functions for stationary point processes in R2, focusing on local
structures within forestry applications. Stoyan and Stoyan (1994) also discussed sim-
ilar ideas termed individual functions. On a different perspective, Cressie and Collins
(2001a,b) focused on the analogues of Anselin’s local indicators of spatial association
(LISA) functions (Anselin, 1995) for spatial point process based on product density
functions, namely product density LISA functions.
These are also applied by Ma-
teu et al. (2007) for feature-clutter classification and Moraga and Montes (2011) for
disease cluster detection. Gonz´alez et al. (2021) discussed local pair correlation func-
tions for feature-clutter classification. Turning to spatio-temporal point processes in
R2 ˆ R, Siino et al. (2018) proposed local indicators of spatial association (LISTA),
which were later used by Adelfio et al. (2020) to derive goodness-of-fit diagnostics and
D’Angelo et al. (2023) to suggest a local version of minimum contrast estimation for
spatio-temporal log-Gaussian Cox processes.
Turning to locally defined methods for spatial marked point processes in R2 with
integer-valued marks, local versions of (in)homogeneous cross/dot-type K- and pair cor-
relation functions are proposed to identify local tendencies towards clustering/inhibition
for points with specific marks in relation to points with other types of marks (Baddeley
3

et al., 2015, Chapter 7). Recently, when marks are functions/curves, D’Angelo et al.
(2024) proposed local inhomogeneous mark-weighted summary statistics for marked
point processes in R2 which are varieties of K-functions. Moreover, generalisations of
Getis-Ord G were considered by Berglund and Karlstr¨om (1999); Flahaut et al. (2003)
with applications to flow data and traffic accidents. Yamada and Thill (2007, 2010)
proposed the so-called local indicators of network-constrained clusters (LINCS) to iden-
tify local-scale clustering while Eckardt and Mateu (2021) discussed the so-called local
indicator of network association (LISNA) functions. Finally, considering two distinct
spatio-temporal point patterns on a single linear network, D’Angelo et al. (2021) inves-
tigated the local differences between their second-order structure.
As of today, the literature lacks local mark correlation functions for spatial marked
point processes with real-valued and/or function-valued marks, which can be great
tools for uncovering all types of mark associations/variations among points. Aiming
to fill this gap, we establish a framework for local mark correlation functions. More
specifically, we introduce the family of LIMA functions for spatial marked point pro-
cess on general state spaces. In particular, we consider spatial marked point processes
where points are either in R2 or on linear networks, and marks are either real-valued or
function-valued. All proposed methods are designed to provide useful insights into local
variations and dependence structures of marks and, thus, enhance our understanding
of inherent structural interrelations for complex spatial marked point processes. By
exploring various scenarios in our simulation studies alongside four real-world cases,
we demonstrate how our proposed LIMA functions outperform existing global mark
correlation functions. Specifically, we focus on the following aspects: the probability
of committing a type I error, the power of the test, identifying individual points with
significant mark associations, determining interpoint distance ranges where these asso-
ciations hold, and determining the type of significance in terms of positive or negative
mark association. These calculations are done using the R (R Core Team, 2024) pro-
gramming languages, and all developed LIMA functions will be accommodated in an R
package.
The paper is organised as follows. Section 2 provides the necessary background,
covering global mark correlation functions for spatial point processes in R2 and on lin-
ear networks, with marks being either real-valued or function-valued. In Section 3, we
establish the family of LIMA functions for the same contexts, along with their corre-
sponding non-parametric estimators. Section 4 presents a simulation study where we
assess the performance of our proposed LIMA functions under various scenarios where
global mark correlation functions fail to detect the type mark associations correctly.
Section 5 showcases four real-world applications involving point processes in either R2
or on linear networks, with marks being real-valued or function-valued, in fields such
as forestry, criminology, and urban bike usage. The paper ends with a discussion in
Section 6.
4

2
Global summary statistics for marked point pro-
cesses
2.1
Preliminaries
Consider S as an arbitrary complete separable metric space, equipped with a Lebesgue
measure |A| “
ş
A du, A Ď BpSq, which B stands for Borel sets, and a distance metric
dSp¨, ¨q. In addition, let M be a Polish space associated with S, which we refer to as mark
space, equipped with an appropriate reference measure ν on the Borel σ-algebra BpMq.
Moreover, the Borel σ-algebra on the product space S ˆ M is denoted by BpS ˆ Mq.
Throughout the paper, we focus on a marked point process X “ tpxi, mpxiqquN
i“1, N ě
0, on S ˆ M with points xi in S and appertained marks mpxiq in M. Formally, X
is considered as a random element of the measurable space pNlf, Nq of locally finite
point configurations x “ tpxi, mpxiqun
i“1, n ě 0.
The associated ground process to
X, i.e., its unmarked version, is a well-defined point process in S (Daley and Vere-
Jones, 2003; Chiu et al., 2013). Further, X is considered to be simple meaning that
ProbpcardpX Xpu, mpuqqq P t0, 1uq
a.s.
“ 1 for all pu, mpuqq P SˆM. In other terms, there
are no multiple points per location. The mark distribution will be denoted by PM with
associated mark mean and mark variance µM and σ2
M, respectively.
Within the literature on point processes, there are distinct examples of state space
S, including Euclidean space S “ Rd, d ě 1, linear networks S “ L, and the sphere
S “ αSd´1 of radius α. Although the proposed methods apply to all instances of S,
we focus on the first two.
The Euclidean space S “ Rd, d ě 1 is equipped with
the Euclidean distance dRdpu1, u2q “ ||u1 ´ u2||, u1, u2 P Rd, where || ¨ || denotes the
Euclidean norm, and with the Lebesgue measure |¨|. The case of S “ L needs particular
attention. A linear network L “ Yk
i“1ℓi is considered as a union of k ě 1 line segments
ℓi “ rui, vis “ ttui ` p1 ´ tqvi : 0 ď t ď 1u Ď Rd,
with ui ‰ vi P Rd such that for any i ‰ j, the intersection ℓi X ℓj is either empty
or given by their endpoints. Distances over linear networks are measured based on
different metrics, such as shortest-path distance. The class of appropriate metrics for
point processes on linear networks is called regular distances, which we denote by dL.
Furthermore, integration on L is done with respect to arc length and is represented by
ş
d1u (Rakshit et al., 2017; Cronie et al., 2020; Moradi and Sharifi, 2024).
2.2
Marked point processes in Euclidean spaces
Let X denote a marked point process on Rd ˆ M. The expected number of points in
A “ B ˆ C P BpRd ˆ Mq is
ΛpAq “ E rcardpX X Aqs “
ż
A
λ ppu, mpuqq du νpdmpuqq,
5

where λp¨q is the intensity function of X, and governs its spatial distribution. If λp¨q “ λ,
then X is called a homogeneous point process; otherwise, X is said to be inhomogeneous.
Moreover, X is stationary if its distribution is invariant under translation, meaning that
the distributions of X “ tpxi, mpxiqquN
i“1, N ě 0, and X ` s “ tpxi ` s, mpxiqquN
i“1, s P
Rd, are the same. Under stationarity assumptions ΛpAq reduces to ΛpAq “ ΛpB ˆCq “
λ|B|PMpCq.
For any non-negative measurable function h on pRd ˆ Mqn, applications of Camp-
bell’s formula yield
E
»
–
‰
ÿ
px1,mpx1qq,...,pxn,mpxnqqPX
h
´
px1, mpx1qq, . . . , pxn, mpxnqq
¯
fi
fl
“
ż
pRdˆMqn h
´
pu1, mpu1qq, . . . , pun, mpunqq
¯
ˆ λpnq´
pu1, mpu1qq, . . . , pun, mpunqq
¯ n
ź
i“1
duiνpdmpuiqq,
where ř‰ is a sum over distinct n-tuples of points in X and λpnq denotes the n-th,
n ě 1, order product density function of X. Heuristically, λpnq can be interpreted as the
probability that X has points pxi, mpxiqq in distinct infinitesimal regions dpxi, mpxiqq P
RdˆM. However, it is important to note that small/large values of λpnq do not imply any
association between the marked points. Instead, imposing that the intensity functions of
all orders are bounded away from zero, associations between the n points pxi, mpxiqq, i “
1, . . . , n could be revealed using the correlation function gpnq
RdˆM defined by
gpnq
RdˆM
´
px1, mpx1qq, . . . , pxn, mpxnqq
¯
“λpnqppx1, mpx1qq, . . . , pxn, mpxnqqq
λpx1, mpx1qq ¨ ¨ ¨ λpxn, mpxnqq
“
λpnq
Rdpx1, . . . , xnq
λRdpx1q ¨ ¨ ¨ λRdpxnq
f pnq
M pm1, . . . , mn|x1, . . . , xnq
f p1q
M pm1|x1q ¨ ¨ ¨ f pnq
M pmn|xnq
“gpnq
Rd px1, . . . , xnqγpnq
M pm1, . . . , mn|x1, . . . , xnq,
where gp1q
RdˆMpx1, mpx1qq “ 1, fM is the conditional density function of marks given
the spatial locations of points, and gpnq
Rd is the n-th order correlation function for the
ground process (Cronie et al., 2024; Eckardt and Moradi, 2024b). Next, we go through
global mark summary statistics for marked point processes when d “ 2 and marks are
either real-valued or function-valued. In general, these summary statistics, defined for
stationary point processes, display the average association among marks as a function
of an interpoint distance r ě 0, aiming at uncovering the average space-dependent
distributional behaviours for marks.
6

2.2.1
Summary statistics for marked point processes with real-valued marks
Here, one needs to employ a test function tf : MˆM Ñ R` for constructing global mark
correlation functions in their most general form. For every two points px, mpxqq, py, mpyqq P
X, conditional on having an interpoint distance r, i.e., dR2px, yq “ r, let have
ctfprq “ E
”
tf pmpxq, mpyqq
ˇˇˇpx, mpxqq, py, mpyqq P X
ı
,
which is a conditional expectation in the Palm sense (Chiu et al., 2013). The global
mark correlation functions are generally derived from ctfprq. Under the assumption of
mark independence, i.e., when r Ñ 8, we have
ctfp8q “
ż
R
ż
R
tfpmpxq, mpyqqνpdmpxqqνpdmpyqq.
Normalising ctfprq via ctf “ ctfp8q gives rise to the tf-correlation functions κtfprq as
κtfprq “ ctfprq
ctf
,
whose precise form and interpretation depends on the specification of the test function
under study. Note that the normalising factor ctf varies depending on what form the
numerator ctfprq has. Under the assumption of mark independence, ctfprq coincides with
ctf. Whence, κtfprq equals one, and, therefore, any deviations from unity indicate the
existence of associations/variations among marks. We add that ctfprq can be rewritten
as
ctfprq “
ϱp2q
tf prq
ϱp2qprq,
(1)
where the numerator ϱp2q
tf is the tf-second-order product density function of
αp2q
tf pB1, B2q
“ E
‰
ÿ
px,mpxqq,
py,mpyqq PX
tfpmpxq, mpyqq1B1txu1B2tyu
for any B1, B2 P BpR2q, where 1B1txu “ 1tx P B1u is an indicator functions, and the
denominator ϱp2qprq is the second-order product density function of the ground process.
Recall that we define the mark correlation functions for stationary point processes, and,
thus, the second-order product densities only depend on the spatial distance between
x, y P Rd, i.e., r. For further details, see Schlather (2001); Illian et al. (2008); Eckardt
and Moradi (2024a,b).
7

For simplicity, we rewrite mpxq, mpyq as m1, m2. Prominent cases from the literature
which describe the average association between marks include Isham’s mark correlation
function κIsh
mmprq (Isham, 1985) with the test function tfpm1, m2q “ m1m2´µ2
M, Stoyan’s
mark correlation function κSto
mmprq (Stoyan and Stoyan, 1994) with the test function
tfpm1, m2q “ m1m2, Beisbart’s and Kerscher’s mark correlation function κBei
mmprq with
the test function tfpm1, m2q “ m1 ` m2 (Beisbart and Kerscher, 2000), and the r-mark
correlation functions κm‚ and κ‚m (corresponding to the conditional mark mean) with
the test functions tfpm1, m2q “ m1 and tfpm1, m2q “ m2, respectively. Further mark-
association-related summary statistics which can be interpreted as the average pairwise
mark autocorrelation are Schlather’s and Shimatani’s I functions ISch
mmprq and IShi
mmprq
with the test functions tfpm1, m2q “ pm1 ´ µMprqqpm2 ´ µMprqq and tfpm1, m2q “
pm1 ´ µMqpm2 ´ µMq, respectively (Schlather et al., 2004; Shimatani, 2002). Here,
µMprq refers to the average of marks for points which stay exactly r units away from
each other. Turning our attention to the average variation among marks, there exists the
mark variogram γmmprq (Cressie, 1993; W¨alder and Stoyan, 1996; Stoyan and W¨alder,
2000) with the test function tfpm1, m2q “ 0.5pm1 ´ m2q2 and the mark differentiation
function ∇mmprq (Pommerening et al., 2011; Hui and Pommerening, 2014) with the test
function tfpm1, m2q “ 1 ´ minpm1, m2q{ maxpm1, m2q. Note that, due to the distinct
forms of these mark correlation functions, they each have their own normalising factors.
For instance, in the case of Stoyan’s mark correlation function κSto
mmprq, we have
ctfp8q “
ż
R
ż
R
tfpm1, m2qνpdm1qνpdm2q
“
ż
R
ż
R
m1m2νpdm1qνpdm2q
“ µ2
M,
while in the case of mark variogram γmmprq, we have
ctfp8q “
ż
R
ż
R
tfpm1, m2qνpdm1qνpdm2q
“
ż
R
ż
R
0.5pm1 ´ m2q2νpdm1qνpdm2q
“ 0.5
« ż
R
m2
1νpdm1q `
ż
R
m2
2νpdm2q
´
ż
R
ż
R
2m1m2νpdm1qνpdm2q
ff
“ σ2
M.
It is important to mention that, for Schlather’s and Shimantani’s I functions, it is
standard practice to normalize the test function by σ2
M to create a close analogy to
8

Moran’s index I (Moran, 1950; Shimatani, 2002). A comparison of the outcomes from
different mark correlation functions across various scenarios is presented in Eckardt
and Moradi (2024b).
Since these functions study mark associations and variations
from different perspectives, their findings will naturally differ.
2.2.2
Summary statistics for marked point processes with function-valued
marks
Setting M “ FpT q with T “ pa, bq, ´8 ď a ď b ď 8, and replacing the marks mpxiq by
the function-valued quantities fpxiqptq : T Ď R ÞÑ R, leads to spatial point processes
with function-valued marks within which X “ txi, fpxiqptquN
i“1, N ě 0.
Following
Eckardt et al. (2023) and writing a generalised test function as tf : FpT qˆFpT q Ñ R`,
one can adapt the mark correlation functions in Section 2.2.1 to the present setting and
define pointwise mark summary statistics. Setting f1 “ fpxqptq and f2 “ fpyqptq, for
points px, f1q, py, f2q P X with an interpoint spatial distance dR2px, yq “ r, we have
ctfpr, tq “ E
”
tf pf1, f2q
ˇˇˇpx, f1q, py, f2q P X
ı
,
(2)
and
ctfptq “
ż
FpT q
ż
FpT q
tfpf1, f2qνpdf1qνpdf2q.
(3)
Similar to Section 2.2.1, different normalised and unnormalised pointwise mark cor-
relation functions can be defined for the present setting. By taking the conditional
expectations ctfpr, tq and ctfptq “ ctfp8, tq, we can have pointwise tf-correlation func-
tions
κtfpr, tq “ ctfpr, tq
ctfptq .
Note that, in this context, pointwise refers to the functional argument t being fixed.
Given the pointwise mark characteristics ctfpr, tq and κtfpr, tq, the mark characteristics
ctfprq and κtfprq can then be obtained through integration over T as
ctfprq “
ż
T
ctfpr, tqdt,
and
κtfprq “
ż
T
κtfpr, tqdt.
As showcases, we can see that, for all pairs of points px, f1q, py, f2q P X for which
dR2px, yq “ r, the unnormalised mark variogram γffprq and Stoyan’s mark correlation
function κSto
ff prq are of the forms
γffprq “
ż
T
E
”
0.5pf1 ´ f2q2ˇˇˇpx, f1q, py, f2q P X
ı
dt,
9

and
κSto
ff prq “
ż
T
E
”
f1f2
ˇˇˇpx, f1q, py, f2q P X
ı
dt.
2.3
Marked point processes on linear networks
Now, we consider situations where the spatial locations of points are forced to be on
a network structure. More specifically, we let S be a linear network L and focus on
a marked point process XL on L ˆ M.
Similar to the case where spatial locations
can occur anywhere in space, and following Campbell’s formula, for any non-negative
measurable function h on pL ˆ Mqn, it holds that
E
»
–
‰
ÿ
px1,mpx1qq,...,pxm,mpxmqqPXL
h
´
px1, mpx1qq, . . . , pxm, mpxnqq
¯
fi
fl
“
ż
pLˆMqn h
´
pu1, mpu1qq, . . . , pun, mpunqq
¯
ˆλpnq
L
´
pu1, mpu1qq, . . . , pun, mpunqq
¯ n
ź
i“1
d1uiνpdmpuiqq,
where λpnq
L
is the n-th, n ě 1, order product density function of XL.
Note that,
considering the first order of the above equation and letting hpx, mpxqq “ 1tpx, mpxqq P
Au, A Ď L ˆ M, we have
E
«
cardpXL X Aq
ff
“ E
»
–
‰
ÿ
px,mpxqqPXL
h ppx, mpxqqq
fi
fl
“
ż
A
λp1q
L pu, mpuqq d1u νpdmpuqq,
where λp1q
L pu, mpuqq “ λLpu, mpuqq denotes the intensity function of XL, governing its
spatial distribution over the product space L ˆ M. Currently, there is no appropriate
transformation for network structures that can shift points while ensuring they remain
on the network after being transformed. Hence, stationary point processes on linear
networks cannot be defined in the same manner as those on planar spaces. Imposing
that the intensity function λLpu, mpuqq is bounded away from zero, we have the n-th
order correlation function as
gpnq
LˆM
´
px1, mpx1qq, . . . , pxn, mpxnqq
¯
“gpnq
L px1, . . . , xnqγpnq
M pm1, . . . , mn|x1, . . . , xnq.
10

Following Cronie et al. (2020); Eckardt and Moradi (2024b); Cronie et al. (2024), a
point process XL is intensity reweighted moment pseudo-stationary (IRMPS), if
gpnq
LˆM
´
px1, mpx1qq, . . . , pxn, mpxnqq
¯
“¯gpnq´
dLpu, x1q, . . . , dLpu, xnq, mpx1q, . . . , mpxnq
¯
,
for any fixed u P L and some function ¯gpnq : r0, 8qn ˆMn Ñ r0, 8q. In particular, XL is
k-th order IRMPS if the above equality holds for any k ě 2. If XL is homogeneous and
k-th order IRMPS, it is then k-th order pseudo-stationary. Finally, if this holds for any
k ě 1, in a way that moments completely and uniquely characterises the distribution
of XL, we call XL pseudo-stationary.
2.3.1
Summary statistics for marked point processes with real-valued
marks
Prior to employing the mark correlation functions in Section 2.2.1 for studying the mark
association/variation for marked point processes on linear networks, one first needs to
adapt those functions so that they take the geometry of the underlying network into
account. Hence, distances between any two points on a linear network are measured via
different choices within the class of regular distances (Rakshit et al., 2017), depending
on the application. Below, we briefly review mark correlation functions for marked
point processes on linear networks.
Let tL
f : MˆM Ñ R` be a test function similar to those introduced in Section 2.2.1;
the superscript L is only used to emphasise the role of linear networks in this section.
For every pairs of points px, mpxqq, py, mpyqq P XL, given that their interpoint network
distance is dLpx, yq “ rL, Eckardt and Moradi (2024a) defined
cL
tL
fprLq “ E
”
tL
f pmpxq, mpyqq
ˇˇˇpx, mpxqq, py, mpyqq P XL
ı
,
and cL
tL
f “ cL
tL
fp8q. The tL
f -correlation function is then similarly defined as
κL
tL
fprLq “
cL
tL
fprLq
cL
tL
f
.
Next, we give examples of such mark correlation functions for network-constrained point
processes with real-valued marks. By setting m1 “ mpxq, m2 “ mpyq, the unnormalised
mark differentiation function ∇L
mm follows by specifying tL
f as 1´minpm1, m2q{ maxpm1, m2q,
yielding
∇L
mmprLq “ E
«
1 ´ minpm1, m2q
maxpm1, m2q
ˇˇˇˇˇpx, m1q, py, m2q P XL
ff
,
11

given that dLpx, yq “ rL. Eckardt and Moradi (2024a) performed a simulation study
where they considered different scenarios for the mark distribution of points and showed
that when ignoring the geometry of the underlying network, the mark correlation func-
tions in Section 2.2.1 are not able to detect the true mark associations/variations.
2.3.2
Summary statistics for marked point processes with function-valued
marks
Now, we consider a point process XL on L ˆ FpT q with points on a linear network L
and their corresponding function-valued marks on FpT q with T “ pa, bq, ´8 ď a ď
b ď 8. Similar to Section 2.2.2, here marks are of the form fpxiqptq : T Ď R ÞÑ R.
Writing tL
f : FpT q ˆ FpT q Ñ R` to denote a generalised test function with arguments
f1 “ fpxqptq and f2 “ fpyqptq for a fixed time point t, all mark correlation functions
can be defined using pointwise specifications analogous to Section 2.2.2.
Denoting the counterparts of (2) and (3) as cL
tL
fprL, tq and cL
tL
fptq “ cL
tL
fp8, tq, we can
define the pointwise tL
f -correlation function κL
tL
fprL, tq by
κL
tL
fprL, tq “
cL
tL
fprL, tq
cL
tL
fptq
.
All mark correlation functions for marked point processes on linear networks with
function-valued marks can be derived through integration with respect to time t as
κL
tL
fprLq “
ż
T
κL
tL
fprL, tqdt.
Further details can be found in Eckardt et al. (2024b)
3
Local Indicators of Mark Association
Next, instead of looking at the average mark associations/variations among marks,
which is what global mark correlation functions focus on, we propose local mark cor-
relation (LIMA) functions to uncover significant local mark associations/variations.
Recall that global mark correlation functions may often fail to uncover the true as-
sociation/variation among marks as different mark behaviours may mask each other
(Chaudhuri et al., 2023; Moradi et al., 2023). Following the same structure as in Sec-
tion 2, we define our LIMA functions for marked point processes on planar spaces as well
as on linear networks when points are labelled by either real-valued or function-valued
marks. For every individual point, these local indicators are of great use to uncover
its specific interrelations with the marks of other points within its surroundings as
functions of distances r, rL ě 0.
12

3.1
Marked point processes in planar spaces
3.1.1
Local indicators for spatial point processes with real-valued marks
Let X be a marked point process on Rd ˆ R with mi “ mpxiq denoting the mark of
its i-th point. Moreover, consider tf,i : R ˆ R ÞÑ R` as a (local) test function. For
a fixed point pxi, miq P X and all other points pxj, mjq P Xzpxi, miq conditional on
dRdpxi, xjq “ r, we then have
ctf,iprq “ Epxi,miq
”
tf,ipmi, mjq
ˇˇˇpxj, mjq P Xzpxi, miq
ı
.
(4)
Note that we can here, in fact, write tf,i “ tf; however, to distinguish between local
and global cases, we explicitly use the index i. The above conditional expectation of
the test function under mark independence is represented by ctf,i “ ctf,ip8q with the
form
ctf,i “
ż
R
ż
R
tf,ipmi, mjqνpdmiqνpdmjq.
(5)
Note that in both ctf,iprq and ctf,i, the point pxi, miq P X is fixed as we are here interested
in studying its mark association with other points in its surroundings. Normalising
ctf,iprq by ctf,i yields the local tf,i-correlation function κtf,iprq,
κtf,iprq “ ctf,iprq
ctf,i
.
(6)
Any mark correlation function that is defined following the above principle/formulations
will be called a LIMA function. Note that different choices of tf,i give rise to different
local mark correlation functions. Recalling the presentation of ctfprq in (1), ctf,iprq can
be rewritten as
ctf,iprq “
ϱp2q
tf,iprq
ϱp2q
i prq
(7)
where the numerator ϱp2q
tf,i is the local tf-second-order product density function of
αp2q
tf,ipB1, B2q
(8)
“ Epxi,miq
«
ÿ
pxj,mjqPXzpxi,miq
tf,ipmi, mjq1B1txiu1B2txju
ff
,
for any B1, B2 P BpRdq and the denominator ϱp2q
i prq is, heuristically, the probability
of observing a point xi and any point xj in the distinct areas B1 and B2, i.e., the
13

second-order product density function of the ground process where the first point is
treated as fixed. The index pxi, miq in the expectation emphasises that the expectation
depends on the fixed point pxi, miq. Thus, κtf,iprq can be interpreted as a ratio of two
infinitesimal probabilities adjusted by the expectation of the local test function under
mark independence.
Letting d “ 2, by focusing on the variation of marks, suitable LIMA functions
include the local mark variogram γmimjprq with local test function
tf,ipmi, mjq “ 0.5}mi ´ mj}2,
(9)
and the local mark differentiation function ∇mimjprq with local test function
tf,ipmi, mjq “ 1 ´ minpmi, mjq{ maxpmi, mjq.
(10)
Furthermore, the local association between the i-th mark mi and the marks mj of
neighbouring points at spatial distances r ą 0 can be investigated using the local
mark correlation functions κSto
mimjprq (Stoyan), κBei
mimjprq (Beisbart and Kerscher), and
κIsh
mimjprq (Isham) with the test functions specified as
tf,ipmi, mjq “ mimj,
(11)
tf,ipmi, mjq “ mi ` mj,
(12)
and
tf,ipmi, mjq “ mipmj ´ µjq,
(13)
where µj is the mean of all such mj, and the local function ISch
mimjprq (Schlather) with
the test function
tf,ipmi, mjq “ mipmj ´ µjprqq.
(14)
where µjprq is the mean of all such j-th marks for which dR2pxi, xjq “ r. Moreover, the
local r-mark correlation function κ‚mjprq has the test function
t‚,j “ mj.
(15)
Lastly, the local I functions IShi
mimjprq (Shimantani) is of the form
tf,ipmi, mjq “ mipmj ´ µjq,
(16)
which coincides with the local version of the Isham mark correlation function, given in
(13).
14

In the independent mark scenario, the expectations of the above local test function
coincide with their expected value when r Ñ 8. Hence, under mark independence,
κtf,iprq becomes one for all values of r, and any deviations from unity indicate the
presence of mark structural dependence between the i-th point and its neighbouring
points. To provide a few examples, the normalisation factor, i.e., equation (5), for the
local test function (11) becomes
ctf,i “ mi
ż
R
mjνpdmjq “ miµj,
and for the local test function (9) becomes
ctf,i “
ż
R
0.5pmi ´ mjq2νpdmjq
“ 0.5
”
pmi ´ µjq2 ` σ2
j
ı
,
where σ2
j is the variance of all such mj.
3.1.2
Local indicators for spatial point processes with function-valued marks
Given a point process X on Rd ˆFpT q and defining the local test function tf,i : FpT qˆ
FpT q ÞÑ R`, distinct local mark summary statistics can be constructed based on a
pointwise formulation. To this end, for a fixed t P T , let fi “ fpxiqptq denote the
function-valued mark for a specific point i and fj “ fpxjqptq denote the function-
valued mark for any alternative point in Xzpxi, fiq for which we have dRdpxi, xjq “ r.
Then, setting ctf,ipr, tq and ctf,iptq “ ctf,ip8, tq for the expectations of the local test
function for any pair of points at interpoint spatial distance r, yields the pointwise
local tf-correlation function κtf,ipr, tq,
κtf,ipr, tq “ ctf,ipr, tq
ctf,iptq .
(17)
By doing so, we obtain pointwise mark correlation functions with respect to fixed time
t P T . Hence, one can obtain
κtf,iprq “
ż
T
κtf,ipr, tqdt.
For example, the unnormalised local mark variogram γfifjprq can be constructed by
first computing the conditional expectation ctf,ipr, tq when having the test function
0.5pfiptq ´ fjptqq2 and then integrating ctf,ipr, tq over T .
15

3.2
Marked point processes on linear networks
3.2.1
Local indicators for spatial point processes on linear networks with
real-valued marks
This section is devoted to generalising Section 3.1.1 to network-constrained spaces. Let
XL represent a marked point process on L ˆ R with real-valued marks for which marks
of points xi P L are denoted by mi “ mpxq. Then, by fixing the point pxi, miq P XL, one
can, similar to (4) and (5), define cL
tL
f,iprLq, rL ě 0, and cL
tL
f,i “ cL
tL
f,ip8q for the conditional
expectations of the local test function tL
f,i : R ˆ R Ñ R`. Consequently, distinct local
mark correlation functions can be constructed, focusing on local average association,
variation or autocorrelation.
Note that, here, spatial distances are measured by a
regular distance dL.
Association-related LIMA functions for marked point processes on linear networks
include, the local mark correlation functions κL,Sto
mimjprLq and κL,Bei
mimjprLq with test func-
tions tL
f,ipmi, mjq “ mimj and tL
f,ipmi, mjq “ mi ` mj, to name a few, and the local
rL-correlation function κL
‚mjprLq with tL
f,ipmi, mjq “ mj. Furthermore, useful test func-
tions investigating local variations of marks include tL
f,ipmi, mjq “ 0.5 ¨ pmi ´ mjq2
and tL
f,ipmi, mjq “ 1 ´ pminpmi, mjq{ maxpmi, mjqq yielding the local mark variogram
γL
mi,mjprLq and mark differentiation function ∇L
mi,mjprLq, respectively.
3.2.2
Local indicators for spatial point processes on linear networks with
function-valued marks
Lastly, by increasing the complexity of marks to situations where they are functions/curves,
we define LIMA functions for marked point processes on linear networks with function-
valued marks. For XL denote by pxi, fiq “ pxi, fpxiqptqq a fixed point, and let pxj, fjq
be any arbitrary point in XLzpxi, fiq for which dLpxi, xjq “ rL. To adapt the above
construction principle to the present setting, we write tL
f,i : FpT q ˆ FpT q Ñ R` to de-
note a (local) test function with arguments fi and fj. Depending on the test function,
let cL
tL
f,iprL, tq denote the pointwise conditional expectation of tL
f,i at distance rL ě 0
and fixed functional argument t P T . Likewise, we can define the pointwise conditional
expectation of the local test function cL
tL
f,iptq “ cL
tL
f,ip8, tq as
cL
tL
f,iptq “
ż
FpT q
ż
FpT q
tL
f,ipfi, fjqνpdfiqνpdfjq,
and the local pointwise network-constrained tL
f,i-correlation function κL
tL
f,iprL, tq as
κL
tL
f,iprL, tq “
cL
tL
f,iprL, tq
cL
tL
f,iptq
.
(18)
16

Then, different association/variation/autocorrelation-related LIMA functions follow from
the integration of κL
tL
f,iprL, tq and cL
tL
f,iprL, tq yielding
cL
tL
f,iprLq “
ż
T
cL
tL
f,iprL, tqdt.
and
κL
tL
f,iprLq “
ż
T
κL
tL
f,iprL, tqdt
as the unnormalised and normalised integrated mark correlation functions.
3.3
Estimation
Now, we focus on presenting non-parametric estimators for the LIMA functions we
previously proposed. Since we consider spatial point processes on different state spaces,
i.e., R2 and linear networks, and with different marks, i.e., real-valued and function-
valued marks, we present the estimators of the LIMA functions following the same
structure.
3.3.1
Spatial point processes in planar spaces with real-valued marks
In order to present estimators for our proposed LIMA functions, we make use of the
representation of ctf,iprq as the ratio of two product density functions as given in (1) and
(7). In particular, we present unbiased estimators for the numerator and denominator
of (6) as
(19)
y
ϱp2q
tf,iprq
“
1
2πr|W|
ÿ
pxj,mpxjqqPX
tf,i
´
mpxiq, mpxjq
¯
ˆ
K
´
dR2pxi, xjq ´ r
¯
and
(20)
y
ϱp2q
i prq
“
1
2πr|W|
ÿ
pxj,mpxjqqPX
K
´
dR2pxi, xjq ´ r
¯
leading to
y
ctf,iprq “
y
ϱp2q
tf,iprq
y
ϱp2q
i prq
,
(21)
17

where Kp¨q is a kernel function, and |W| is the area of the observation window W.
In both estimators (19) and (20), an edge correction factor could be included, but
as pointed out by Illian et al. (2008), it might be ignored when both numerator and
denominator are estimated using the same estimation principle. Applying the Campbell
formula, it can be shown that both estimators (19) and (20) are unbiased estimators
such that their ratio, given in (21), results in a ratio-unbiased estimator for ctf,iprq (Illian
et al., 2008; Chiu et al., 2013). Having proposed estimators for the unnormalised LIMA
functions, we next focus on the normalisation factor, which represents the expectation
of the test function under mark independence. The normalisation factor, given in the
denominator of (6), is estimated as
y
ctf,i “
1
n ´ 1
ÿ
j
tf,i
´
mpxiq, mpxjq
¯
.
As a showcase, for tf,ipmpxiq, mpxjqq “ mpxiqmpxjq, we have
y
ctf,i “
1
n ´ 1
ÿ
j
mpxiqmpxjq “ mpxiq
n ´ 1
ÿ
j
mpxjq.
Note that the focus here is on the association between the mark of the i-th point and
the marks of all the other points.
3.3.2
Spatial point processes in planar spaces with function-valued marks
In a similar manner as in Section 3.3.1, ctf,ipr, tq can be estimated through the ratio of
the estimators for the pointwise local second-order product density functions ϱp2q
tf,ipr, tq
and ϱp2q
i prq which are of the form
y
ϱp2q
tf,ipr, tq
“
1
2πr|W|
ÿ
pxj,fpxjqptqqPX
tf,i
´
fpxiqptq, fpxjqptq
¯
ˆ
K
´
dR2pxi, xjq ´ r
¯
,
and
y
ϱp2q
i prq
“
1
2πr|W|
ÿ
pxj,fpxjqptqqPX
K
´
dR2pxi, xjq ´ r
¯
,
respectively. Further, the normalisation factor ctf,iptq is estimated as
y
ctf,iptq “
1
n ´ 1
ÿ
j
tf,i
´
fpxiqptq, fpxjqptq
¯
18

yielding the pointwise estimator for the local tf-correlation function κtf,ipr, tq as
y
κtf,ipr, tq “ y
ctf,ipr, tq
y
ctf,iptq
“
y
ϱp2q
tf,ipr, tq{y
ϱp2q
tf,iprq
y
ctf,iptq
.
From both estimators y
ctf,iptq and y
κtf,ipr, tq, the integrated estimators follow from inte-
gration over T giving rise to
y
ctf,iprq “
ż
T
y
ctf,ipr, tqdt
and
y
κtf,iprq “
ż
T
y
κtf,ipr, tqdt.
3.3.3
Spatial point processes on linear networks with real-valued marks
Following the same procedure as in Section 3.3.1, we have
y
cL
tL
f,iprq
“
ř
j tL
f,ipmpxiq, mpxjqqKpdLpxi, xjq ´ rq
ř
j KpdLpxi, xjq ´ rq
,
and consequently
y
κL
tL
f,iprq “
y
cL
tL
f,iprq
y
cL
tL
f,i
,
where y
cL
tL
f,i is of the form
y
cL
tL
f,i “
1
n ´ 1
ÿ
j
tL
f,i
´
mpxiq, mpxjq
¯
.
3.3.4
Spatial point processes on linear networks with function-value marks
Lastly, for spatial point processes on linear networks with function-valued marks, es-
timators of the local functions cL
tL
f,iprq and κL
tL
f,iprq can be obtained by integrating the
local pointwise estimators
y
cL
tL
f,ipr, tq
“
ř
j tL
f,i
´
fpxiqptq, fpxjqptq
¯
K
´
dLpxi, xjq ´ r
¯
ř
j K
´
dLpxi, xjq ´ r
¯
,
19

and
y
κL
tL
f,ipr, tq “
y
cL
tL
f,ipr, tq
y
cL
tL
f,iptq
,
where
y
cL
tL
f,iptq “
ř
j tL
f,i
´
fpxjqptq, fpxjqptq
¯
n ´ 1
.
4
Simulation study
This section is devoted to evaluating the statistical performance of our proposed LIMA
functions under different scenarios, comparing their performance to the existing global
mark correlation functions. More specifically, we focus on the probability of type I
error and the power of the test. In other words, we investigate situations where no
mark structure exists to determine how often global mark correlation functions and
LIMA functions incorrectly identify mark structures, as well as cases where local mark
structures are present in parts of the data to see how frequently global mark correlation
functions fail to detect them, while LIMA functions successfully capture local mark
behaviours. To do so, we consider 500 realisations of a homogeneous Poisson point
process with intensity function 500 on a square-unit window, with four scenarios: I)
marks are independently generated from a normal distribution Np5, 0.5q, II) two distinct
areas as discs with radius 0.075 exist, where in one of them, marks are independently
generated from Np7, 0.5q, and in the other, from Np3, 0.5q, while marks outside these
areas follow Np5, 0.5q; these areas contain approximately 4% of the total points and
their location randomly varies among 500 simulated patterns, III) there are two areas of
the same size as in scenario II where marks are generated from Np7, 0.5q, while points
outside these regions are generated from Np5, 0.5q, and IV) points close to the diameter
of the square-unit window have marks generated from Np7, 0.5q while for the rest of the
points marks are again generated from Np5, 0.5q. Regarding the spatial distribution of
points, the same 500 unmarked generated patterns are used across different scenarios,
allowing for a clearer comparison of the effects of different mark associations. We use
the R package spatstat (Baddeley et al., 2015) and its sub-packages for simulations.
Within each scenario, for any single realisation, we use global envelope tests (Myl-
lym¨aki et al., 2017), within the distance range r0, rs “ r0, 0.25s, to statistically identify
any deviation from random labelling, i.e., verify the existence of any structure on the
spatial distribution of marks.
In the case of LIMA functions, we apply global en-
velope tests to each individual point.
This allows us not only to detect deviations
from random labelling but also to reveal which specific points contribute to the test’s
20

Figure 1:
Examples of mark structures within the four scenarios. From left to right:
scenario I, II, III and IV. For simplicity, mark values are ignored, and only points with
different mark distributions are highlighted in different colours and shapes.
significance. Concerning the type of global envelop test, we employ the completely
non-parametric rank envelope test based on extreme rank lengths, known as ‘erl’ (Myl-
lym¨aki and Mrkviˇcka, 2023), with 500 permutations. Figure 1 shows one of the 500
generated patterns wherein, for each scenario, points within areas with different mark
structures/associations are highlighted with different colours and shapes. Throughout
the simulation study, we only use the local mark correlation functions κSto
mimj as gen-
eral results based on other LIMA functions will be similar. We also add that for some
graphical representations, we make use of the R package ggplot2 (Wickham, 2016).
4.1
Scenario I
As previously stated, in this scenario, the focus is on the performance of mark cor-
relation functions when, in reality, there are no mark associations among points, and
they are just randomly labelled by values generated from Np5, 0.5q. By applying global
envelope tests with 500 permutations and a significance level of 0.05, the global mark
correlation function κSto
mm mistakenly detects some mark structure/association among
points in 6% of the patterns, without providing any insight into which points con-
tribute to the test’s significance. For the local mark correlation function κSto
mimj, using
the same procedure, we find that, on average, the contribution of individual points to
21

the mark structure/association among points is mistakenly identified as significant for
only 4.8% of points. Note that by using our proposed LIMA functions, we get insight
into individual points; this is not possible when using global functions. Thus, we are
further interested in finding what makes those points significant. Points with significant
LIMA functions for one of the 500 simulated point patterns are depicted in the left plot
in Figure 2 with corresponding discs highlighting the neighbourhood for which mark
association deviates from random labelling. We observe that sparse neighbourhoods
often surround these points. In other words, this might have been caused by the lack
of enough information in their vicinity. Moreover, the right plot of Figure 2 shows the
box-plot of all type I error probabilities of the LIMA functions for the 500 simulated
point patterns.
Figure 2:
Left: One of the 500 simulated patterns, with significant points highlighted
in red and their corresponding significant neighbourhoods shown as discs. Right: Box-
plot of the type I error probabilities across the 500 simulations, with the horizontal
dashed line representing 0.05.
4.2
Scenario II
This scenario represents a case where two regions exhibit distinct mark distributions
compared to the rest of the observation window, with their mark behaviour potentially
being masked by the mark distribution of points outside these regions. Based on the
global envelope tests performed, the global mark correlation function κSto
mm succeeds in
only 40% of the times to detect that there is some mark structure without offering
additional insight into the nature of the structure. Moreover, Figure 3 shows the box-
plot of the obtained p-values for the global envelope tests corresponding to the 500
simulated patterns. However, the local mark correlation function κSto
mimj successfully
detects the mark structures for all 500 patterns. It is important to note that with
local mark correlation functions, not only are the points within the designated regions
expected to be identified as significant, but also the points interacting with them,
depending on the distance range r0, rs used for the calculation. Thus, it is not immediate
22

Figure 3:
Results for scenario II. Left: Box-plot of p-values from 500 global envelope
tests using the global mark correlation function κSto
mm. Middle: One of the 500 simulated
point patterns, with regions of different mark distributions highlighted in blue, red discs
of radius r “ 0.25 centred on these regions, and significant points marked in red or blue.
A single point is highlighted as `. Right: Global envelope for the point highlighted
as ` in the middle plot. The solid line is the local mark correlation function κSto
mimj
for the chosen point, and the dashed line shows the average of κSto
mimj based on 500
permutations.
to calculate the power of the test for the local mark correlation function κSto
mimj with
respect to the number of tests performed. As an alternative, in Figure 3, we also show
one of the simulated point patterns together with its points having significant local
contributions highlighted in red/blue. The blue disc stands for the regions where the
mark distribution differs from the rest of the points, and all points within these regions
are correctly identified as having significant contributions. In addition, we also show
red discs of radius r “ 0.25 (maximum r considered) centred on these regions within
which some of the points (red ones) are identified as significant, i.e., the red points, due
to their interaction with the blue points. As shown in Figure 3, no point beyond the
distance r “ 0.25 from the centre of the designed regions is identified as significant as
they do not interact with blue points. In addition, we represent the global envelope test
for a single point, highlighted as ` in the middle panel, for which the corresponding
local mark correlation function stays within the envelope.
4.3
Scenario III
This scenario is similar to the second one, except that the same mark distribution is
applied within both considered regions. The use of the global mark correlation func-
tion κSto
mm in combination with global envelope tests results in rejecting the hypothesis
of random labelling only 47% of the time, without indicating where the points with
significant contributions are located. However, by employing the local mark correlation
function κSto
mimj, in all 500 simulated point patterns, local mark structures are correctly
23

Figure 4:
Results for scenario III. Left: Box-plot of p-values from 500 global envelope
tests using the global mark correlation function κSto
mm. Middle: One of the 500 simulated
point patterns, with regions of different mark distributions highlighted in blue, red discs
of radius r “ 0.25 centred on these regions, and significant points marked in red or blue.
A single point is highlighted as `. Right: Global envelope for the point highlighted
as ` in the middle plot. The solid line is the local mark correlation function κSto
mimj
for the chosen point, and the dashed line shows the average of κSto
mimj based on 500
permutations.
identified. Figure 4 shows the box-plot of the p-values for the 500 global envelope tests
based on the global mark correlation function κSto
mm, together with the results of the local
mark correlation function κSto
mimj for one of the simulated patterns; the same pattern as
in Figure 3 is chosen. Similarly, we can see that all the points in the blue regions are
identified as having significant contributions. In addition, some of the nearby points
that interact with the points in the blue regions are also detected as significant. As
for a comparison between scenarios II and III, we again focus on the same point as
chosen in scenario II. Unlike scenario II, according to the global envelope tests, the
contribution of this point is here identified as significant for distance r ě 0.22. The
difference in significance arises because, in scenario II, the point is surrounded by two
regions with different mark distributions, which counterbalance each other’s effects for
distance r ě 0.22. In scenario III, however, the point is surrounded by two regions
with the same mark distribution, strengthening its interactions with nearby points,
particularly within the distance range r0.22, 0.25s as shown in the right panel of Fig-
ure 4. However, when employing mark correlation functions and, in general, summary
statistics for point processes, the focus is on smaller distances to better capture local
behaviours, according to which, in both scenarios II and III, the local mark correlation
function for this specific point stays within the envelope.
24

4.4
Scenario IV
This scenario concerns the situation wherein points closer to the diameter of the ob-
served window have larger marks. Combining the global mark correlation function κSto
mm
with global envelope tests based on 500 permutations, we find that in only 42.6% of the
times, the hypothesis of random labelling, at significance level 0.05, has been rejected.
Figure 5 shows the box-plot of the obtained p-values for the global envelope tests for
the 500 simulated patterns, having a third quartile of approximately 0.3. Turning to
our proposed LIMA functions, we see that the local mark correlation function κSto
mimj
correctly detects some mark structure for all the 500 simulated point patterns. As a
showcase, we again revisit the specific pattern used in Figure 3 and 4. From Figure
5, we can see that all the points around the window’s diameter with different mark
distribution than the rest of the points are identified as significant. In addition to these
points, some further points, having a distance less than r “ 0.25 from the window’s
diameter, are also identified as significant due to their interactions with points around
the window’s diameter. It can be seen that no point beyond that distance is detected
as significant since they have no local interaction with the blue points for r ď 0.25.
Figure 5:
Results for scenario IV. Left: Box-plot of p-values from 500 global envelope
tests using the global mark correlation function κSto
mm. Right: One of the 500 simulated
point patterns, with regions of different mark distributions highlighted in blue around
a dotted line representing the window’s diameter, significant points marked in red or
blue, and two dashed lines parallel to the diameter, positioned r “ 0.25 units away.
5
Application
This section focuses on applying our proposed local mark correlation functions within
different applications dealing with distinct state spaces, such as R2 and linear networks
with different types of marks, including real-valued and function-valued marks.
25

5.1
Duke Forest data
The Duke forest data contains the locations of 10, 053 trees of 37 species located in an
area of size 65km2 (convex hull of the locations), which is split into three sub-areas:
west, east, and south. The location of each tree is also labelled by its diameter at
breast height (dbh), which was measured at some time during 2014. Most species are
distributed within the three sub-areas. Here, we only focus on blackgum trees, which
often have smooth leaves with non-toothed margins. The pattern of blackgum trees
contains the locations of 276 trees, which can be seen in the middle plot given in Figure
6 showing that blackgum trees are spread in the three sub-areas. The dbh of blackgum
trees (represented by the size of the points) varies between 0.7 and 30.1 with an average
of 5.9; the median is 4.35.
In order to study the spatial association among marks and check any deviation from
random labelling, we first make use of the global mark correlation function κSto
mm. The
left panel of Figure 6 shows the obtained global envelope based on 500 permutations
under random labelling, wherein we can see that the estimated global mark correlation
function κSto
mm for the point pattern of blackgum trees stays within the envelope indicat-
ing no evidence against the assumption of random labelling, the corresponding p-value
is 0.152. Thereafter, we employ our proposed local mark correlation function κSto
mimj
for any single point out of which we found that at significance level 0.05, 36.6% of the
points, corresponding to 101 trees, are detected as significant which are highlighted in
red in the middle panel of Figure 6. Recall that under the assumption of random la-
belling, we, in scenario I, showed that, on average, the probability of type I error for our
local mark correlation functions is 0.048. Additionally, it can be seen that significant
points are generally located in the central part of the forest, with some tendencies to-
ward the northeast. The dbh of these significant points varies between 0.7 and 20 with
an average of 5.8; the median is 4.2. Furthermore, we add that out of the 101 trees with
significant local mark associations, for 41 of them, the local mark correlation function
κSto
mimj stays outside the global envelope for some ranges within r ď 20 meters revealing
strong local associations in their surroundings. To provide further insights into this,
for every significant point, we obtain the ranges of distances for which κSto
mimj, from
either lower or upper bound, stays outside its corresponding envelope. These ranges
are displayed in the right panel of Figure 6, showing that most significant points have
significant mark associations within either small (r ď 20) or large (r ě 60) distances.
Interestingly, those with significant mark associations within a distance of r ď 20 fall
outside the envelope from the lower bound, meaning that, for any such points, the
product of their marks is smaller than that of random labelling. In other words, within
the set of trees detected as significant, nearby trees have small dbh. In contrast, trees
with significant mark associations within a distance of r ě 60 fall outside the envelope
from the upper bound, meaning that for any such pair of trees, at least one has a large
dbh.
26

5.2
Jersey City street crimes
We now turn our attention to an application in which event locations are restricted
to a linear network. Here, our objective is to analyse the time taken for the Jersey
City Police Department to reach crime scenes; time elapsed refers to the time difference
(in seconds) between when the police department receives a call and when they arrive
at the crime scene. Data were accessed from the Jersey City data portal1. The full
dataset includes different crimes recorded during 2017; some specific crimes, such as
sexual assaults and attempted suicides, are not part of the full dataset. As a showcase,
we here focus on crimes during March 2017, for which ambulances were requested. We
excluded crimes for which elapsed time was exactly reported as zero. There is a total
of 417 street crimes on the street network of Jersey City, which has 24, 936 nodes and
26, 824 edges, with a total length of 961, 328 meters and a maximum node degree of 6.
The elapsed time has an average of 709.9, a minimum of 60, and a maximum of 2700;
the median is 600. The middle panel of Figure 7 shows the locations of the crimes
together with their elapsed time as marks.
We follow the same procedure in our simulation studies and the Duke Forest case.
Initially, we employ the global mark correlation function κL,Sto
mm
jointly with global en-
velope tests based on 500 permutations. The left panel of Figure 7 shows that the
global mark correlation function κL,Sto
mm stays within the envelope and finds no evidence
of deviation from random labelling; the obtained p-value is 0.287. Thereafter, we turn
our attention to our proposed local mark correlation function κL,Sto
mimj, which has the
advantage of discovering locally significant contributions of individual points to the
global mark correlation functions. According to the global envelope tests performed
concerning each individual crime, based on 500 permutations, 37.5% of the crimes have
significant local contributions within different distance ranges. The significant crimes
are highlighted in red in the middle panel of Figure 7, where most are located in the
areas between Liberty National Golf Club and the New Jersey City University, with a
tendency towards the northeast. The average elapsed time for the significantly detected
crimes is 802.7 seconds. Of the 156 significantly detected crimes, 86 p55.1%q fall out-
side their corresponding envelopes even at small distance values, rL ď 2000, indicating
strong local associations within their surroundings. To better understand the distance
ranges for which these crimes are identified as having significant mark associations with
their neighbouring crimes, we get all the ranges of rL for which the corresponding local
mark correlation functions fall outside the envelope under the assumption of random
labelling. These are shown in the right plot of Figure 7 where one can see that most
significant ranges point to distances less than rL ď 3000.
1https://data.jerseycitynj.gov/pages/home-page/
27

5.3
Pfynwald data
The dataset comprises tree measurements collected annually over 14 years as part of a
long-term irrigation experiment in Pfynwald, located in the central region of the Pfyn-
Finges National Park in Switzerland (Schaub et al., 2016). Launched in 2003, this
study aimed to evaluate how increased water availability affects individual trees and
the broader ecosystem within a naturally dry Scots pine (Pinus sylvestris L.) forest.
The dataset, available under an Open Database License2, includes spatial coordinates,
initial treatment or control group assignments, and various characteristics for 900 trees.
For this analysis, we primarily focus on the annual total crown defoliation (TCD) and
the precise locations of individual trees. TCD is a commonly used metric in forest
monitoring to measure needle or leaf loss relative to a local reference tree. Some trees did
not have the mark values for the entire study period, i.e., 2003´2016. The cleaned data
is a point pattern with 741 points and function-valued marks, showing the yearly TCD
from 2003 to 2016. We used the convex hull of the data as the corresponding window.
Previously, Eckardt et al. (2023) studied the cross-mark association between the average
TCD and local pair correlation function as function-valued marks by applying the cross-
type mark correlation functions.
The middle panel of Figure 8 shows the point pattern of the trees and their corre-
sponding function-valued marks as grey curves on top of points. Similar to our proce-
dure for the previous two real datasets, we employ the global mark correlation function
κSto
ff jointly with global envelope tests based on 500 permutations; the corresponding
p-value is 0.014. Looking at the obtained global envelopes for the κSto
ff , presented in
the left panel of Figure 8, we can see that for small and moderate values of distance
r, it fully stays inside the envelope, showing no deviations from random labelling. For
larger values of r P p38.26, 41.41q, it, however, goes outside the envelope from its lower
bound. This means that for pairs of trees with an interpoint distance r P p38.26, 41.41q,
the product of marks is, on average, smaller than the corresponding value under mark
independence, which in turn means that for these pairs of trees, at least one of them
has a very small mark. At the same time, we should remember that this may not be
the true pattern of mark associations among trees, as domination can easily happen be-
tween distinct mark behaviours. This being said, the global mark correlation function
κSto
ff can not uncover more information about the distribution of TCD. Thereafter, we
employ our proposed local mark correlation function κSto
fifj, according to which we found
that 20.5% of the trees have significant local contributions at a significance level of 0.05.
The trees with significant contributions to the distributions of TCD are highlighted in
red in the middle panel of Figure 8; interestingly, we can see that most of such trees are
located at the bottom left of the study area. After checking the global envelope tests for
all the significant trees, we noticed that for the significant ones in the bottom left, the
local mark correlation function κSto
fifj stays outside of the envelope for small/moderate
2https://opendata.swiss
28

values of r for most of them. For some other trees κSto
fifj stays outside of the envelope
for large values of r. These significant behaviours/findings were not uncovered when
employing the global mark correlation function κSto
ff . To better see the ranges of inter-
point distances r for which the trees highlighted in red have been identified as having
significant mark associations with neighbouring trees, we show such ranges of distances
in the right panel of Figure 8. One can see that for the majority of significant ones,
and r ď 20, κSto
fifj falls outside the envelope from the above (grey intervals); this was
not detected at all by the global mark correlation function κSto
ff . Interestingly, when
r ě 35, for most trees with significant contributions, their κSto
fifj fall outside from the
upper bound, but apparently the contributions of those trees for which κSto
fifj fall outside
from the lower bound has dominated the rest giving rise to the global mark correlation
function κSto
ff falling outside the envelope from the lower bound; see the left panel of
Figure 8.
5.4
Urban mobility data
In this application, we deal with a marked point pattern on a linear network for which
marks are functions. More specifically, we study monthly bike-sharing data from Van-
couver’s public bike-share program, Mobi by Shaw Go, released under a public data
license3. Launched in 2006, this system includes 250 docking stations distributed city-
wide, with stations positioned roughly every two to three blocks (200–300 meters apart).
The dataset provides detailed information about the bike trips within a part of Vancou-
ver, Canada, including the locations of departure and return stations, precise start and
end timestamps, distance travelled (in meters), trip duration (in seconds), number and
length of stops (interruptions), battery voltage at both departure and return points,
and temperature at each docking station. Recently, Eckardt et al. (2024b) used average
daily cycling distances as function-valued marks and compared the association among
marks over a period of six months. Here, we only focus on data from August 2022; the
dataset for this particular month includes 191 points. In particular, the spatial points
are the locations of bike stations, and function-valued marks are the average daily trip
duration based on the departure station.
The middle panel of Figure 9 represents the point pattern of the bike stations and
their corresponding function-valued marks as grey curves on top of the points. Similar
to our procedure for the previous three real datasets, we employ the global mark cor-
relation function κL,Sto
ff
jointly with global envelope tests based on 500 permutations;
the corresponding p-value is 0.002. From the obtained global envelope, one can see
that the κL,Sto
ff
falls outside the envelope for small to moderate-size values of travelling
distance rL. In particular, for rL P p446, 1150q Y p1920, 3941q it falls outside from the
lower bound, meaning that, on average, for bike stations with such interpoint distances,
3https://www.mobibikes.ca/en/system-data
29

the product of marks is significantly less than that under mark independence, and for
rL P p5303, 5549q it falls outside the upper bound, meaning that for these interpoint
distances, the product of marks is significantly higher than that under mark indepen-
dence.
Additionally, our findings indicate associations among the marks, with two
distinct patterns emerging as the mark correlation function κL,Sto
ff
falls outside the en-
velope’s bounds depending on interpoint distances rL. However, these patterns cannot
be generalized across all bike stations, and it remains unclear which stations contribute
to the observed associations. Furthermore, there is still a risk that the behaviour shown
in Figure 9 is biased in the sense that it may not show the true pattern of association
as some function-valued marks might dominate each other, and some behaviours might
get masked.
Aiming to uncover the individual bike stations that have significant associations
with other stations in their surrounding, we now employ our proposed LIMA functions.
Similarly, we make use of the local mark correlation function κL,Sto
fifj . Considering the
significance level of 0.05, it is found that 42.4% of the bike stations have significant
associations with their neighbouring stations at some interpoint distance rL. These
stations are highlighted in red in the middle plot of Figure 9, from which we can
see that the majority of bike stations with significant mark associations in terms of
trip duration are located in the streets in the north of Queen Elizabeth Park, with
some other bike stations, detected as having significant mark associations, located in
downtown Vancouver.
Next, we look into the details of each individual bike station that is detected as
significant. The right plot of Figure 9 shows all ranges of travel distance rL for which
κL,Sto
fifj
falls outside corresponding envelopes; these ranges are in agreement with the
overall behaviour detected by the global mark correlation function κL,Sto
ff
displayed in
the right plot. However, the advantage of using LIMA functions is that they allow us
to pinpoint which bike stations and within what travel distance ranges show significant
associations regarding average daily trip durations.
6
Discussion
When the spatial distribution of marks varies largely, which is especially the case when
the observation window is large, it is not uncommon to have different mark behaviours
that may overshadow one another, potentially leading to inaccurate conclusions based
on global summary statistics and obscuring the complete association patterns among
marks. Here, we have developed the class of LIMA functions, integrating various local
mark correlation functions into a unified framework. More specifically, we have consid-
ered two cases of marked point processes: those on planar spaces and those on linear
networks, with marks that are either real-valued or function-valued. These LIMA func-
tions enable us to extract the contributions of individual points to the overall spatial
30

distributional behaviour of marks, leading to a complete understanding of the mark
association/variation among marks.
Through simulation studies across various scenarios, we observed that our proposed
LIMA functions consistently outperform their global counterparts in detecting spatial
patterns within marks. These findings highlight the enhanced sensitivity and precision
of our LIMA functions in capturing localized mark structures, making them a superior
tool for spatial analysis of complex marked point processes. We have observed that,
based on global envelope tests (Myllym¨aki et al., 2017), our proposed LIMA functions
exhibit a slightly lower type I error rate compared to their global counterparts while
demonstrating greater power in detecting associations/variations among marks. Addi-
tionally, global mark correlation functions are limited by the tendency of distinct mark
behaviours to dominate each other, obscuring the true pattern of mark structure. Even
when global mark correlation functions identify mark associations, they fall short in
pinpointing the specific regions or individual points contributing to these associations.
In contrast, our LIMA functions effectively highlight the points that significantly con-
tribute to observed mark structures and associations, offering a localized perspective
and, consequently, a more detailed/complete understanding of mark associations com-
pared to their global counterparts. Alongside its inherent contributions, our proposed
framework can enhance the specification of spatial marked point process models by
taking the local properties into account rather than completely relying on global ones.
Acknowledgement
Matthias Eckardt has been supported by the German Research Foundation through
Walter Benjamin grant 467634837.
References
Adelfio, G., M. Siino, J. Mateu, and F. J. Rodr´ıguez-Cort´es (2020): “Some
properties of local weighted second-order statistics for spatio-temporal point pro-
cesses,” Stochastic Environmental Research and Risk Assessment, 34, 149–168.
Anselin, L. (1995):
“Local indicators of spatial association - LISA,” Geological
Analysis, 27, 93–115.
Baddeley, A., A. Jammalamadaka, and G. Nair (2014): “Multitype point pro-
cess analysis of spines on the dendrite network of a neuron,” Journal of the Royal
Statistical Society. Series C (Applied Statistics), 63, 673–694.
Baddeley, A., E. Rubak, and R. Turner (2015):
Spatial Point Patterns:
Methodology and Applications with R, CRC Press.
31

Beisbart, C. and M. Kerscher (2000): “Luminosity- and Morphology-dependent
Clustering of Galaxies,” The Astrophysical Journal, 545, 6–25.
Berglund, S. and A. Karlstr¨om (1999): “Identifying local spatial association in
flow data,” Journal of Geographical Systems, 1, 219–236.
Chaudhuri, S., M. Moradi, and J. Mateu (2023):
“On the trend detec-
tion of time-ordered intensity images of point processes on linear networks,”
Communications in Statistics-Simulation and Computation, 52, 1318–1330.
Chiu, S. N., D. Stoyan, W. S. Kendall, and J. Mecke (2013): Stochastic
Geometry and Its Applications, John Wiley & Sons, third ed.
Comas, C., P. Delicado, and J. Mateu (2011): “A second order approach to
analyse spatial point patterns with functional marks,” TEST, 20, 503–523.
Comas, C., L. Meht¨atalo, and J. Miina (2013): “Analysing space–time tree inter-
dependencies based on individual tree growth functions,” Stochastic Environmental
Research and Risk Assessment, 27, 1673–1681.
Cressie, N. (1993): Statistics for Spatial Data, Wiley.
Cressie, N. and L. B. Collins (2001a): “Analysis of Spatial Point Patterns Using
Bundles of Product Density LISA Functions,” Journal of Agricultural, Biological,
and Environmental Statistics, 6, 118–135.
——— (2001b): “Patterns in spatial point locations: Local indicators of spatial asso-
ciation in a minefield with clutter,” Naval Research Logistics (NRL), 48, 333–347.
Cronie, O., J. Jansson, and K. Konstantinou (2024): “Discussion of the Paper
“Marked Spatial Point Processes: Current State and Extensions to Point Processes on
Linear Networks”,” Journal of Agricultural, Biological and Environmental Statistics,
29, 379–388.
Cronie, O., M. Moradi, and J. Mateu (2020): “Inhomogeneous higher-order
summary statistics for point processes on linear networks,” Statistics and Computing,
30, 1221–1239.
Cronie, O. and M. N. M. van Lieshout (2016): “Summary statistics for inhomo-
geneous marked point processes,” Annals of the Institute of Statistical Mathematics,
68, 905–928.
Daley, D. and D. Vere-Jones (2003): An Introduction to the theory of point
processes. Volume I, Springer, Berlin-Heidelberg.
32

D’Angelo, N., G. Adelfio, and J. Mateu (2021): “Assessing local differences
between the spatio-temporal second-order structure of two point patterns occurring
on the same linear network,” Spatial Statistics, 45, 100534.
D’Angelo, N., G. Adelfio, and J. Mateu (2023): “Locally weighted minimum
contrast estimation for spatio-temporal log-Gaussian Cox processes,” Computational
Statistics & Data Analysis, 180, 107679.
D’Angelo, N., G. Adelfio, J. Mateu, and O. Cronie (2024): “Local inho-
mogeneous weighted summary statistics for marked point processes,” Journal of
Computational and Graphical Statistics, 33, 588–602.
Eckardt,
M.,
C.
Comas,
and
J.
Mateu
(2023):
“Summary
char-
acteristics
for
multivariate
function-valued
spatial
point
process
attributes,”
Https://arxiv.org/abs/2307.05101.
Eckardt, M. and J. Mateu (2021): “Second-order and local characteristics of
network intensity functions,” TEST, 30, 318–340.
Eckardt, M., J. Mateu, and M. Moradi (2024a): “Function-valued marked spa-
tial point processes on linear networks: application to urban cycling profiles,” Stat.
——— (2024b): “Function-valued marked spatial point processes on linear networks:
application to urban cycling profiles,” STAT, to appear.
Eckardt, M. and M. Moradi (2024a): “Marked Spatial Point Processes: Cur-
rent State and Extensions to Point Processes on Linear Networks,” Journal of
Agricultural, Biological and Environmental Statistics, 29, 346–378.
——— (2024b): “Rejoinder on ‘Marked Spatial Point Processes: Current State and Ex-
tensions to Point Processes on Linear Networks’,” Journal of Agricultural, Biological
and Environmental Statistics, 29, 405–416.
Flahaut, B., M. Mouchart, E. S. Martin, and I. Thomas (2003): “The local
spatial autocorrelation and the kernel method for identifying black zones: A compar-
ative approach,” Accident Analysis & Prevention, 35, 991–1004.
Getis, A. (1984): “Interaction modeling using second-order analysis,” Environment
and Planning a, 16, 173–183.
Getis, A. and J. Franklin (1987): “Second-order neighborhood analysis of mapped
point patterns,” Perspectives on spatial data analysis, 93–100.
Ghorbani, M., O. Cronie, J. Mateu, and J. Yu (2021): “Functional marked
point processes: a natural structure to unify spatio-temporal frameworks and to
analyse dependent functional data,” TEST, 30, 529–568.
33

Gonz´alez, J. A., F. J. Rodr´ıguez-Cort´es, E. Romano, and J. Mateu (2021):
“Classification of Events Using Local Pair Correlation Functions for Spatial Point
Patterns,” Journal of Agricultural, Biological and Environmental Statistics, 26, 538–
559.
Hui, G. and A. Pommerening (2014): “Analysing tree species and size diversity
patterns in multi-species uneven-aged forests of Northern China,” Forest Ecology
and Management, 316, 125–138.
Illian, J., A. Penttinen, H. Stoyan, and D. Stoyan (2008): Statistical Analysis
and Modelling of Spatial Point Patterns, John Wiley & Sons, New York.
Isham, V. (1985): “Marked point processes and their correlations,” in Spatial processes
and spatial time series analysis, Publications des Facultes Universitaires Saint-Louis
Brussels, 63–75.
Mateu, J., G. Lorenzo, and E. Porcu (2007): “Detecting features in spatial
point processes with clutter via local indicators of spatial association,” Journal of
Computational and Graphical Statistics, 16, 968–990.
Møller, J. and R. P. Waagepetersen (2004): Statistical Inference and Simulation
for Spatial Point Processes, Chapman and Hall/CRC, Boca Raton.
Moradi, M., O. Cronie, U. P´erez-Goya, and J. Mateu (2023): “Hierarchical
spatio-temporal change-point detection,” The American Statistician, 1–11.
Moradi, M. and A. Sharifi (2024): “Summary statistics for spatio-temporal point
processes on linear networks,” Spatial Statistics, 61, 100840.
Moraga, P. and F. Montes (2011): “Detection of spatial disease clusters with
LISA functions,” Statistics in Medicine, 30, 1057–1071.
Moran, P. A. P. (1950): “Notes on continuous stochastic phenomena,” Biometrika,
37, 17–23.
Myllym¨aki, M. and T. Mrkviˇcka (2023): “GET: Global envelopes in R,” arXiv
preprint arXiv:1911.06583.
Myllym¨aki, M., T. Mrkviˇcka, P. Grabarnik, H. Seijo, and U. Hahn (2017):
“Global envelope tests for spatial processes,” Journal of the Royal Statistical Society
Series B: Statistical Methodology, 79, 381–404.
Pommerening, A., A. C. Gonc¸alves, and R. Rodr´ıguez-Soalleiro (2011):
“Species mingling and diameter differentiation as second-order characteristics.”
Allgemeine Forst- und Jagdzeitung, 182, 115–129.
34

R Core Team (2024): R: A Language and Environment for Statistical Computing,
R Foundation for Statistical Computing, Vienna, Austria.
Rakshit, S., G. Nair, and A. Baddeley (2017): “Second-order analysis of point
patterns on a network using any distance metric,” Spatial Statistics, 22, 129–154.
Schaub, M., M. Haeni, C. Hug, A. Gessler, and A. Rigling (2016): “Tree
measurements 2002-2016 from the long-term irrigation experiment Pfynwald, Switzer-
land,” .
Schlather, M. (2001): “On the second-order characteristics of marked point pro-
cesses,” Bernoulli, 7, 99–117.
Schlather, M., P. Riberio, and P. Diggle (2004):
“Detecting Dependence
between Marks and Locations of Marked Point Processes,” Journal of the Royal
Statistical Society, Series B (Methodological), 66, 79–93.
Shimatani, K. (2002): “Point Processes for Fine-Scale Spatial Genetics and Molecular
Ecology,” Biometrical Journal, 44, 325–352.
Siino, M., F. J. Rodr´ıguez-Cort´es, J. Mateu, and G. Adelfio (2018): “Test-
ing for local structure in spatiotemporal point pattern data,” Environmetrics, 29,
e2463, e2463 env.2463.
Stoyan, D. (1984): “Correlations of the Marks of Marked Point Processes - Sta-
tistical Inference and Simple Models,” Elektronische Informationsverarbeitung und
Kybernetik, 20, 285–294.
Stoyan, D. and H. Stoyan (1994): Fractals, Random Shapes, and Point Fields:
Methods of Geometrical Statistics, Chichester, New York: Wiley.
Stoyan, D. and O. W¨alder (2000): “On variograms in point process statistics, II:
Models for markings and ecological interpretation,” Biometrical Journal, 42, 171–187.
W¨alder, O. and D. Stoyan (1996): “On Variograms in Point Process Statistics,”
Biometrical Journal, 38, 895–905.
Wickham, H. (2016): ggplot2: Elegant Graphics for Data Analysis, Springer-Verlag
New York.
Yamada, I. and J.-C. Thill (2007): “Local Indicators of Network-Constrained Clus-
ters in Spatial Point Patterns,” Geographical Analysis, 39, 268–292.
——— (2010):
“Local Indicators of Network-Constrained Clusters in Spatial Pat-
terns Represented by a Link Attribute,” Annals of the Association of American
Geographers, 100, 269–285.
35

Figure 6:
Results for Duke forest data. Left: Global envelope test using the global
mark correlation function κSto
mm. Middle: The point pattern of the black gum trees with
significant trees highlighted in red; the numbers show their corresponding dbh values.
Right: Ranges of distances r for which the local mark correlation function κSto
mimj falls
outside the envelope for the trees with significant mark associations represented in red
in the middle plot. Lower and Upper refers to whether κSto
mimj is falling outside the lower
or upper bound.
36

Figure 7:
Results for Jersey City street crimes. Left: Global envelope test using the
global mark correlation function κL,Sto
mm . Middle: The point pattern of the crimes with
significant ones highlighted in red; the numbers show their elapsed time in seconds.
Right: Ranges of distances rL for which the local mark correlation function κL,Sto
mimj falls
outside the envelope for the crimes with significant mark associations represented in
red in the middle plot. Lower and Upper refers to whether κL,Sto
mimj is falling outside the
lower or upper bound.
37

Figure 8:
Results for Pfynwald data. Left: Global envelope test using the global
mark correlation function κSto
ff . Middle: The point pattern of Pfynwald trees, with
significant ones highlighted in red; the curves at each point show their function-valued
mark. Right: Ranges of distances r for which the local mark correlation function κSto
fifj
falls outside the envelope for the trees with significant mark associations represented in
red in the middle plot. Lower and Upper refers to whether κSto
fifj is falling outside the
lower or upper bound.
38

Figure 9:
Results for urban bike sharing. Left: Global envelope test using the global
mark correlation function κL,Sto
ff
. Middle: The point pattern of bike stations in Van-
couver, with significant ones highlighted in red; the curves at each point show their
function-valued mark. Right: Ranges of distances rL for which the local mark correla-
tion function κL,Sto
fifj
falls outside the envelope for the bike stations with significant mark
associations represented in red in the middle plot. Lower and Upper refers to whether
κL,Sto
fifj
is falling outside the lower or upper bound.
39
