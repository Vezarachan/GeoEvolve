Regularized Nonparametric Volterra Kernel Estimation ⋆
Georgios Birpoutsoukis a, Anna Marconato a, John Lataire a, Johan Schoukens a
aDepartment of ELEC, Vrije Universiteit Brussel, Pleinlaan 2, 1050 Brussel.
This is a postprint copy of: Birpoutsoukis, G., Marconato, A., Lataire, J., &
Schoukens, J. (2017). Regularized nonparametric Volterra kernel estimation.
Automatica, 82, 324-327. DOI: 10.1016/j.automatica.2017.04.014
Abstract
In this paper, the regularization approach introduced recently for nonparametric estimation of linear systems is extended
to the estimation of nonlinear systems modelled as Volterra series. The kernels of order higher than one, representing higher
dimensional impulse responses in the series, are considered to be realizations of multidimensional Gaussian processes. Based
on this, prior information about the structure of the Volterra kernel is introduced via an appropriate penalization term in the
least squares cost function. It is shown that the proposed method is able to deliver accurate estimates of the Volterra kernels
even in the case of a small amount of data points.
Key words: System identiﬁcation, Nonlinear systems, Nonparametric estimation, Volterra series, Regularization, Gaussian
processes.
1
Introduction
Modeling of nonlinear systems constitutes one of the
most challenging topics in the ﬁeld of system identiﬁ-
cation. In this work, nonparametric modeling is consid-
ered for a nonlinear system in the form of a time do-
main Volterra series [14]. The estimation of the Volterra
series coeﬃcients in an output error framework can be
formulated as a Least Squares (LS) optimization prob-
lem. However, the number of coeﬃcients to estimate is
often too large for the LS problem to yield a solution of
acceptable precision.
The problem of high variance has already been tackled
successfully in [2],[4],[6],[9],[11] using regularization for
the identiﬁcation of a Finite Impulse Response (FIR)
model for a Linear Time Invariant (LTI) system. In
an output error framework, the linear-in-the-parameters
⋆This paper was not presented at any IFAC meeting. Cor-
responding author G. Birpoutsoukis. Tel. +32 (0)2 629 29 46
Email addresses: georgios.birpoutsoukis@vub.ac.be
(Georgios Birpoutsoukis), Anna.Marconato@vub.ac.be
(Anna Marconato), jlataire@vub.ac.be (John Lataire),
Johan.Schoukens@vub.ac.be (Johan Schoukens).
FIR model can also be estimated by solving a linear LS
problem. In order to reduce the variance of the estimated
parameters, prior knowledge about the linear impulse
response (exponential decay and smoothness) has been
added to the parameter estimation problem. Moreover,
Volterra kernel estimation using ridge regression as reg-
ularization method can be found in [5].
In this paper, the regularization method that has been
proposed for estimating LTI FIR models is extended to
the case of Nonlinear Time Invariant (NLTI) systems.
The time domain truncated Volterra series is considered
as the model for the underlying nonlinear process. Simi-
larly to the linear case, it is assumed that the higher order
kernels in the series are smooth and exponentially decay-
ing. The main contribution of this work is to show that,
by exploiting properties of the Volterra kernels in the
higher dimensions, it is possible to construct a penalizing
matrix into which the two aforementioned properties are
encoded. A number of popular nonlinear model struc-
tures can be modeled with the proposed method, among
which Wiener, Hammerstein and Wiener-Hammerstein.
In Section 2 the problem formulation is given. In Section
3, the regularized LS estimators for FIR modeling are ex-
arXiv:1804.10435v1  [cs.SY]  27 Apr 2018

tended for the estimation of Volterra kernels. In Section
4, the proposed approach is illustrated on a simulation
example. Finally, conclusions are drawn in Section 5.
2
Problem formulation
The considered nonlinear systems are modelled with the
following model structure:
Deﬁnition 1 (Model Class) The input-output behaviour
of the model satisﬁes the ﬁnite discrete-time Volterra se-
ries:
y(k) = h0 +
M
X
m=1
Hm[u]k + e(k)
Hm[u]k =
nm−1
X
τ1=0
· · ·
nm−1
X
τm=0
hm(τ1, . . . , τm)
τm
Y
τ=τ1
u(k −τ)
(1)
where y(k) is the measured output at time instant k, u(k)
is the input signal applied to the system and the measure-
ment noise e(k) is a zero mean normally distributed i.i.d.
signal, with variance σ2, i.e. e(k) ∼N(0, σ2). Hm[·] is
the m-th order Volterra operator and nm −1 corresponds
to the number of past input values (the memory of hm)
needed to compute the system output. The constant term
h0 in (1) represents the zero-th order Volterra kernel.
Remark 2 In order to ensure the uniqueness of the iden-
tiﬁed Volterra kernels of order higher than one, the sym-
metrized kernels are considered [14]. For the second or-
der kernel it means that h0
2(τ1, τ2) = h0
2(τ2, τ1), ∀τ1, τ2.
It can be easily shown that the number of coeﬃcients
to be identiﬁed for a symmetric Volterra kernel of or-
der m ≥1, truncated at lag nm, is given by nθm =
(1/m!)
m−1
Q
i=0
(nm + i). This is a straightforward result af-
ter considering all the possible permutations among the
lag coordinates in the diﬀerent dimensions.
The problem is formulated as follows. Given N mea-
surements of u(k) and y(k), obtain an estimate of the
Volterra kernels hm. For convenience, (1) can be rewrit-
ten in vector notation as:
YN = ΦT
Nθ + E
(2)
with (for M = 2 and n1 = n2 = n, i.e. nθ1 = n1 = n
and nθ2 = n2(n2+1)
2
= n2+n
2
)
ΦN = [ΦT
0N ΦT
1N ΦT
2N]T , θ = [¯θT
0 ¯θT
1 ¯θT
2 ]T
¯θ1 = [h1(0) h1(1) . . . h1(n −1)]T ,
¯θ0 = h0
YN = [y(n −1) y(n) . . . y(N −1)]T
φ1(k) = [u(k) u(k −1) . . . u(k −n + 1)]T
Φ1N = [φ1(n −1) φ1(n) . . . φ1(N −1)]
Φ0N = [1 1 1 . . . 1]
E = [e(n −1) e(n) . . . e(N −1)]T
(3)
where Φ0N
∈R1×(N−n+1), Φ1N
∈Rnθ1×(N−n+1),
Φ2N ∈Rnθ2×(N−n+1), ¯θ0 ∈R, ¯θ1 ∈Rnθ1×1, ¯θ2 ∈
Rnθ2×1, YN
∈
R(N−n+1)×1, φ1(k)
∈
Rnθ1×1 and
E ∈R(N−n+1)×1. The matrix Φ2N is constructed ac-
cording to the vector ¯θ2 which concatenates h2(τ1, τ2)
for τ1, τ2 = 0, . . . , n2 −1. In this work, ¯θ2 is deﬁned as
¯θ2 = [¯θ2,1 ¯θ2,2 · · · ¯θ2,nθ2]T , where ¯θ2,i, i = 1, . . . , nθ2 are
arranged as depicted in Fig. 2.
Remark 3 The vector YN starts at n−1 and not 0. The
reason is that n initial values of the input in ΦN are not
known.
The total number of Volterra coeﬃcients to be estimated
is given by nθ = 1 + nθ1 + nθ2.
3
Regularized Volterra series estimation
Given (2), the regularized LS optimization problem with
a quadratic penalty on the parameter vector θ is deﬁned
as:
ˆθReg
N
= arg min
θ
∥YN −ΦT
Nθ∥2 + θT Dθ
= (ΦNΦT
N + D)−1ΦNYN
(4)
with D ∈Rnθ×nθ. For D = 0 the LS cost function is ob-
tained which corresponds to the Maximum Likelihood
(ML) estimation of the parameter vector θ [7],[12]. Typ-
ically, when the Volterra series is used to model nonlin-
ear dynamics, either the number of coeﬃcients to be es-
timated exceeds the number of available measurements
(nθ > N) or the amount of measured data N is not
suﬃcient to obtain an estimated model of desired accu-
racy. In the ﬁrst case when nθ > N the LS solution is
not even unique and the ML approach cannot be used.
In this work these problems are tackled with the use of
regularization (D ̸= 0).
By a proper structuring of D in (4), one can impose prior
knowledge about the true system. In the linear case the
penalty D can be tuned using a Bayesian perspective
and considering the impulse response as a realization of
2

a random Gaussian process [13],[9],[10]. Assuming θ ∼
N(0, P) and taking (2) into account, then θ and YN
are jointly distributed Gaussian variables and θ
YN ∼
N(ˆθapost
N
, P apost) with:
ˆθapost
N
= (ΦNΦT
N + σ2P −1)−1ΦNYN
where ˆθapost
N
denotes the Maximum A Posteriori (MAP)
estimate of θ. It can be observed that ˆθapost
N
= ˆθReg
N
in
(4) if D = σ2P −1. This perspective oﬀers an alternative
interpretation of the regularization matrix D which can
be constructed by tuning the prior covariance matrix P.
Throughout the paper, the prior covariance matrix for
the Volterra kernel of order m is denoted by Pm.
3.1
Regularization for the ﬁrst order Volterra kernel
For the ﬁrst order kernel, prior information about
smoothness and exponential decay of the impulse
response can be imposed by the so-called Diago-
nal/Correlated (DC) [2],[1],[11] structure of P1:
P1(i, j) = c · e−α|i−j| e−β (i+j)
2
(5)
where P1(i, j) = E[h1(τi) h1(τj)], h1(τi) is the ﬁrst or-
der impulse response coeﬃcient at lag τi, E[·] denotes
the expected value and 0 ≤α, β ≤∞. The parame-
ters c, α and β are called hyper-parameters and they are
computed by maximizing the marginal likelihood of the
observed output [11],[13],[8].
3.2
Extension to the second order Volterra kernel
Assumption 4 The second order Volterra kernel is
smooth and decaying. Moreover, no prior knowledge on
the correlation between Volterra coeﬃcients of diﬀerent
order is available.
In Fig. 1, an example of a decaying and smooth second
order Volterra kernel has been constructed. It is the ker-
nel of a nonlinear Wiener system where a stable linear
system is cascaded by a quadratic static nonlinear sys-
tem [14].
Given the cost function (4) and θ = [¯θT
0 ¯θT
1 ¯θT
2 ]T , D is
a block-diagonal matrix with elements D0, D1 and D2
on the diagonal. D0 is a scalar deﬁned by D0 = σ2P −1
0
where P0 represents the variance of the Gaussian random
variable h0. The penalizing matrix for the ﬁrst order
kernel is D1 = σ2P −1
1
and P1 ∈Rnθ1×nθ1 is deﬁned as
described in Section 3.1. Finally, the covariance matrix
P2 ∈Rnθ2×nθ2 such that D2 = σ2P −1
2
is developed in
this paper.
Fig. 1. An exponentially decaying and smooth second order
kernel together with the two perpendicular regularizing di-
rections (green and red).
Given a second order Volterra kernel, the covariance ma-
trix P2 should satisfy the following:
Property 5 It should describe the fact that the Volterra
kernel decays along any possible direction and, moreover,
neighbouring coeﬃcients of the Volterra kernel are cor-
related.
Property 6 The
considered
second
order
Volterra
kernel is symmetric which implies that h2(τ1, τ2) =
h2(τ2, τ1), ∀τ1, τ2. Therefore P2 should remain unaltered
after interchanging the coordinates τ1 and τ2.
Property 7 Finally, as for any covariance matrix,
P2 should be constructed to be a symmetric positive-
semideﬁnite matrix.
These three properties reduce the freedom to construct
an appropriate covariance matrix for the Volterra kernel.
3.2.1
The two directions and the covariance matrix
Two directions in the τ1 −τ2 plane are chosen in order
to build a proper covariance matrix for the second order
kernel. The ﬁrst direction, along which prior information
about the kernel will be imposed, is chosen to be the V
diagonal. It is depicted in Fig. 1 and Fig. 2 as the green
diagonal direction. The second direction is the U anti-
diagonal direction and it is represented by the red lines
in Fig. 1 and Fig. 2. In this way, it is possible to construct
a covariance matrix that will satisfy Property 5.
To this aim, a new rotated coordinate system is deﬁned
as depicted in Fig. 2. Using the new system (V ,U ) it
becomes more clear how the properties of exponential
decaying and smoothness can be described in these di-
rections, and further how to extend the DC covariance
matrix structure (5) to dimensions higher than one.
Deﬁnition 8 Given the elements of a symmetric second
order kernel h2(τ1, τ2), vectorized in ¯θ2, and the coordi-
nate system (V ,U ) depicted in Fig. 2, the covariance
3

Fig. 2. The initial coordinate system (τ1,τ2) together with
the rotated one (V ,U ), used in the covariance matrix of the
second order kernel.
matrix P2 = E[¯θ2¯θT
2 ] used to describe and further penal-
ize the coeﬃcients of the second order Volterra kernel is
given by:
P2(i, j) = c2 pV (i, j) pU (i, j)
pV (i, j) = e−αV
|Vi|−|Vj|
 e−βV
|Vi|+|Vj |

2
pU (i, j) = e−αU
|Ui|−|Uj|
 e−βU
|Ui|+|Uj |

2
(6)
with Vi and Ui the coordinates of ¯θ2,i on the V - and U -
axes.
The hyper-parameters αV and βV are connected to the
smoothness and the decay of the kernel in the diago-
nal direction, respectively. Similarly, αU and βU are
linked to the correlation between the Volterra coeﬃ-
cients as well as the decay in the U direction. The hyper-
parameter c2 represents a scaling factor. The matrix P2
is a valid covariance matrix according to the results of
[3], section 3, on valid covariance matrices with Non-
Euclidean norms.
The second order Volterra kernel of the underlying true
system is assumed to be a realization of a Gaussian pro-
cess with zero mean and covariance matrix given by P2.
The hyper-parameters used to construct the matrix P,
and further D = σ2P −1, are determined also in this case
by maximizing the marginal likelihood for the observed
output.
Remark 9 The proposed covariance matrix P2 satisﬁes
Property 6. It can be easily seen that interchanging the
coordinates τ1 and τ2 corresponds to a change in the sign
of the coordinate U in pU . Given that the absolute values
of the coordinates are considered, the covariance matrix
remains in this case unaltered, as required. Moreover,
P2(i, j) = P2(j, i) therefore the proposed matrix satisﬁes
also Property 7.
Fig. 3. The system chosen for the numerical illustration. A
Wiener-Hammerstein nonlinear structure is considered.
4
Numerical example
The method is illustrated on the system shown in Fig. 3
with:
G0 = 2, G1(q) =
0.7568q−1
1 −1.812q−1 + 0.8578q−2
G2(q) =
1.063q−1
1 −1.706q−1 + 0.7491q−2 , G3(q) = 1.5G1(q)
where q−1 is the delay operator (q−1u(k) = u(k −1)).
The input-output behavior of this system can be mod-
elled with a Volterra series of degree two (eq.(1) with
M = 2). The systems G2(q) and G3(q) have been cho-
sen such that the second order Volterra kernel, asso-
ciated with the system in Fig. 3, has diﬀerent proper-
ties of smoothness and decay in the directions U and
V (Fig. 2). Even though the zero-th, ﬁrst and second
order Volterra kernels are identiﬁed simultaneously, we
emphasize here on the identiﬁcation of the second order
Volterra kernel. The second order kernel corresponding
to the considered system is depicted in Fig. 4 (on the
left) and has been constructed using the measurement
method described in [14], pages 44-47.
The input signal is a ﬁltered random phase multisine of
unit power, and the noise term e is a zero mean nor-
mally distributed i.i.d. signal. The method is tested for
a Signal-to-Noise Ratio (SNR) of 20 dB 1 . The results
are reported with respect to the ratio N/nθ. The esti-
mated second order Volterra kernel for N/nθ = 1.3 and
truncation at n1 = n2 = 80 lags is shown in Fig. 4.
The method is also illustrated for diﬀerent values of the
ratio N/nθ (here n1 = n2 = 80 lags are ﬁxed there-
fore nθ is ﬁxed and N is increasing). For each value
N/nθ, 100 Monte Carlo (MC) simulations are performed.
In every MC simulation, a diﬀerent excitation signal u
and noise realization e are used. The ability of the es-
timated model to simulate the output of the system
is measured with respect to a noiseless validation data
set of Nval = 50000 data points, which also changes
in every MC iteration. The portion of validation data
1 SNR is deﬁned as
var(y0)
var(e) where y0 denotes the noiseless
system output and var is the variance
4

Fig. 4. Left: True second order Volterra kernel. Right: Esti-
mated kernel for SNR = 20dB and N/nθ = 1.3.
10
−1
10
0
N / nθ
Errval
0.1
0.2
0.4
0.6
0.8
1
1.1
1.3
Fig. 5. Box-plot of the Monte Carlo simulation results for
the considered nonlinear system. Black thin line boxes: Reg-
ularized estimation Grey wide line boxes: Unregularized es-
timation (LS solution).
not described by the modeled output is measured by
Errval = rms(yval −ˆyval)/rms(yval), where yval ∈RNval
denotes the noiseless validation output, ˆyval ∈RNval is
the output of the estimated model when the latter is ex-
cited by the validation input signal uval ∈RNval and rms
denotes the root mean square.
It is clear in Fig. 5 that the regularized Volterra ker-
nel estimation (red boxes) produces models which de-
scribe more than 90% of the noiseless validation out-
put when N/nθ > 0.2, even though the noise level is
quite high. Moreover, the error in the simulated output
decreases with an increasing number of data used for
estimation, as expected. The LS solution obtained for
N/nθ ≥1 (unregularized estimation) is also computed
and the MC results (green boxes) are compared with the
ones obtained with the proposed method. It is clear that
the models obtained with the LS approach (ML estima-
tion), given the high number of parameters (truncation
at n1 = n2 = 80 lags corresponds to 3321 Volterra co-
eﬃcients) to be estimated and the limited data length
(maximum N/nθ = 1.3 in Fig. 5), are less able to sim-
ulate the system output than the ones computed when
regularization is used. It is important to note that, qual-
itatively, the same conclusions can be derived if diﬀerent
values of SNR or another structure for the second order
nonlinearity (e.g. Hammerstein case) are considered.
5
Conclusions
The method presented in this paper constitutes a way
to include prior information about the Volterra kernels
(smoothness and decay) for the identiﬁcation of nonlin-
ear dynamics, by penalizing properly the higher dimen-
sional impulse response coeﬃcients. Even in the situa-
tion when a small amount of measurements is available
(smaller than the number of parameters) and the LS ap-
proach cannot be used, modeling with the Volterra series
is feasible. The regularization method presented in this
paper renders the modeling of a big class of nonlinear
systems with the Volterra series possible, which has not
been the case before. However, several issues should be
adressed in the future, such as eﬃcient ways to optimize
the hyperparameters of the regularization matrix in or-
der to reduce the risk of resulting in a local minimum of
the marginal likelihood.
Acknowledgements
This work was supported in part by the Fund for Sci-
entiﬁc Research (FWO-Vlaanderen), by the Flemish
Government (Methusalem), the Belgian Government
through the Inter university Poles of Attraction (IAP
VII) Program, and by the ERC advanced grant SNL-
SID, under contract 320378.
References
[1]
Chen, T., & Ljung, L. On kernel design for regularized lti
system identiﬁcation. arXiv preprint arXiv:1612.03542, 2016.
[2]
Chen, T., Ohlsson, H., & Ljung, L. On the estimation of
transfer functions, regularizations and Gaussian processes -
revisited. Automatica, 48(8):1525–1535, 2012.
[3]
Christakos,
G,
&
Papanicolaou,
V.
Norm-dependent
covariance permissibility of weakly homogeneous spatial
random ﬁelds and its consequences in spatial statistics.
Stochastic Environmental Research and Risk Assessment,
14(6):471–478, 2000.
[4]
Dinuzzo, F.
Kernels for linear time invariant system
identiﬁcation. SIAM Journal on Control and Optimization,
53(5):3299–3317, 2015.
[5]
Franz, M. O., & Sch¨olkopf, B.
A unifying view of wiener
and volterra theory and polynomial kernel regression. Neural
computation, 18(12):3097–3118, 2006.
[6]
Lataire, J., & Chen, T.
Transfer function and transient
estimation by gaussian process regression in the frequency
domain. Automatica, 72:217–229, 2016.
[7]
Ljung, L. System Identiﬁcation: Theory for the User, PTR
Prentice Hall Information and System Sciences Series, 1999.
[8]
Pillonetto, G., & Chiuso, A. Tuning complexity in regularized
kernel-based regression and linear system identiﬁcation: The
robustness of the marginal likelihood estimator. Automatica,
58:106–117, 2015.
[9]
Pillonetto, G., & De Nicolao, G. A new kernel-based approach
for linear system identiﬁcation.
Automatica, 46(1):81–93,
2010.
5

[10] Pillonetto, G., Chiuso, A., & De Nicolao, G. Prediction error
identiﬁcation of linear systems: a nonparametric Gaussian
regression approach. Automatica, 47(2):291–305, 2011.
[11] Pillonetto, G., Dinuzzo, F., Chen, T., De Nicolao, G., &
Ljung, L. Kernel methods in system identiﬁcation, machine
learning and function estimation: A survey.
Automatica,
50(3):657–682, 2014.
[12] Pintelon, R., & Schoukens, J.
System identiﬁcation: a
frequency domain approach. John Wiley & Sons, 2012.
[13] Rasmussen, C. E., & Williams, C. K. I. Gaussian Processes
for Machine Learning. MIT Press, 2006.
[14] Schetzen, M. The Volterra and Wiener theories of nonlinear
systems. 1980.
6
