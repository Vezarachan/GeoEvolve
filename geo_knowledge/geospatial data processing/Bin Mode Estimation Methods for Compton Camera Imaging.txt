arXiv:1312.4291v2  [astro-ph.IM]  1 May 2014
Bin Mode Estimation Methods for Compton Camera
Imaging
S. Ikedaa,b,∗, H. Odakac, M. Uemurad, T. Takahashic, S. Watanabec,
S. Takedac
aThe Institute of Statistical Mathematics, Tachikawa, Tokyo, 190-8562, Japan
bThe Graduate University for Advanced Studies, Kanagawa, 240-1542, Japan
cJapan Aerospace Exploration Agency, Sagamihara, Kanagawa, 252-5210, Japan
dHiroshima University, Higashi-hiroshima, Hiroshima, 739-8511, Japan
Abstract
We study the image reconstruction problem of a Compton camera which con-
sists of semiconductor detectors. The image reconstruction is formulated as a
statistical estimation problem. We employ a bin-mode estimation (BME) and
extend an existing framework to a Compton camera with multiple scatterers
and absorbers. Two estimation algorithms are proposed: an accelerated EM
algorithm for the maximum likelihood estimation (MLE) and a modiﬁed EM
algorithm for the maximum a posteriori (MAP) estimation. Numerical simula-
tions demonstrate the potential of the proposed methods.
Keywords:
Compton camera, image reconstruction, expectation
maximization, maximum likelihood estimation, maximum a posteriori
estimation
1. Introduction
Compton camera imaging is a promising method to visualize gamma-ray
sources from 100keV to several MeV. It can be applied in many ﬁelds, such
as nuclear medicine, visualization of radioactive substances on the ground, and
gamma-ray astronomy [1–8]. High-resolution Compton cameras utilizing silicon
(Si) and cadmium telluride (CdTe) semiconductor detectors [9–12] will be in-
stalled in the next-generation X-ray observatory ASTRO-H [13, 14], which is
scheduled for launch in 2015.
However, imaging is not straightforward because only a small portion of
photons are absorbed after Compton scattering and the direction of arrival of
each photon is not known directly. From a single event, the scattering angle
of the photon is computed using the energies of the recoil electron and the
scattered photon. After collecting these observations, some type of information
∗Corresponding author
Email address: shiro@ism.ac.jp (S. Ikeda)
Preprint submitted to Nuclear Instruments and Methods in Physics Research A August 21, 2018

processing is needed to reconstruct the image.
Since photon detection is a
stochastic process, the image reconstruction problem can be formulated as a
statistical estimation problem [15–17]. In this study, we follow the framework
developed for COMPTEL [1, 3, 18], and employ the bin-mode estimation (BME)
method. Although the number of bins can be large, in astronomy applications
where the distances from the gamma-ray sources are large, the number of bins
is signiﬁcantly reduced and the BME method is applied eﬀectively.
One of the popular estimation methods in statistics is the maximum likeli-
hood estimation (MLE). COMPTEL also employed the MLE. In order to com-
pute the MLE of the Compton camera imaging, a natural approach is to use
the expectation-maximization (EM) algorithm [19]. However, the convergence
speed of the EM algorithm is not fast in general, and a line search algorithm
was combined with the EM algorithm in COMPTEL. In this work, we propose
two diﬀerent approaches to speed up the convergence of the EM algorithm:
one is a diﬀerent acceleration method to compute the MLE by approximating
the Fisher’s scoring method [20, 21] and the other is to use the maximum a
posteriori (MAP) estimation instead of the MLE. The MAP estimation is an-
other popular estimation method in Bayesian statistics [22, 23]. We employed
the Dirichlet distribution as the prior, and a modiﬁed EM algorithm is used
to compute the MAP estimate. These two proposed BME methods are tested
through numerical simulations.
The rest of the paper is organized as follows. Section 2 explains the Compton
camera system, while section 3 overviews BME methods for image reconstruc-
tion. Section 4 shows numerical results with some discussions, and section 5
concludes the paper.
2. Compton camera imaging
2.1. Compton camera system
Figure 1: Compton camera.
Figure 1 schematically depicts the Compton camera system.
Our target
system has multiple scatterers and absorbers. A photon is detected when it is
scattered at one of the scatterers and absorbed by one of the absorbers. Even
2

if a number of photons arrive, only a little portion of them are detected after
Compton scattering.
Suppose a photon from u = (α, δ) (in equatorial coordinates) is detected. It
is initially scattered by one of the scatterers at x = (x1, x2) and then absorbed
by one of the absorbers at y = (y1, y2). We denote the distance between the
scatterer and the absorber as d.
Let E1 and E2 be the energies of the recoil electron and the scattered photon,
respectively. The scattering angle θ is denoted as
cos θ = 1 −mec2
 1
E2
−
1
E1 + E2

,
(1)
where me and c are the mass of an electron and the speed of light, respectively.
The goal of Compton camera imaging is to reconstruct the gamma-ray intensity
map on the celestial sphere from collected information. Diﬃculties arise because
only the scattering angle θ is computed from a single event.
In this paper, we assume the distance from each gamma-ray source to the
Compton camera system is suﬃciently large. This assumption is valid for as-
tronomy applications. Under this assumption, only the direction of arrival is
important, therefore, not x and y, but only the relative position normalized
by the distance d, i.e., w = (x −y)/d, is considered. The information of each
detected photon is summarized into v = (w, cos θ). Furthermore u = (α, δ) and
v are assumed to be quantized into bins. Below, u and v are bin indices.
2.2. Compton camera measurement process
We ﬁrst introduce the model of the measurement process [24].
When a
gamma-ray photon from u is detected, it falls into a bin v with some probability.
Let λ(u) be the intensity of the gamma rays at pixel u of the celestial sphere
and Y (v) be the number of photons detected at bin v for a time interval. The
distribution of Y (v) follows a Poisson distribution as
Y (v) ∼Poisson
 X
u
t(v, u) λ(u)
!
.
(2)
where t(v, u) is the probability that a photon from u is absorbed at v. We
modify the above framework in this work. Let us re-parameterize t(v, u) and
λ(u) and deﬁne q(v) as follows
p(v | u) = t(v, u)
s(u)
where
s(u) =
X
v
t(v, u),
ρ(u) = λ(u)s(u)
λ
where
λ =
X
u
λ(u)s(u)
q(v) =
X
u
p(v | u) ρ(u),
(3)
3

where s(u) is the probability that a photon from pixel u is absorbed by the
camera. All ρ(u), p(v | u), and q(v) are multinomial distributions (i.e., they are
non-negative and each distribution sums up to one) conditional to the events
that a photon is absorbed by the camera. More precisely, ρ(u) is the probability
that an absorbed photon arrives from u, p(v | u) is the probability that an
absorbed photon from u is detected at v, and q(v) is the probability that an
absorbed photon is detected at v. After observing many photons, we collect
information of q(v). If p(v | u) is known, it is possible to estimate ρ(u).
The goal of Compton camera imaging is to reconstruct the intensity map
λ(u). The distribution ρ(u) diﬀers from λ(u) because the photons which were
not completely absorbed are not included. However λ(u) can be easily recon-
structed as λ(u) ∝ρ(u)/s(u) assuming s(u) is known. Thus, we set our goal
to estimate ρ(u) from absorbed photons.
In the next section, we ﬁrst show how to prepare p(v | u) and s(u), then
explain how to estimate ρ(u) from absorbed photons.
3. BME methods
3.1. Bin mode
Our formulation is based on the BME, where each v and u is quantized into
bins. The key is how to implement and prepare p(v | u).
If x, y, E1, and E2 are quantized separately, the number of the bins is
too large and the BME is not feasible with current computational hardware.
However, under the assumption that the distances from the gamma ray sources
are large, it is suﬃcient to quantify (w, cos θ), where w = (x−y)/d and cos θ are
deﬁned in eq. (1). The number of bins decreases and the BME becomes feasible
without loss to precision.
In previous works of COMPTEL, the matrix size
was further reduced using geometrical symmetries [1, 3] but we do not rely on
symmetry because the installed camera may have an asymmetric conﬁguration.
The next challenge is how to prepare p(v | u) and s(u).
Here we utilize
a numerical method. A Compton camera system was simulated and a lot of
photons were randomly drawn numerically using software such as Geant4. The
results were accumulated to compute p(v | u) and s(u). This method is general
and easily implemented.
There are other possible methods to compute p(v | u) and s(u). One of them
is to used the numerical integration based on a physical model with the Klein-
Nishina formula. Although the integration is diﬃcult, the resulting distribution
is theoretically accurate. Another method is to use a physical system. When
a system is built and tested under a physical environment, the collected data
from a set of well-designed experiments can be used to compute p(v | u) and
s(u).
3.2. Maximum likelihood estimate
Next, we discuss the estimation of ρ(u).
4

Suppose N photons are detected independently and t-th photon is absorbed
at vt, (t = 1, · · · , N). The log likelihood function is deﬁned as follows
L(ρ) =
N
X
t=1
log q(vt) =
N
X
t=1
log
X
u
p(vt | u) ρ(u).
(4)
Our goal is to estimate ρ(u) from {vt}, where p(v | u) is known. The maxi-
mum likelihood estimate (MLE) of ρ(u) is deﬁned as the distribution ρ(u) that
maximizes L(ρ). We denote it as ˆρMLE(u). The EM algorithm [19] is a simple
algorithm to compute MLE by alternately repeating the expectation (E-) step
and maximization (M-) step. Each step is deﬁned as
(E-step)
q(l)(v) =
X
u
p(v | u) ρ(l)(u),
(5)
(M-step)
ρ(l+1)(u) = 1
N
N
X
t=1
p(vt | u)
q(l)(vt) ρ(l)(u),
(6)
where l starts from 0 and increases by 1 at each iteration. This algorithm can be
found in a literature [25]. The log-likelihood is non-decreasing at each update,
that is, L(ρ(l+1)) ≥L(ρ(l)). When the diﬀerence between q(l+1)(v) and q(l)(v)
becomes suﬃciently small, the update is terminated. In order to measure the
diﬀerence, we employed the Kullback-Leibler (KL) divergence which is deﬁned
as follows,
KL(q(l+1), q(l)) =
X
v
q(l+1)(v) log q(l+1)(v)
q(l)(v) .
Note that the KL divergence is non-negative and becomes 0 if and only if
q(l+1)(v) = q(l)(v) for all v. We stopped the algorithm when KL(q(l+1), q(l)) is
less than 1.0 × 10−10. The reconstructed image is proportional to the intensity
map λ(u), which is recovered from ˆρMLE(u) as ˆρMLE(u)/s(u).
3.3. Acceleration of the EM algorithm
The convergence speed of the EM algorithm is generally slow. In this work,
we implemented an acceleration algorithm which approximates the Fisher’s scor-
ing method [20, 21]. The Fisher’s method is a second order method, similar to
the Newton’s method, and a faster convergence is expected. The proposed ac-
celeration method was combined with a line search algorithm as in COMPTEL
[3].
We show the outline of the acceleration algorithm [20, 21]. When ρ(l+1)(u)
is computed from ρ(l)(u) with one EM-step, q(l+1)(v) is computed from eq. (5).
Then another EM-step is run from ρ(l)(u) where q(l+1)(v) is the target distri-
bution. After this EM-step, a new parameter ρ′(u) is obtained, which diﬀers
from ρ(l+1)(u) and the following parameter is computed
ρnew(u) ∝ρ(l+1)(u)2
ρ′(u)
.
(7)
5

In most cases L(ρnew(u)) is larger than L(ρ(l+1)(u)) and the EM algorithm is
accelerated [20].
The convergence speeds of the proposed acceleration method and the original
EM algorithm are compared through numerical simulations in section 4.2.
3.4. Maximum a posteriori estimate
Starting from a strictly positive initial distribution ρ(0)(u) > 0, every com-
ponent of ˆρMLE(u) is strictly positive by deﬁnition1. However, for astronomy
applications, it is natural to assume there are a lot of 0 components. To estimate
such a sparse solution, we used the maximum a posteriori (MAP) estimation,
which is a common approach in Bayesian statistics [22, 23].
Setting the prior of ρ as π(ρ), the MAP estimation maximizes the posterior
probability P(ρ, | v1, · · · , vN), which is proportional to π(ρ) Q
t q(vt). That is,
ˆρMAP = arg max
ρ
h
log P(ρ | v1, · · · , vN)
i
= arg max
ρ
h
log π(ρ) + L(ρ)
i
,
(8)
The Dirichlet distribution is the conjugate prior of a multinomial distribution
[22, 23] and is often used as the prior for multinomial distributions. We use
the following symmetric Dirichlet distribution with a single parameter β as the
prior of ρ(u),
πβ(ρ) = Γ(Mβ)
Γ(β)M
Y
u
ρ(u)β−1,
(9)
where M is the number of bins of u and β > 0. With this prior, eq. (8) is
rewritten as ˆρMAP = arg maxρ
h
(β −1) P
u log ρ(u) + L(ρ)
i
. Note that as the
number of the samples increases, the log likelihood function deﬁned in eq. (4)
increases, and the inﬂuence of the prior becomes relatively small. In the limit
N →∞, the MAP estimate becomes identical to the MLE.
The EM algorithm can be used to compute the MAP estimate by modifying
the M-step as
(M-step)
ρ(l+1)(u) ∝max

0,

β −1 +
N
X
t=1
p(vt | u)
q(l)(vt) ρ(l)(u)

.
(10)
If β = 1, the prior is uniform and the MAP estimation is identical to the MLE.
However, if β < 1, ˆρMAP(u) has 0 components. The number of 0 components
tends to increase as β decreases. Although the prior in eq. (9) is improper for
β ≤0, the updating rule in eq. (10) is still valid. In the rest of the paper, we
set β = 0. It should be noted that the convergence speed of the above modiﬁed
1Some components become smaller than the numerical precision and are set to 0.
6

EM algorithm is generally faster than the original EM algorithm. The MAP
estimates are computed quickly if many components of ρ(u) are 0. We show
some numerical results in the next section.
We proposed the MAP estimation in order to promote some components
to be 0, in other word, to have a sparse solution. One concern is that some
weak, possibly distributed gamma-ray sources may be neglected by the MAP
estimation. When the number of received photons is small, this may be true but
the inﬂuence of the prior becomes smaller as the number of absorbed photons
increases. If a suﬃciently large number of photons are received, the MAP recon-
struction is almost identical to the MLE reconstruction and any weak sources
would not be neglected.
4. Numerical Results
4.1. Simulated Compton camera
A Compton camera, which consists of 25 Si pixel detectors as the scatterers
and 25 CdTe pixel detectors as the absorbers, was simulated for the numerical
experiments (ﬁg. 2). The size of each detector was identical: 100 mm square
and 1.0 mm thick. All of the detectors were stacked in 2 mm intervals. Each
detector was pixellated into 50×50 channels, and was assumed to have an energy
resolution of
p
(2keV)2 + E2 (full width at half maximum, FWHM), where E
denotes the energy deposited in the detector.
absorbers
(25 layers)
scatterers
(25 layers)
Figure 2: Simulated Compton camera with 25 layered scatterers (Si) and absorbers (CdTe).
Each detector is 1.0 mm thick with a 2 mm separation.
In order to perform Monte Carlo simulation, a model of the Compton cam-
era has been constructed. We used our Compton camera response generator
[26], which was implemented using the Geant4 toolkit (Version 9.6.p01) [27]
on a desktop computer (Mac Pro 6-core Intel Xeon 3.33 GHz).
The simula-
tions accurately treated the Doppler broadening eﬀect of Compton scattering
[28] due to the non-zero momentum of the target electron, which degrades the
angular resolutions of the Compton camera. Using this simulation framework,
we estimated the angular resolution measure (ARM) of the simulated Compton
camera at 2.6 degrees (FWHM) for a photon energy of 661.7 keV. The ARM
7

is deﬁned as the diﬀerence between the reconstructed scattering angle and the
actual source direction [10, 11].
In the current simulation, the range of α and δ were restricted between ±30◦.
It is possible to widen these ranges, but the goal of this work is to build eﬀective
estimation methods. Thus, we stayed within ±30◦. In a real system, events
from outside the ﬁeld of view can be discarded by physical shielding and/or
background rejection techniques based on Compton camera analysis prior to
image reconstruction.
Table 1: Design of bins of u and v.
u[degree]
v
α
δ
w1
p
|w1|
w2
p
|w2|
cos θ
min
−30
−30
−2.0
−2.0
−0.56
max
30
30
2.0
2.0
0.96
# of bins
47
47
21
21
32
The designs of image and data space is summarized in table 1. Angles α,
δ, and cos θ were quantized into equally spaced bins. For relative positions w1
and w2, equal spacing is not preferable because more photons are absorbed at
the center than the boundaries. To prevent such unbalanced measurements, the
square roots of w1 and w2 were quantized into equally spaced bins. The number
of photons absorbed at each bin became similar under this quantization. The
total numbers of bins of u and v were 47×47 = 2209 and 21×21×32 = 14, 112,
respectively. Each image bin was set to half of the ARM FWHM. The data space
binning was also roughly optimized by evaluating the angular broadening of a
point source reconstruction.
In order to compute p(v | u) and s(u), a large number of photons, 2.4×1010,
were randomly generated and recorded. Total computational time for this simu-
lation was 270 hours using an Apple Mac Pro 6-core Xeon 3.33 GHz (12 processes
with hyper-threading). The energy of a gamma-ray photon was set to 661.7 keV
(137Cs). The number of detected photons was 28,817,844, which was around
0.120 % of the total photons. The distributions p(v | u) and s(u) were com-
puted with these photon counts. It should be noted that the estimated p(v | u)
had some 0’s, which could make the EM algorithm unstable. We replaced 0’s
with a small constant, 1.0 × 10−10.
This simulation only considered 137Cs. In order to apply this method for
diﬀerent energy levels, pE(v | u) and sE(u) must be prepared for each energy
level E, and the gamma ray intensities must be estimated separately depending
on the energy level E = E1 + E2.
4.2. Computational times for diﬀerent algorithms
We used a simple point source example in ﬁg. 3 (a) to test the estimation
algorithms. The number of simulated photons was 30,000,000 and only 108,557
photons were absorbed. We reconstructed the gamma-ray source from the de-
tected photons.
8

(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
(a) Single point source.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(b) MLE reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(c) MAP reconstruction.
−30
0
30
0
0.2
0.4
0.6
0.8
1
α [degree], (δ=0)
Relative intensity
 
 
MLE
MAP
True source with ARM
(d) Line proﬁles of reconstructions along δ = 0.
Figure 3: Gamma-ray source and estimation results. (a) Single point source. Circle indicates
the position of a point source at (0◦, 0◦). Dashed line indicates the direction of the Compton
camera. (b) MLE reconstruction, (c) MAP reconstruction (98 pixels are positive), and (d)
line-proﬁles of images in (b) and (c) compared with the true source proﬁle. Each image was
normalized to have 1 as its maximum.
Three algorithms were tested: the EM algorithm for the MLE, the acceler-
ated EM algorithm for the MLE, and the modiﬁed EM algorithm for the MAP
estimation. Table 2 shows the computational times and iteration numbers for
convergence.
Figure 3 shows the results. The reconstructed images of the two MLE al-
gorithms are identical to ﬁg. 3 (b), and the MAP reconstruction is very similar
(ﬁg. 3 (c)). However, the MAP reconstruction has only 98 positive pixels, while
2209 (= 47 × 47) pixels are positive for the MLE reconstruction. The proﬁles
of reconstructed images (ﬁgs. 3 (b) and (c)) along the line δ = 0 are shown in
ﬁg. 3 (d). It is diﬃcult to distinguish between MLE and MAP reconstructions.
The vertical bar in ﬁg. 3 (d) indicates the location of the true source point. The
9

Table 2: Computational times and iteration numbers ﬁr the three algorithms implemented on
a desktop computer (Intel Core i7-3770S, 3.10 GHz) with Matlab 2013a (Ubuntu Linux 13.04,
x86-64).
time [s]
iterations
EM (MLE)
370
1563
accelerated EM (MLE)
133
514
modiﬁed EM (MAP)
7.5
755
width of the bar is equal to the ARM. Proposed methods provided good esti-
mates of the true source location, and the positive regions of the reconstructed
images were similar to the ARM width.
We have shown that the accelerated EM algorithm converged faster than
the original EM algorithm. Moreover, the MAP estimation was very fast, and
converged to a reasonable sparse image.
4.3. Image reconstruction
We next prepared four types of gamma-ray sources for numerical simulations.
Sources A, B and C were two point sources (ﬁgs. 4a, 4b and 4c, respectively),
and source D was a distributed source on a ring-shaped region (ﬁg. 4d).
From each source model, a number of photons were randomly generated,
and images were reconstructed. We compared the results of the MLE computed
by the accelerated EM algorithm, the MAP estimation with the Dirichlet prior
distribution (β = 0), and the back-projection.
Figure 5 shows the reconstructed images for source A. The reconstructed im-
ages of the BME methods have compact positive regions but two point sources
are not separated (ﬁgs. 5 (a), (b) and (d)). The back-projection reconstruction
is rather diﬀused, but it has two peaks corresponding to the two point sources
(ﬁgs. 5 (c) and (d)). Though the MLE and MAP reconstructions looks simi-
lar, each pixel of the MLE reconstruction is strictly positive whereas the MAP
reconstruction has only 127 positive pixels.
Figures 6 and 7 show reconstructed images for sources B and C, respectively.
For these sources, the MLE and the MAP reconstructions separate two points
clearly. The line proﬁles show that the positive regions of the BME images are
similar to the true sources with the ARM width.
Figure 8 shows the results for source D. The BME methods and back-
projection clearly diﬀer; the ring-shapes of the images recovered by the BME
methods are clear and similar to the true distributed source in ﬁg. 5 (d), while
the inside of the ring of the back-projection image is positive. This is clearly
seen from ﬁg. 5 (e). The MAP estimate has only 668 positive pixels, which is
around 30% of the total number of pixels.
All of the BME methods were implemented on a desktop computer (Intel
Core i7-3770S, 3.10 GHz) with Matlab 2013a (Ubuntu Linux 13.04, x86-64).
Table 3 summarizes the computational time and the number of iterations until
convergence. The MAP estimates can be computed faster than the MLE, but
the diﬀerence becomes smaller for a distributed source.
10

(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
(a) Source A: two point sources.
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
(b) Source B: two point sources.
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
(c) Source C: two point sources.
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
(d) Source D: distributed source
on a ring.
Figure 4: Gamma-ray sources used for numerical simulations: (a) source A: the circles indicate
the positions of point sources at (0◦, 0◦) and (4◦, 0◦).
(b) source B: two point sources at
(0◦, 0◦) and (8◦, 0◦), (c) source C: two point sources at (0◦, 0◦) and (12◦, 0◦), and (d) source
D: distributed source on a ring, where the outer and inner circles were 16◦and 24◦apart from
the center, respectively. Dashed lines indicate the direction of the Compton camera.
4.4. Discussion
Numerical results of the image reconstructions were shown in previous sub-
sections. We provide some discussions in this subsection.
Firstly, we explain why we set the parameter β to 0 for the MAP estimation.
Dirichlet prior with β = 1 corresponds to the MLE, and the solution becomes
sparser as β decreases. Since the Bayesian prior becomes improper for β ≤0,
it is not preferable to use negative β. From the experimental results, the MAP
reconstructed images of the MAP estimation with β = 0 were almost identical
to those of the MLE. We did not show any results for 0 < β < 1 because the
images were almost identical, and the results were less sparse. Thus, β was set
to 0 throughout our experiments.
Secondly, we consider the convergence speed.
Every BME methods was
implemented with an iterative method.
Therefore, the convergence speed is
characterized with the computational time of one iteration and the number of
iterations until the convergence. One iteration of the accelerated EM algorithm
takes more time than the original EM because it uses a line search algorithm.
11

 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(a) MLE reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(b) MAP reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(c) Back projection reconstruction.
−30
0
30
0
0.2
0.4
0.6
0.8
1
α [degree], (δ=0)
Relative intensity
 
 
MLE
Back projection
True source with ARM
(d) Line proﬁles of reconstructions along δ = 0.
Figure 5: Reconstructed images for source A in ﬁg. 4a. using 108,557 absorbed photons. (a)
MLE reconstruction, (b) MAP reconstruction (127 pixels are positive), (c) image reconstruc-
tion with back projection, and (d) line-proﬁles of images in (a) and (c) compared with the
true source proﬁle. Each image was normalized to have 1 as its maximum.
One iteration of the MAP estimation is computed faster than the original EM.
This is because the MAP estimate is sparse. The E-step shown in eq. (5) is
merely a multiplication of a matrix and a vector, and if the vector is sparse, it
can be computed quickly. This is why the MAP converged faster than the MLE
(accelerated EM) even if the number of iterations was larger than the MLE.
However, this eﬀect becomes less evident when the reconstruction is not sparse.
We see that the diﬀerence of the computational time was smaller for source (D).
This is because the ﬁnal reconstructed image was not sparse.
Thirdly, we discuss the source distribution. We have shown numerical re-
sults for point sources and a ring source. However, it is known that there is
background emission in astronomy. The proposed method can be applied for
the estimation of weak background emission, but a lot of photons must be col-
lected. This requires a long time for observation and is not realistic in satellite
12

Table 3: Computational time and iteration numbers of the four simulated sources in ﬁg. 4:
the accelerated EM algorithm for the MLE and the modiﬁed EM algorithm for the MAP.
MLE
MAP
source
time [sec]
iterations
time [sec]
iterations
A
3.2 × 102
770
27
1642
B
2.6 × 102
586
40
2103
C
1.2 × 102
274
32
1554
D
2.5 × 103
3121
1.7 × 103
13152
applications. If the distribution form of the background is known, for example
uniform, and there are point sources and background emission, it is possible to
estimate the point sources and the level of the background by extending our
framework. However, further details are beyond the scope of this paper.
Finally, we discuss the quality of the reconstructed images. The BME recon-
structed images were not smooth compared to the back-projections. Although
our results are less smooth, we observed from the line-proﬁles that our meth-
ods provided good estimates of the positive regions while the back-projection
images became positive for the whole space. If we know that the true source is
a collection of point sources, it might be possible to estimate their positions as
the peaks of the back-projection image. However, if the source is distributed, it
is diﬃcult to estimate the region by the back-projection and the proposed BME
methods will give better results.
We believe the reason our reconstructions were not smooth partially comes
from the size of the simulation. By collecting more photons for p(v | u) and
s(u), we will have smoother results. This is one of our future works.
5. Conclusion
We have proposed BME methods for Compton camera imaging. Under the
assumption that the distances from the gamma-ray sources are large, the number
of bins can be reduced, making BME methods eﬀective.
We follow the framework of COMPTEL and applied it to a layered system.
Additionally, we propose two extensions of the EM algorithm: the acceleration
of the EM algorithm for the MLE and the modiﬁed EM algorithm for the MAP
estimation. Numerical simulations conﬁrm that the accelerated EM algorithm
converges faster than the original EM algorithm, and the MAP estimate con-
verges quickly into a sparse image. The proposed methods are promising for
astronomy applications. One of our goal is to apply the propose methods to
real astronomy data.
We believe this paper provides a solid framework for the Compton camera
imaging. The EM algorithm for the MLE is a basic approach and we have shown
possible directions for extensions. In the current paper, we rely on the situation
of the astronomy, where the gamma-ray sources are far from the camera. But if
we can relax this assumption, we may be able to apply similar methods for the
13

 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(a) MLE for source B.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(b) MAP for source B.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(c) Back projection for source B.
−30
0
30
0
0.2
0.4
0.6
0.8
1
α [degree], (δ=0)
Relative intensity
 
 
MLE
Back projection
True source with ARM
(d) Line proﬁles of reconstructions along δ = 0.
Figure 6: Reconstructed images for two point sources B in ﬁgs. 4b where 147,515 photons were
absorbed. (a) MLE reconstructions, (b) MAP reconstructions (137 pixels were positive), (c)
image reconstruction with the back projection, and (d) line-proﬁles of images in (a) and (c)
compared with the true source proﬁle. Each image was normalized to have 1 as its maximum.
measurements of the distribution of 137Cs in the environment of Fukushima[8]
and for medical applications.
Acknowledgment
This work was supported by JSPS Grant-in-Aid for Scientiﬁc Research on
Innovative Areas, Number 25120008.
References
[1] H. Bloemen, et al., COMPTEL imaging of the Galactic disk and the sep-
aration of diﬀuse emission and point sources, Astrophys. Journal Suppl.
Ser. 92 (1994) 412–423.
14

 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(a) MLE for source C.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(b) MAP for source C.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(c) Back projection for source C.
−30
0
30
0
0.2
0.4
0.6
0.8
1
α [degree], (δ=0)
Relative intensity
 
 
MLE
Back projection
True source with ARM
(d) Line proﬁles of reconstructions along δ = 0.
Figure 7: Reconstructed images for two point sources C in ﬁgs. 4c where 150,449 photons were
absorbed. (a) MLE reconstructions, (b) MAP reconstructions (134 pixels were positive), (c)
image reconstruction with the back projection, and (d) line-proﬁles of images in (a) and (c)
compared with the true source proﬁle. Each image was normalized to have 1 as its maximum.
[2] V. Sch¨onfelder, et al., COMPTEL overview: Achievements and expecta-
tions, Astron. Astrophys. Suppl. Ser. 120 (1996) 13–21.
[3] J. Kn¨odlseder, et al., Image reconstruction of COMPTEL 1.8 MeV26 Al
line data, Atron. Astrophys. 345 (1999) 813–825.
[4] J. LeBlanc, et al., C-SPRINT: a prototype Compton camera system for
low energy gamma ray imaging, IEEE trans. Nucl. Sci. 45 (1998) 943–949.
[5] T. Takahashi, et al., High resolution CdTe detectors for the next-generation
multi-Compton gamma-ray telescope, Proc. SPIE 4851 (2003) 1228.
[6] G. Kanbach, et al., The MEGA project, New Astronomy Reviews 48 (2004)
275–280.
15

 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(a) MLE reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(b) MAP reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
0
0.2
0.4
0.6
0.8
1
(c) Back projection reconstruction.
 
(30°,30°)
(30°,−30°)
(−30°,−30°)
(−30°,30°)
 
(d) True source distribution.
−30
0
30
0
0.2
0.4
0.6
0.8
1
α [degree], (δ=0)
Relative intensity
 
 
MLE
Back projection
True source with ARM
(e) Line proﬁles of reconstructions along δ = 0.
Figure 8: Reconstructed images for source D in ﬁg. 4d where 4,337,897 photons were ab-
sorbed. (a) MLE reconstruction, (b) MAP reconstruction (668 pixels are positive), (c) image
reconstruction with the back projection, and (d) true distributed gamma-ray source shown
comparison. (e) line-proﬁles of images in (a) and (c) compared with the true source proﬁle.
Each image was normalized to have 1 as its maximum
[7] S. E. Boggs, The Advanced Compton Telescope mission, New Astronomy
Reviews 50 (2006) 604–607.
[8] JAXA press release, http://www.jaxa.jp/press/2012/03/20120329 compton e.html,
2012.
[9] S. Watanabe, et al., A Si/CdTe semiconductor Compton camera, IEEE
trans. Nucl. Sci. 52 (2005) 2045–2051.
[10] S. Takeda, Experimental Study of a Si/CdTe Semiconductor Compton
Camera for the Next Generation of Gamma-ray Astronomy, Ph.D. thesis,
The University of Tokyo, 2008.
[11] S. Takeda, et al., Experimental results of the gamma-ray imaging capability
16

with a Si/CdTe semiconductor Compton camera, IEEE trans. Nucl. Sci.
56 (2009) 783–790.
[12] H. Odaka, et al.,
High-resolution Compton cameras based on Si/CdTe
double-sided strip detectors, Nucl. Instr. and Meth. A 695 (2012) 179–183.
[13] T. Takahashi, et al.,
The ASTRO-H mission,
Proc. SPIE 7732 (2010)
77320Z.
[14] H. Tajima, et al.,
Soft gamma-ray detector for the ASTRO-H mission,
Proc. SPIE 7732 (2010) 773216.
[15] L. C. Parra, Reconstruction of cone-beam projections from Compton scat-
tered data, IEEE trans. Nucl. Sci. 47 (2000) 1543–1550.
[16] M. Hirasawa, T. Tomitani, Image reconstruction from limited angle Comp-
ton camera data, Phys. Med. Biol. 47 (2002) 2129–2145.
[17] D. Xu, Z. He,
Filtered back-projection in 4π Compton imaging with a
single 3D position sensitive CdZnTe detector, IEEE trans. Nucl. Sci. 53
(2006) 2787–2796.
[18] M. S. Bandstra, et al., Detection and imaging of the Crab Nebula with the
nuclear Compton telescope, Astrophys. Journal 738:8 (2011) 9pp.
[19] A. P. Dempster, N. M. Laird, D. B. Rubin,
Maximum likelihood from
incomplete data via the EM algorithm, J. R. Statistical Society, Series B
39 (1977) 1–38.
[20] S. Ikeda, Acceleration of the EM algorithm, Systems and Computers in
Japan 31 (2000) 10–18.
[21] G. J. McLachlan, T. Krishnan, The EM Algorithm and Extensions, Wiley
series in probability and statistics, John Wiley & Sons, Inc., 2nd edition,
2008.
[22] J. M. Bernardo, A. F. M. Smith, Bayesian theory, Wiley series in proba-
bility and statistics, John Wiley & Sons, Inc., 1994.
[23] C. M. Bishop, Pattern Recognition and Machine Learning, Springer, 2006.
[24] S. J. Wilderman, N. H. Clinthorne, J. A. Fessler, W. L. Rogers, Improved
modeling of system response in listmode EM reconstruction of Compton
scatter camera images, IEEE trans. Nucl. Sci. 48 (2001) 111–116.
[25] L. A. Shepp, Y. Vardi, Maximum likelihood reconstruction for emission
tomography, IEEE trans. Medical Imaging MI-1 (1982) 113–122.
[26] H. Odaka, et al.,
Development of an integrated response generator for
Si/CdTe semiconductor Compton cameras, Nucl. Instr. and Meth. A 624
(2010) 303–309.
17

[27] J. Allison, et al., Geant4 developments and applications, IEEE trans. Nucl.
Sci. 53 (2006) 270–278.
[28] A. Zoglauer, G. Kanbach, Doppler broadening as a lower limit to the an-
gular resolution of next-generation Compton telescopes, Proc. SPIE (2003)
1302.
18
