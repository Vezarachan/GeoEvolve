arXiv:1508.00281v1  [stat.AP]  2 Aug 2015
Model Selection versus Model
Averaging in Dose Finding Studies
Schorning, Kirsten
Ruhr-Universität Bochum
Fakultät für Mathematik
44780 Bochum, Germany
e-mail: kirsten.schorning@rub.de
Bornkamp, Björn
Novartis Pharma AG
Lichtstrasse 35
4002 Basel, Switzerland
e-mail: bjoern.bornkamp@novartis.com
Bretz, Frank
Novartis Pharma AG
Lichtstrasse 35
4002 Basel, Switzerland
e-mail: frank.bretz@novartis.com
Dette, Holger
Ruhr-Universität Bochum
Fakultät für Mathematik
44780 Bochum, Germany
e-mail: holger.dette@rub.de
Phase II dose ﬁnding studies in clinical drug development are typically
conducted to adequately characterize the dose response relationship of a new
drug. An important decision is then on the choice of a suitable dose response
function to support dose selection for the subsequent Phase III studies. In
this paper we compare diﬀerent approaches for model selection and model
averaging using mathematical properties as well as simulations. Accordingly,
we review and illustrate asymptotic properties of model selection criteria and
investigate their behavior when changing the sample size but keeping the
eﬀect size constant. In a large scale simulation study we investigate how
the various approaches perform in realistically chosen settings. Finally, the
diﬀerent methods are illustrated with a recently conducted Phase II dose-
ﬁnding study in patients with chronic obstructive pulmonary disease.
Keywords and Phrases: Model selection; model averaging; clinical trials; simulation
study
1

1. Introduction
A critical decision in pharmaceutical drug development is the selection of an appropriate
dose for conﬁrmatory Phase III clinical trials and potential marketing authorization.
For this purpose, dose ﬁnding studies are conducted in Phase II to investigate the dose
response relationship of usually 3 −7 active doses in the intended patient population for
a clinically relevant endpoint; see Ting (2006) among many others.
Traditionally, dose response studies were analyzed by treating dose as a categorical
variable in an analysis-of-variance (ANOVA) model. Only in the past 20 years the use of
regression modeling approaches where dose is treated as a quantitative variable has be-
come more popular. We refer to, for example, Bretz et al. (2008) for an overview of both
approaches, and the White Paper of the Pharmaceutical Research and Manufacturers
of America (PhRMA) working group on adaptive dose ranging studies (Bornkamp et al.
(2007)) for a comparison of diﬀerent ANOVA and regression-based approaches.
If a non-linear regression model is adopted, a natural question is which regression
(i.e.
dose response) function to utilize.
This becomes even more important in the
regulated context of pharmaceutical drug development, where the employed regression
model should be pre-speciﬁed at the design stage. This speciﬁcation thus takes place at
a time, when only limited information is available about the dose response relationship,
resulting in model uncertainty. Several authors (e.g. Thomas (2006); Dragalin et al.
(2007)) argued that a ﬂexible monotonic model, such as an Sigmoid Emax model, can be
used for all practical purposes, as it approximates the commonly observed dose response
shapes well. While generally applicable, this ﬂexible model can sometimes be challenging
to ﬁt with a small number of doses. In addition, while several models might ﬁt the data
similarly well, due to the often sparse data they might still diﬀer on certain estimated
quantities of interest, e.g. the target dose estimate.
The MCP-Mod method (see Bretz et al. (2005); Pinheiro et al. (2014); CHMP (2014))
tries to address the model uncertainty problem by acknowledging it explicitly as part
of the methodology. The main idea is to determine a candidate set of dose response
models at the trial design stage. After completing the trial one either selects a single
dose response function out of the candidate model set or applies model averaging based
on the individual model ﬁts. Thus, the MCP-Mod approach allows one to employ either
model selection or model averaging. Verrier et al. (2014) discussed by means of two real
examples their experiences on how to proceed with model selection and model averaging
using MCP-Mod in practice.
Model selection has the advantage that it results in a single model ﬁt, which eases
the interpretation and communication.
But it is also known that selecting a single
model and ignoring the uncertainty resulting from the selection will result in conﬁdence
intervals with coverage probability smaller than the nominal value, see for example
Bornkamp (2015) for a high-level discussion or Chapter 7 in Claeskens and Hjort (2008)
for a mathematical treatment. A partial solution to this problem is to use model av-
eraging. By acknowledging model uncertainty explicitly as part of the inference one
2

will typically obtain more adequate (i.e usually wider) conﬁdence intervals. There ex-
ists empirical evidence that model averaging also improves the estimation eﬃciency (see
Raftery and Zheng (2003) or Breiman (1996)), even though authors did not consider
dose-ﬁnding setting in particular.
The purpose of this paper is to investigate and compare diﬀerent model selection and
model averaging approaches in the context of Phase II dose ﬁnding studies. Accordingly,
we introduce in Section 2 a motivating case study to illustrate the various approaches in-
vestigated throughout this paper. Next, we brieﬂy review the mathematical background
of diﬀerent selection criteria and compare them with respect to some of their asymptotic
properties in Section 3. In Section 4, we describe the results of an extensive simulation
study. We revisit the case study in Section 5 and provide some general conclusions in
Section 6.
2. A Case Study in Chronic Obstructive Pulmonary
Disease (COPD)
This example refers to a Phase II clinical study of a new drug in patients with chronic
obstructive pulmonary disease (COPD). The primary endpoint of the study was mea-
sured through the forced expiratory volume in one second (FEV1) measured in liter, after
7 days of treatment. The objective of this study was to determine the dose response
relationship and the target dose that achieves an eﬀect of δ over placebo. In COPD
an improvement δ of 0.1 −0.14 liters on top of the placebo response are considered
clinically relevant. To this end, four active dose levels (12.5, 25, 50 and 100 mg) were
compared with placebo. Point estimates and standard errors for the treatment groups
resulting from an ANCOVA ﬁt are available from clinicaltrials.gov (NCT00501852).
The original study design was a four-period incomplete block cross-over study; see also
Verkindre et al. (2010). For the purpose of this article we simulated a parallel group
design of 60 patients per group (thus 300 patients in total), so that the point estimates
and standard errors match the reported estimates exactly. Figure 2.1 displays the mean
responses at the ﬁve dose levels (including placebo) together with the marginal 95%
conﬁdence intervals.
For our purposes, we assume that ﬁve candidate models had been identiﬁed at the
design stage to best describe the data after completing the trial.
More speciﬁcally,
we assume the ﬁve dose-response functions summarized in Table 2.1, namely the linear,
quadratic, Emax, Sigmoid Emax and ANOVA model; see Section 3 for the notation used
in Table 2.1. The questions at hand are (i) which of these candidate models should be
used for the dose response modeling step, (ii) whether model selection or averaging should
be used, and (iii) which speciﬁc information criteria should be employed to perform either
model selection or averaging. We will revisit and analyse this case study in Section 5.
3

Dose
FEV1
1.20
1.25
1.30
1.35
1.40
0
20
40
60
80
100
Figure 2.1: Mean responses and marginal 95% conﬁdence intervals for the COPD case
study.
Number
Model
Function η(·, θ)
Parameter speciﬁcations
1
Linear
ϑ0 + ϑ1d
θ1 = (0, −1.65/8)
2
Quadratic
ϑ0 + ϑ1d + ϑ2d2
θ2 = (0, −1.65/3, 1.65/36)
3
Emax
ϑ0 +
ϑ1d
ϑ2+d
θ3 = (0, −1.81, 0.79)
4
Sigmoid Emax
ϑ0 +
ϑ1dϑ3
ϑ2+dϑ3
θ4 = (0, −1.7, 4, 5)
5
ANOVA
η(di, θ) = ϑi, i = 1, . . . , k
θ5 = (0, −1.29, −1.35, −1.42, −1.5,
−1.6, −1.63, −1.65, −1.65)
Table 2.1: The ﬁve candidate dose response models utilized in the case study, together
with the parameter speciﬁcations used in the simulation study from Section 4.1.
3. Model Selection and Model Averaging
We assume k diﬀerent dose levels d1, . . . , dk, where often d1 = 0 is the placebo. The
set Ξ = (d1, . . . , dk) of k = k(Ξ) dose levels is called design throughout this paper.
We further assume that for each dose level di we have ni patients i = 1, . . . , k, where
N = Pk
i=1 ni. The individual responses are denoted by
y11, . . . , y1n1, . . . , yk1, . . . , yknk.
(3.1)
Throughout this paper, we assume that the observations in (3.1) are realizations of
random variables Yij deﬁned by
Yij = η(di, θ) + εij
j = 1, . . . , ni, i = 1, . . . , k,
(3.2)
where ε11, . . . , εknk are independent and normally distributed random variables, i.e.
εij ∼
N (0, σ2). Here, η(di, θ) denotes the mean response at dose di. The compet-
ing dose response mean functions in (3.2) are denoted by ηℓ(d, θℓ), ℓ= 1, . . . , L. For
example, in the case study presented in Section 2 we assumed the L = 5 candidate
models M1, . . . , M5, summarized in Table 2.1.
4

Model Selection Criterion I
Penalty Term for model Mℓ
AIC
dMℓ
AICC
NdMℓ
N−dMℓ−1
BIC
0.5 log(N)dMℓ
BIC2
0.5(log(N)dMℓ−log(2π)dMℓ)
TIC
tr( ˆJ−1 ˆK)
Table 3.1: Five model selection criteria and their corresponding penalty terms investigated
in this paper, where dMℓdenotes the dimension of the parameter for model Mℓ.
In the remainder of this section we give a brief overview of commonly used information
criteria for selecting a model from a given class of competing models. All criteria can
be represented in the form
2 max
θℓ
log LN(Mℓ, θℓ) −2 penℓ,I
(3.3)
where LN denotes the likelihood function and penℓ,I a penalty term which diﬀers for the
diﬀerent models Mℓand selection criteria I. Table 3.1 summarizes the penalty terms of
diﬀerent criteria that will be introduced below and investigated in later sections.
3.1. Information criteria based on the AIC
AIC-based information criteria are often motivated from an information theoretic per-
spective. Let g(y|d) denote the true but unknown density of the response variable Y
given the dose d. In order to estimate target doses of interest and the dose response
curve, we want to identify a model M deﬁned by a parametric density pM(y|d, θM) for
the response variable Y from a given class of L parametric models which approximates
the true density g(y|d) best. In order to measure the quality of the approximation we
use the Kullback Leibler divergence (KL-divergence)
KL(pM, g) =
k
X
i=1
ni
N
Z
log

g(y|di)
pM(y|di, θM)

g(y|di)dy.
(3.4)
The KL-divergence serves as a distance measure between densities. It is nonnegative and
equal to zero if g(y|d) = pM(y|d, θM). Based on the KL-divergence a model M from a
given class of L models, say M1, . . . , ML, is called the best approximating model if its
density (with corresponding optimizing parameter θ∗
M) minimizes the KL-divergence to
the true density g(y|d) compared to the KL-divergence of the other L −1 models.
In practice, the identiﬁcation of the best approximating model within a set of L
candidate models M1, . . . , ML by minimizing the KL-divergence (3.4) is not possible
because this criterion depends on the unknown true density. However the divergence and
the parameters corresponding to the best approximation can be estimated from the data
5

y11, . . . , y1n1, . . . , yk1, . . . , yknk. Ignoring the terms that are the same across all models,
one hence needs to minimize
QN(Mℓ) := E
" k
X
i=1
ni
N
Z
log pℓ(y|di, ˆθℓ)g(y|di)dy
#
,
where the expectation is taken with respect to the distribution of the maximum likeli-
hood (ML) estimator ˆθℓof the parameter θℓin model Mℓ, ℓ= 1, . . . , L.
It is known that the empirical estimator of this quantity, the log likelihood 1
N maxθℓlog(LN(Mℓ, θℓ))
is a biased estimator and overestimates QN(Mℓ), leading to overﬁtting (cf. Claeskens and Hjort
(2008)). A bias corrected estimator instead is given by
Q∗
N(Mℓ) = 1
N max
θℓ
log(LN(Mℓ, θℓ)) −penℓ,I
N
.
(3.5)
Using diﬀerent estimators for the penalty term thus leads to diﬀerent model selection
criteria; see Table 3.1. Claeskens and Hjort (2008) discussed under which circumstances
the diﬀerent penalties lead to an approximately unbiased estimation of QN(Mℓ), in
Appendix A we provide further technical background on asymptotic approximations of
the bias term. Setting penℓ,I = dMℓleads to the popular Akaike information criterion
(AIC; Akaike (1974))
AIC(Mℓ) = 2 max
θℓ
log(LN(Mℓ, θℓ)) −2dMℓ.
The coeﬃcient 2 is added because of approximation arguments (see among others Claeskens and Hjort
(2008)). Hurvich and Tsai (1989) pointed out that the dimension dMℓis not a good es-
timator of the bias for small sample sizes and proposed the penalty term
NdMℓ
N−dMℓ−1,
leading to the corrected AIC (AICC). Also, Takeuchi (1976) suggested the penalty term
tr( ˆJ−1(Mℓ) ˆK(Mℓ)), leading to Takeuchi’s or the Trace Information Criterion (TIC),
where K denotes the Fisher information matrix and J the negative inverse of the ex-
pectation of the second derivative of the log likelihood function. Both K and J are
estimated; see Appendix A for details.
3.2. Information criteria based on the BIC
Roughly speaking, the Bayesian Information Criterion (BIC; Schwarz (1978)) chooses the
most likely model based on the data. More precisely, let Pr(M1), . . . , Pr(ML) denote
the prior probabilities for the models M1, . . . , ML and p1(θ1), . . . , pL(θL) prior distri-
butions for the corresponding parameters θ1, . . . , θL, respectively. Using Bayes’ theorem
and the observations yN = (y11, . . . , y1n1, . . . , yk1, . . . , yknk) the posterior probability of
model Mℓis given by
Pr(Mℓ| Y = yN) =
Pr(Mℓ)λℓ(yN)
PL
k=1 Pr(Mk)λk(yN)
(3.6)
6

where λℓ(yN) := p(yN | Mℓ) =
R
ΘℓLN(Mℓ, θℓ)pℓ(θℓ)dθℓ, ℓ= 1, . . . , L denotes the
marginal likelihood (Wassermann (2000) and Claeskens and Hjort (2008) among oth-
ers). Note that the denominator is the same for every model under consideration, so
that we only have to compare the numerators in (3.6) in order to compare the models.
Additionally, if we choose equal prior weights for the models, namely Pr(Mℓ) = 1/L
for ℓ= 1, . . . , L, it suﬃces to consider the terms λ1, . . . , λL for model selection. In this
case, exact Bayesian Inference would use 2 log λℓ(yN) for model Mℓto compare between
diﬀerent models. For the BIC this value is approximated. Approximating the marginal
likelihoods by a Laplace approximation one obtains (Claeskens and Hjort (2008))
λℓ(yN) ≈LN(Mℓ, ˆθℓ)(2π)dMℓ/2N−dMℓ/2 | J(ˆθℓ) |−1/2 pℓ(ˆθℓ).
Therefore, the approximation is given by
2 max
θℓlog(LN(Mℓ, ˆθℓ)) −dMℓlog(N) + dMℓlog(2π) −log(|JMℓ(ˆθℓ)|) + 2 log(pℓ(ˆθℓ)).
The penalty term of the BIC only uses the terms of the approximation which converge
to inﬁnity with increasing sample size N:
BIC(Mℓ) = 2 max
θℓ
log(LN(Mℓ, θℓ)) −dMℓlog(N).
(3.7)
Draper (1995) proposed to add the constant term log(2π)pℓin (3.7) and we refer to this
modiﬁcation of the BIC as BIC2.
3.3. Properties
In this section we investigate two properties for the model selection criteria introduced
so far. First, we discuss consistency as a method to compare diﬀerent model selection
criteria (Claeskens and Hjort (2008)) and illustrate the theoretical results with a simu-
lation study. Second, we investigate the behavior of the criteria if the eﬀect size (the
ratio of treatment eﬀect and variability) stays constant, but the sample size changes,
which is of particular importance when designing dose ﬁnding studies in pharmaceutical
drug development.
3.3.1. Consistency
Consistency is a popular way to compare diﬀerent model selection criteria. Consistency
of an information criterion ensures that it picks the best approximating model (among
the candidate models) with a probability converging to 1 with increasing sample size. In
general, consistency of a model selection criterion of type (3.3) depends on the structure
of the penalty term. If the best approximating model is unique, a suﬃcient condition
for consistency is that the penalty term is strictly positive and when divided by the
sample size converges to zero (see Claeskens and Hjort (2008), pp. 100-101). All model
7

sample size
Probability
0.0
0.2
0.4
0.6
0.8
1.0
10^3
10^4
10^5
AIC
BIC
BIC2
10^3
10^4
10^5
0.0
0.2
0.4
0.6
0.8
1.0
TIC
Figure 3.1: The Probability to select the Sigmoid Emax model if the Sigmoid Emax model
is true. The depicted lines are the smoothing splines using the data.
selection criteria considered in Section 3.1 and 3.2 fulﬁll this requirement. However, if
the best approximating model is not unique and there exist several best approximating
models with diﬀerent complexities (i.e. nested models), criteria with a ﬁxed penalty
(independent of the sample size) will not necessarily select the model with the smallest
number of parameters in the set of best approximating models (see Claeskens and Hjort
(2008), pp. 101-102). Therefore the AIC and the TIC have a tendency to overﬁt, whereas
the BIC and the BIC2 do not.
We illustrate this using simulations. For simplicity, we consider a situation with two
candidate models: Emax and Sigmoid Emax; see Table 2.1. The Emax model is nested
within the Sigmoid Emax model when setting ϑ3 = 1. We assume a ﬁxed design where
patients are equally randomized to one of the active doses d1 = 0, d2 = 1, . . . , d9 = 8
and consider increasing sample sizes, starting with sample size N = 150, increasing to
N = 150, 000. In the ﬁrst scenario the Sigmoid Emax model is the correct model with
parameter θ = (0, −1.81, 0.79, 2). As predicted by asymptotic theory the AIC, the BIC,
the BIC2 and the TIC select the right model with probability tending to 1, because there
is a unique best approximating model, namely the true Sigmoid Emax model itself (see
Figure 3.1). Comparing the rates of convergence for the diﬀerent criteria, we conclude
that AIC and TIC perform better than BIC and BIC2 in this scenario.
8

sample size
Probability
0.0
0.2
0.4
0.6
0.8
10^3
10^4
10^5
AIC
BIC
BIC2
10^3
10^4
10^5
0.0
0.2
0.4
0.6
0.8
TIC
Figure 3.2: Probability to select the Sigmoid Emax model if the Emax model is true. The
depicted lines are the smoothing splines using the data.
In the second scenario the Emax model is the true model with parameter θ = (0, −1.81, 0.79).
Both the Emax and the Sigmoid Emax model are closest to the true model with re-
spect to the KL-divergence, because the Emax model is a special case of the Sigmoid
Emax model with ϑ3 = 1.
As expected the BIC and BIC2 choose the more com-
plex Sigmoid Emax model with probability tending to 0 (see Figure 3.2). The AIC
and TIC choose the Sigmoid Emax model with probability tending to 15.7%.
This
value is the asymptotic probability that the AIC selects the Sigmoid Emax model,
since AIC(Sigmoid Emax) −AIC(Emax)
D
−→χ2
1 −2 and P(χ2
1 > 2) = 15.7% (see
Claeskens and Hjort (2008), p. 50). Summarizing, both the AIC and the TIC have a
tendency to overﬁt asymptotically if the best approximating model is not unique.
3.3.2. Dependence on the sample size
In clinical practice, the sample size at the design stage is often calculated to ensure
that the standard error of a quantity of interest (typically the treatment eﬀect) is below
a given threshold. From a practical viewpoint it would thus be desirable if a model
selection criterion chooses the same dose response model regardless of the sample size as
long as the standard error around the estimated dose-response curve remains the same.
In this context one would expect that a model selection criterion behaves similarly
9

Group sample size
Probability
0.2
0.4
0.6
0.8
0
10
20
30
40
50
AIC
BIC
BIC2
TIC
Figure 3.3: Probability to select the Sigmoid Emax model if the Sigmoid Emax model
is true and the variance depends on the group sample size. The depicted lines are the
smoothing splines using the data.
if there are 100 noisy observations (e.g., with a standard deviation of σy = 10, thus
resulting in a standard error σy/
√
100 = 1) or if there are 10 less noisy observations
(e.g., σy =
√
10 resulting in the same standard error σy/
√
10 = 1).
We investigate the diﬀerent model selection criteria with respect to this property
using the following scenario. Consider the balanced case with equal group sample size
n = ni at each dose level di, i = 0, 1, . . . , 8. The observations are simulated from the
Sigmoid Emax model with parameter θ = (0, −1.81, 0.79, 2) and normally distributed
errors with standard deviation σn =
√
0.01n. That is, the variance increases with the
sample size. Standard results on maximum likelihood estimation show that the standard
error of all estimators depends on the sample size only through the ratio σn/√n and
consequently this choice gives a constant standard error across the diﬀerent sample sizes.
The candidate models are again the Emax and the Sigmoid Emax model and the group
sample size is given by n = 1, 2, 3, 5, 10, 15, 20, . . ., 50. We calculate the probability that
the model selection criteria AIC, BIC, BIC2 and TIC select the Sigmoid Emax model
under the assumption that the latter is the true model. The results are displayed in
Figure 3.3.
We observe that the probability to choose the Sigmoid Emax model is nearly constant
for the AIC and TIC, unless the sample size is very small. On the other hand the BIC’s
and the BIC2’s probabilities depend on the sample size since the probability to select
10

the Sigmoid Emax model decreases with increasing sample size. Thus the sample size
inﬂuences model selection by BIC-type criteria not only through the standard error but
also on its own. This is an important point to take into account when planning studies
using BIC-like criteria.
3.4. Model averaging
Instead of selecting one model, model averaging can also be considered. From a Bayesian
perspective model averaging arises as soon as a prior distribution supported on a can-
didate set of models is used, because the posterior distribution will then also be based on
the same candidate models, weighted by their posterior model probability; see Wassermann
(2000). Non-Bayesian model averaging methods have also been proposed; see Hjort and Claeskens
(2003) for a detailed description. For a given quantity of interest, say µ, these model
averaging estimators are obtained by calculating a weighted average of the individual
estimators of the candidate models M1, . . . , ML. One way of determining the model
weights is to use transformations of the model selection criteria for each candidate model.
More precisely, let µ denote the parameter of interest (e.g. the eﬀect at a speciﬁc dose
level) and ˆµℓthe estimator of µ using the model Mℓ, ℓ= 1, . . . , L. Then the model
averaging estimator based on the model selection criterion I is given by
ˆµI,AV =
L
X
ℓ=1
ωI(Mℓ)ˆµℓ
(3.8)
with corresponding weights Hjort and Claeskens (2003); Buckland et al. (1997)
ωI(Mℓ) =
exp(0.5 I(Mℓ))
PL
i=1 exp(0.5 I(Mi))
.
(3.9)
In Section 4 we will investigate model averaging estimators for each of the information
criteria in Table 3.1. Note that when BIC or BIC2 are used, the resulting model weights
are approximations of the underlying posterior model probabilities in a Bayesian model,
although other criteria, such as the AIC have a Bayesian interpretation as well; see Clyde
(2000).
3.5. Bootstrap model averaging based on AIC and BIC
An alternative way to perform model averaging is to use bagging (bootstrap aggregating),
as proposed by Breiman (1996). In the following we investigate two estimators of µ based
on bootstrap model averaging using either AIC or BIC. The essential idea is to bootstrap
the model selection and use all bootstrap predictions for one ﬁnal prediction. As diﬀerent
models might have been selected in each bootstrap resample, this method can also be
considered as a model averaging method.
11

To be precise consider the sample (d1, y11), . . . , (d1, y1n1), . . . , (dk, yk1), . . . , (dk, yknk)
with Pk
i=1 ni = N, where ni > 1 for all i = 1, . . . , k. We determine the bootstrap
estimator of µ based on the AIC and the BIC using R bootstrap samples:
1. Bootstrap step:
Perform a stratiﬁed bootstrap on the sample
(d1, y11), . . . , (d1, y1n1), . . . , (dk, yk1) . . . , (dk, yknk).
That is, we select a random sample (di, y∗
i1), . . . , (di, y∗
ini) of size ni out of (di, yi1), . . . , (di, yini)
with replacements for every dose di, i = 1, . . . , k.
2. Model selection step:
Calculate the AIC and BIC value for every competing model based on the boot-
strap sample. Select the model with the largest AIC and BIC value and estimate
the parameter of interest µ based on the selected model. The resulting estimators
are denoted by ˆµB
AIC and ˆµB
BIC, respectively.
From the R bootstrap samples the medians of the R diﬀerent estimators ˆµB
AIC and
ˆµB
BIC are used as the bootstrap estimators for µ.
4. Simulations
In this section, we report the results of an extensive simulation to investigate and com-
pare the diﬀerent model selection and averaging approaches in scenarios that are realistic
for Phase II dose ﬁnding trials. In Section 4.1 we introduce the design of the simula-
tion study, including its assumptions and scenarios.
In Section 4.2 we describe the
performance measurements used to evaluate the diﬀerent approaches. In Section 4.3 we
summarize the results of the simulation study.
4.1. Design of simulation study
Following the simulation setup of Bornkamp et al. (2007), we investigate diﬀerent con-
stellations of sample sizes, number of active dose levels, and true dose response mod-
els. More precisely, we consider two sample sizes N = 150 and N = 250 for each of
four diﬀerent designs Ξ = (d1, . . . , dk) of k = k(Ξ) active dose levels, assuming either
ﬁve (A = {0, 2, 4, 6, 8}, k(A) = 5), seven (B = {0, 2, 3, 4, 5, 6, 8}, k(B) = 7), nine
(C = {0, 1, 2, 3, 4, 5, 6, 7, 8}, k(C) = 9) or four (D = {0, 2, 4, 8}, k(D) = 4) active dose
levels. In each case the total sample size N is equally distributed across the diﬀerent
active dose levels. If
N
k(Ξ) is not an integer, we use a rounding procedure provided by
(Pukelsheim, 2006, p. 307). Further, we assume the ﬁve dose response models described
in Section 2 with parameters given in Table 2.1 as true models in the simulation. The
errors in model (3.2) are normally distributed with standard deviation
√
4.5.
12

Thus, a scenario S is deﬁned by the used total sample size N, the used design Ξ
and the model used for generating the data.
For example, one scenario is given by
N = 150, Ξ = C and the Emax model as data generating model. Summarizing, there
are S = 2 · 4 · 5 = 40 scenarios (two possible sample sizes, four possible designs and ﬁve
possible data generating models).
In the ﬁrst simulation study we exclude the ANOVA model from the list of candidate
models under consideration, focussing on the ﬁrst four models in Table 2.1. That is,
if the ANOVA model is used for generating the data, no dose response model in the
candidate set can exactly ﬁt the underlying truth, so that in this case we investigate
the behavior under model misspeciﬁcation. In the second simulation study we will add
the ANOVA model to the candidate models under consideration, thus using all ﬁve
models from Table 2.1. Furthermore, we exclude the Sigmoid Emax model from the set
of candidate models in scenarios based on the design D, since its parameters are not
estimable under D. All results are based on Nsim = 1000 simulation runs per scenario.
In each simulation run the parameters of the diﬀerent candidate models are estimated
and the value I(M) is calculated for each model selection criterion speciﬁed in Table 3.1
and for each dose response model speciﬁed in Table 2.1. The bootstrap model averaging
approach was used with R = 500 bootstrap simulations for each simulated trial.
All simulations are performed using the R-package DoseFinding Bornkamp et al. (2013).
4.2. Measurements of performance
We use the standardized mean squared error (SMSE) and the averaged standardized
mean square error (ASMSE) to assess estimation of the dose eﬀects and the target dose
of interest, as well the proportion of selecting the correct dose response model to evaluate
the performance of the model selection criteria.
For a given scenario S (out of the S = 40 scenarios) let ˆηj,S(d, ˆθj,S) denote the esti-
mated regression model with corresponding estimated model parameters ˆθj,S which is
selected by a given model selection criterion I in the j-th simulation run. Moreover, let
ηS(·, θS) denote the data generating dose response model of the scenario S. The mean
squared error (MSE) of the treatment eﬀect estimator at dose level d is then given by
MSE(d, S) =
1
Nsim
Nsim
X
j=1

ˆηj,S(d, ˆθj,S) −ηS(d, θS)
2
.
The average mean squared error (AMSE) for an arbitrary design Ξ with k(Ξ) diﬀerent
active dose levels is given by AMSE(Ξ, S) =
1
k(Ξ)
Pk(Ξ)
i=1 MSE(di, S). In order to obtain
comparability between the scenarios it is useful to standardize the average mean squared
errors. This is achieved by dividing AMSE(Ξ, S) by the minimal average mean squared
error MMSE(Ξ, S) = minηM
1
Nsim
PNsim
j=1
1
k(Ξ)
Pk(Ξ)
i=1
 ηM(di, ˆθ(k)
M ) −ηS(di, θS)
2 where the
minimum is taken with respect to all models ηM and ˆθ(k)
M is the maximum likelihood
13

estimator of model M in the k-th simulation run of scenario S. The standardized MSE
(SMSE) of scenario S for a speciﬁc selection criterion is then given by
SMSE(Ξ, S) = AMSE(Ξ, S)
MMSE(Ξ, S)
(4.1)
and the averaged standardized MSE (ASMSE), i.e. the SMSE averaged over all simula-
tion scenarios, is given by
ASMSE(Ξ) = 1
S
S
X
s=1
SMSE(Ξ, Ss).
(4.2)
Moreover, we consider model selection procedures to estimate the target dose achieving
an eﬀect of δ = 1.3 over placebo tdηM(θM) = η−1
M(δ, θM) for a given dose response model
M. Similarly as above, we then deﬁne the MSE as
MSEtd,η(S) =
1
Nsim
Nsim
X
j=1

tdˆηS,k(ˆθS,k) −tdηS(θS)
2
.
(4.3)
Note that those simulation runs, where the estimated target dose is not contained within
the dose range, are excluded from the MSE calculation. The standardization of the MSE
is again achieved by dividing (4.3) by MMSEtd(S) = minηM
1
Nsim
PNsim
k=1
 tdηM(ˆθ(k)
M ) −
tdηS(θS)
2 where the minimum is calculated with respect to all models ηM under con-
sideration. The standardized MSE (SMSE) of scenario S for the target dose is then
given by
SMSEtd(S) =
MSEtd(S)
MMSEtd(S)
(4.4)
and the averaged standardized mean square error for the target dose (ASMSEtd) is again
obtained by averaging the SMSEs over all scenarios.
Note that the estimator of the target dose is calculated by interpolation if the ANOVA
model is selected by the model selection criterion I.
The model averaging estimators ˆµk(d) for the dose eﬀect d and the target dose are
obtained from (3.8) and (3.9), where the parameter µ is given by η(d, θ) and tdη(θ),
respectively. The deﬁnition of the weights in the model averaging procedure is slightly
modiﬁed if the target dose estimator of a model lies outside the dose range. In this
case the estimator is not used and the model averaging estimator is calculated from the
weights of the remaining models if their weights sum up to a value greater than 20%.
Otherwise this case is excluded. For bootstrap model averaging a similar approach is
used, when there are more than 80% of the target dose estimators lying outside the
design space for a given bootstrap run, it is excluded from the calculation.
14

criterion
AIC
BIC
BIC2
TIC
AICC
ASMSE(A)
1.35
1.54
1.41
1.35
1.51
ASMSE(B)
1.38
1.56
1.44
1.38
1.55
ASMSE(C)
1.35
1.46
1.38
1.35
1.48
ASMSE(D)
1.37
1.58
1.44
1.37
1.55
ASMSEtd
1.70
2.35
1.92
1.71
2.74
Table 4.1: The averaged standardized mean squared errors (ASMSE, cf. (4.2)) for the
designs A, B, C and D and for the target dose under the consideration of diﬀerent model
selection criteria. (The best values per row are printed in bold.)
criterion
AIC
BIC
BIC2
TIC
AICC
AIC-Boot
BIC-Boot
ASMSE(A)
1.24
1.39
1.28
1.24
1.26
1.21
1.29
ASMSE(B)
1.26
1.40
1.30
1.26
1.28
1.24
1.30
ASMSE(C)
1.23
1.33
1.25
1.24
1.25
1.21
1.24
ASMSE(D)
1.25
1.42
1.30
1.25
1.27
1.23
1.31
ASMSEtd
1.54
1.88
1.62
1.54
1.90
1.30
1.44
Table 4.2: The averaged standardized mean squared errors (ASMSE, cf. (4.2)) for the
designs A, B, C and D and for the target dose with respect to model averaging and
bootstrap model averaging. (The best values per row are printed in bold.)
4.3. Simulation Results
In Section 4.3.1 and Section 4.3.2 we present the simulation results corresponding to the
candidate set consisting of linear, quadratic, Emax and Sigmoid Emax model. In 4.3.3
we analyze how the performance of the model selection criteria and model averaging
methods change if the ANOVA model is added to the candidate set.
4.3.1. Results based on the candidate models 1-4 in Table 2.1
First, we consider the case where the ANOVA model is not among the candidate models
used for analysis. In Table 4.1 and 4.2 we display the ASMSEs deﬁned in (4.2) for the
designs A, B, C, D and for the target dose.
The AIC and the TIC perform similarly and have the best average performance across
all scenarios both for model selection and model averaging. Comparing model selection
and model averaging it can be observed that the model averaging procedures generally
perform slightly better on average than model selection.
To get an idea of the performance in each individual scenario we ranked the model
selection and model averaging approaches for each scenario according to their perfor-
mance and display the ranks in Figure 4.1. One can clearly see that almost all criteria
perform best in some scenarios and worst in other scenarios, so no clear best criterion
can be identiﬁed. It is interesting to observe, however, that for the BIC the performance
15

AIC
BIC
BIC2
TIC
AICC
Rank 1
Rank 2
Rank 3
Rank 4
Rank 5
0
5
10
15
AIC
BIC
BIC2
TIC
0
5
10
15
20
25
AICC
AIC−Boot
BIC−Boot
Rank 1
Rank 2
Rank 3
Rank 4
Rank 5
Rank 6
Rank 7
0
5
10
15
Figure 4.1: The distribution of the ranks over all scenarios for the SMSE of dose eﬀect
in design Ξ = C. Left: model selection, right: model averaging methods.
is either very good or very bad, while for the AIC or TIC the performance is more bal-
anced across all scenarios. The mixed performance of the BIC is due to the fact that it
penalizes the complexity of a model more strongly. Consequently, it prefers the linear
model because of its smaller number of parameters, even if it is not an adequate model.
However, in situations when the linear model is the true one, the BIC performs best.
In terms of probabilities to select the true model, we observe that the AIC performs
best with respect to these criteria; see Figures B.1, B.2, and B.3 in Appendix B for the
detailed results. The averaged probabilities over all scenarios to select the true model
are given by 43%, 34%, 39%, 42% and 23% for the AIC, BIC, BIC2, TIC and AICC,
respectively, which also show some advantages for model selection based on the AIC.
Summarizing, with this set of candidate models, (linear, quadratic, Emax and Sigmoid
Emax), the AIC based estimators AIC and TIC (both for model selection as well as for
model averaging) outperform those based the other criteria.
4.3.2. Model Selection vs. Model Averaging
In this section we compare the results of model averaging with those of model selection
in more detail. In terms of the average performance, we observed that model averaging
outperforms model selection (see Tables 4.1, 4.2). We now investigate the individual
results for each scenario, see the left plots in Figures 4.2 and 4.3 which correspond to
the SMSE of the dose eﬀect in (4.1) and the target dose in (4.4).
The dashed line
in the left panel of Figure 4.2 displays the situations where the SMSE of the model
selection based estimator and the SMSE of the model averaging estimator are equal. The
16

MSE1
MSE1
MSE2
0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0
AIC
AICC
BIC
BIC2
TIC
Figure 4.2: Comparison of model selection, model averaging and bootstrap for estimating
the dose eﬀects in design C. The Figure shows the SMSE values. Left panel: model
selection (MSE1) versus model averaging (MSE2) . Right panel: model averaging (MSE1)
versus bootstrap model averaging (MSE2).
points below (above) the diagonal correspond to scenarios where the model averaging
(selection) estimators have a smaller SMSE. For example, SMSE(C, S) = 1.73 for BIC
model selection, but 1.48 for BIC model averaging in the Emax scenario S with sample
size 250 under design B, indicating that the BIC model averaging estimator is more
precise than the model selection estimator in this scenario.
One observes that across all scenarios model averaging tends to outperform model
selection consistently, resulting in smaller SMSE, even though the diﬀerences are never
substantial. The ratio of the SMSE(C, S) for BIC model selection and the SMSE(C, S)
or BIC model averaging is given by 1.17, which means that on average 17% more ob-
servations are needed for model selection in order to result in an estimator of similar
precision as obtained with the corresponding model averaging approach. Note that the
individual improvement obtained by model averaging depends on the selection criterion.
Comparing the improvement by model averaging with respect to target dose estimation
is even more substantial (see the left panel in Figure 4.3).
In the right panels of Figure 4.2 and of Figure 4.3 we compare the model averaging
using bootstrap with that based on the AIC and the BIC weights. We observe that
the bootstrapping estimators yields slightly better results than the model averaging
estimators except for the linear scenarios. For example, the SMSE(C, S) belonging to
BIC model averaging is equal to 1.48 whereas the corresponding SMSE(C, S) of the BIC
bootstrap estimator is smaller (SMSE(C, S) = 1.29) in the Emax scenario with sample
size 250, design B (see red line in the right panel of Figure 4.2).
The reason why the performance is worse for the linear model is that in general, more
complex models are preferred by bootstrap model averaging (especially when using the
17

MSE1
MSE1
MSE2
1
2
3
4
5
1
2
3
4
5
1
2
3
4
5
AIC
AICC
BIC
BIC2
TIC
Figure 4.3: Comparison of model selection, model averaging and bootstrap model aver-
aging for estimating the target dose. The Figure shows the SMSE. Left panel: model
selection (MSE1) versus model averaging (MSE2) . Right panel: weights based model
averaging (MSE1) versus bootstrap model averaging (MSE2) .
AIC) which implicates a lower selection probability for the linear model. This behavior
improves the performance of the bootstrap estimators in the non linear scenarios whereas
it gets worse in the linear scenarios.
4.3.3. Simulation Results based on the candidate models 1-5 in Table 2.1
From a practical point of view adding the ANOVA model to the set of candidate models
can be considered helpful to safeguard against unexpected shapes, as the ANOVA model
is extremely ﬂexible.
To compare the diﬀerent criteria for model selection and model averaging, we calcu-
lated the same metrics as in the last section. In this case the superiority of the AIC
and TIC cannot be observed anymore (see Figure 4.4). The model selection criteria
perform more similarly compared to each other (see Tables C.1, C.2 in Appendix C).
In general, however, model averaging still outperforms model selection on average, the
only exception to this is bootstrap model averaging based on the AIC. The ANOVA
approach represents a rather complex model (one parameter per dose) and it seems that
the AIC does not penalize this complexity strongly enough, thus leading to an inferior
performance. The BIC is not aﬀected similarly since it uses a higher penalty.
Considering the direct comparison of both candidate sets (namely the one with ANOVA
and the one without ANOVA) using the SMSE (see Figure 4.5, left plot) the criteria
mostly perform better if the ANOVA model is not among the candidate models.
Model averaging estimators also perform better if the ANOVA model is not among
the candidate models. For bootstrap model averaging (see right panel in Figure 4.5) one
18

AIC
BIC
BIC2
TIC
AICC
Rank 1
Rank 2
Rank 3
Rank 4
Rank 5
0
5
10
15
20
AIC
BIC
BIC2
TIC
0
5
10
15
20
AICC
AIC−Boot
BIC−Boot
Rank 1
Rank 2
Rank 3
Rank 4
Rank 5
0
5
10
15
20
25
Figure 4.4: The distribution of the ranks over all scenarios for the metric SMSE dose
eﬀect in design C (left: model selection, right: model averaging). The ANOVA model is
among the candidate models.
MSE with ANOVA
MSE without ANOVA
1.0
1.5
2.0
1.0
1.5
2.0
1.0
1.5
2.0
1.0
1.5
2.0
AIC
AICC
BIC
BIC2
TIC
Figure 4.5: Comparison of the SMSE of dose eﬀect estimators in design C with and
without the ANOVA model (left panel: model selection, center panel: weight based model
averaging, right panel: bootstrap model averaging).
can clearly see that the AIC with the ANOVA candidate model gets much worse, while
the BIC is not aﬀected.
Summarizing, the performance of the model selection criteria depends sensitively on
the candidate model set. Including the ANOVA model does not improve the performance
of all criteria, it sometimes even deteriorates the performance. Of course this is due to
the fact that the dose response shape for the ANOVA model considered here can be
19

candidate models
AIC
BIC
values
weights
Bootstrap
values
weights
Bootstrap
Linear
52.17
15%
26%
41.48
58%
64%
Quadratic
53.50
30%
36%
39.24
19%
17%
Emax
53.84
36%
30%
39.58
22%
19%
SigEmax
51.85
13%
0%
34.03
1%
0%
ANOVA
50.14
6%
8%
28.75
0%
0%
candidate models
BIC2
TIC
AICC
values
weights
values
weights
values
weights
Linear
47.00
34%
52.40
16%
52.09
16%
Quadratic
46.59
28%
53.73
30%
53.36
30%
Emax
46.93
33%
54.05
35%
53.70
36%
SigEmax
43.21
5%
52.07
13%
51.64
13%
ANOVA
39.78
0%
50.36
6%
49.85
5%
Table 5.1: The diﬀerent values of the selection criteria, the corresponding model averaging
weights (in %) and the relative frequency (in %) of the AIC and BIC bootstrap in the
COPD case study.
approximated roughly by the other candidate models. If more extreme, irregular shapes
were used, inclusion of the ANOVA model could improve performance.
5. COPD Case Study Revisited
Taking into account the results from Sections 3 and 4 we now return to the COPD
case study and the three questions posed in Section 2, which were (i) which of the
candidate models should be used for the dose response modeling step, (ii) whether
model selection or averaging should be used, and (iii) which speciﬁc information criteria
should be employed to perform either model selection or averaging.
All dose response models introduced in Table 2.1 were ﬁtted to the COPD data from
Section 2.
The model ﬁts are displayed in Figure D.1 in Appendix D. Visually all
model ﬁts are adequate, perhaps with the exception of the linear model, which seems to
overestimate the placebo response.
When observing the results for the diﬀerent information criteria in Table 5.1 one
can see that the AIC-type criteria are rather consistent among each other and favor
the Emax with 36%, the quadratic model with 30%, followed by the Sigmoid Emax
and the linear model with roughly 15% each and the ANOVA model with 6% in terms
of model weights. The BIC-related criteria give more weight to the linear model (as
already observed in the simulations), as they penalize the number of parameters more
strongly.
The BIC penalizes here considerably more strongly than the BIC2, giving
58% weight to the linear model, while the BIC2 gives around 30% to each of the linear,
20

0
20
40
60
80
100
1.1
1.2
1.3
1.4
1.5
AIC
Dose
FEV1
AIC (MS)
AIC (MAV)
AIC (Boot)
0
20
40
60
80
100
1.1
1.2
1.3
1.4
1.5
BIC
Dose
FEV1
BIC (MS)
BIC (MAV)
BIC (Boot)
0
20
40
60
80
100
1.1
1.2
1.3
1.4
1.5
BIC2
Dose
FEV1
BIC2 (MS)
BIC2 (MAV)
0
20
40
60
80
100
1.1
1.2
1.3
1.4
1.5
TIC
Dose
FEV1
TIC (MS)
TIC (MAV)
0
20
40
60
80
100
1.1
1.2
1.3
1.4
1.5
AICC
Dose
FEV1
AICC (MS)
AICC (MAV)
Figure 5.1: The ﬁtted models after model selection with respect to diﬀerent criteria.
quadratic and Emax models. The ﬁtted curves based on model selection and model
averaging for all approaches are displayed in Figure 5.1. It can be seen that for most
methods the diﬀerence between model selection and model averaging is not very large
in this example, because the models that accumulate model weights lead to relatively
similar ﬁts. For the BIC and the BIC2, however a substantial diﬀerence can be observed
between model averaging and selection: The linear model gets selected, but the Emax
and quadratic model have almost equally large model weights. Model averaging seems
particularly important in these situations, to adequately reﬂect the uncertainty in the
modeling process.
Regarding question (i) and (ii): The simulations in the last section showed a consis-
tent beneﬁt of model averaging over selection. So the proposal would be to use model
averaging here. There does not seem to be a major diﬀerence between the weight-based
and bootstrap model averaging in this particular example (see Table 5.1 and Figure
5.1). Regarding question (iii), in the simulations for a similar candidate set of models
(which did not include ANOVA) the BIC showed a slightly worse behavior than the
21

AIC, suggesting the use of the AIC-related criteria in this scenario.
The two main objectives of the study, were to evaluate the shape of the dose-response
curve and doses achieving an eﬀect of 0.1 −0.14 liters on top of placebo. So in our
situation we will use model averaging with the AIC with bootstrapping to answer these
questions. The placebo eﬀect of the curve was estimated with 1.25 (95 % CI: [1.18, 1.31]).
Within the observed dose-range increases monotonically up to an eﬀect of 0.14 (95 % CI:
[0.06, 0.22]) at the maximum dose of 100mg. At the 50mg dose 0.13 (95 % CI: [0.04, 0.20])
91.22 % (95 % CI: [ 50.00%, 164.21%]) of the maximum eﬀect is achieved, indicating
that a plateau-like level is achieved there. The increasing part of the curve is between 0
and 50mg.
6. Conclusions
This paper compared diﬀerent existing methods for model selection and model averaging
in terms of their mathematical properties and their performance for dose-response curve
estimation in a large scale simulation study.
In terms of their mathematical properties, it was reviewed and illustrated that the
BIC-type criteria are consistent, while the AIC-type criteria asymptotically tend to
prefer too complex models (see Figures 3.1 and 3.2).
It was also investigated, that
BIC-type criteria select diﬀerent models for diﬀerent total sample size, even when the
estimated dose-response curves and the uncertainty around each dose-response curve are
the same (i.e. the conﬁdence intervals width around the curve). This is diﬀerent from
other situations in clinical trial design, where only the standard error is important, not
the total sample size by itself, and an important point to take into account at the trial
design stage when using BIC-type criteria.
In terms of the simulation results we considered two candidate set of models, one did
not include an ANOVA model and one included an ANOVA model. In the ﬁrst situation
AIC-type criteria overall performed slightly better than the BIC, which penalized the
more complex models too strongly for most situations. However, when allowing the
ANOVA model to be selected as well, it turned out that the AIC selected it too often
in some situations, leading to a decreased performance. However, over all scenarios,
models and model selection criteria there seemed little value in adding an ANOVA
based model to the set of candidate models, for the scenarios we evaluated. Approaches
that selected this model more often (like the AIC-type criteria) decreased in performance
most, compared to the candidate set without the ANOVA model.
The most general observation from the simulation is however that the model averaging
methods outperformed the corresponding model selection methods. Even though the
beneﬁt is typically not large, it is consistent across considered candidate sets, models,
designs, total sample sizes, performance metrics and methods. In terms of which model
averaging method to use (weights based or bootstrap) no clear message emerges. An
advantage of the bootstrap model averaging method from a pragmatic perspective is
22

that conﬁdence intervals that take into account model uncertainty, are straightforward
to obtain from the generated bootstrap samples.
Acknowledgements. This research has received funding from the Collaborative Re-
search Center “Statistical modeling of nonlinear dynamic processes” (SFB 823, Teilpro-
jekt C1, C2) of the German Research Foundation (DFG) and from the European Union
Seventh Framework Programme [FP7 2007-2013] under grant agreement no 602552
(IDEAL - Integrated Design and Analysis of small population group trials).
References
Akaike, H. (1974). A new look at the statistical model identiﬁcation. IEEE Transactions on
Automatic Control AC, 19:716–723.
Bornkamp, B. (2015). Viewpoint: Model selection uncertainty, pre-speciﬁcation and model
averaging. Pharmaceutical Statistics, 14(2):79–81.
Bornkamp, B., Bretz, F., Dmitrienko, A., Enas, G., Gaydos, B., Hsu, C.-H., König, F., Krams,
M., Liu, Q., Neuenschwander, B., Parke, T., Pinheiro, J. C., Roy, A., Sax, R., and Shen,
F. (2007). Innovative approaches for designing and analyzing adaptive dose-ranging trials.
Journal of Biopharmaceutical Statistics, 17:965–995.
Bornkamp, B., Pinheiro, J., and Bretz, F. (2013). DoseFinding: Planning and Analyzing Dose
Finding experiments.
Breiman, L. (1996). Bagging predictors. Machine Learning, 24:123–140.
Bretz, F., Hsu, J. C., Pinheiro, J. C., and Liu, Y. (2008). Dose ﬁnding - a challenge in statistics.
Biometrical Journal, 50:480–504.
Bretz, F., Pinheiro, J. C., and Branson, M. (2005).
Combining multiple comparisons and
modeling techniques in dose-response studies. Biometrics, 61:738–748.
Buckland, S. T., Burnham, K., and Augustin, N. H. (1997). Model selection: An integral part
of inference. Biometrics, 53:603–618.
CHMP (2014).
Qualiﬁcation opinion of MCP-Mod as an eﬃcient statistical methodology
for model-based design and analysis of Phase II dose ﬁnding studies under model un-
certainty.
European Medicines Agency, Science Medicines Health, Committee for Medic-
inal Products for Human Use (CHMP), EMA/CHMP/SAWP/757052/2013 available at
http://goo.gl/imT7IT.
Claeskens, G. and Hjort, N. L. (2008). Model Selection and Model Averaging. Cambridge Series
in Statistical and Probabilistic Mathematics. Cambridge University Press.
Clyde, M. (2000). Model uncertainty and health eﬀect studies for partculate matter. Environ-
metrics, 11:745–763.
Dragalin, V., Hsuan, F., and Padmanabhan, S. K. (2007). Adaptive designs for dose-ﬁnding
studies based on the sigmoid emax model. Journal of Biopharmaceutical Statistics, 17:1051–
1070.
Draper, D. (1995).
Assessment and Propagation of Model Uncertainty.
Journal of Royal
Statisctical Society. Series B(Methodological), 57(1):45–97.
23

Hjort, N. L. and Claeskens, G. (2003). Frequentist Model Average Estimators. Journal of the
American Statistical Association, 98:879–899.
Hurvich, C. and Tsai, C. (1989). Regression and Time Series Model Selection in Small Samples.
Biometrika, 76:297–307.
Pinheiro, J. C., Bornkamp, B., Glimm, E., and Bretz, F. (2014). Model-based dose ﬁnding
under model uncertainty using general parametric models. Statistics in Medicine, 33:1646–
1661.
Pukelsheim, F. (2006). Optimal Design of Experiments. SIAM, Philadelphia.
Raftery, A. and Zheng, Y. (2003).
Discussion: Performance of bayesian model averaging.
Journal of the American Statistical Association, 98:931–938.
Schwarz, G. (1978). Estimating the dimension of a model. The Annals of Statistics, 6(2):461–
464.
Takeuchi, K. (1976). Distribution of informational statistics and a criterion of model ﬁtting.
Suri-Kagaku(Mathematical Sciences), 153:12–18. In Japanese.
Thomas, N. (2006). Hypothesis testing and Bayesian estimation using a sigmoid Emax model
applied to sparse dose designs. Journal of Biopharmaceutical Statistics, 16:657–677.
Ting, N. (2006). Dose ﬁnding in drug development. Spinger.
Verkindre, C., Fukuchi, Y., Flémale, A., Takeda, A., Overend, T., Prasad, N., and Dolker, M.
(2010). Sustained 24-h eﬃcacy of nva237, a once-daily long-acting muscarinic antagonist, in
copd patients. Respiratory Medicine, 104:1482–1489.
Verrier, D., Sivapregassam, S., and Solente, A.-C. (2014).
Dose-ﬁnding studies, mcp-mod,
model selection, and model averaging: Two applications in the real world. Clinical Trials,
11:476–484.
Wassermann, L. (2000). Bayesian model selection and model averaging. Journal of Mathemat-
ical Psychology, 44:92–107.
White, H. (1982). Maximum Likelihood Estimation of Misspeciﬁed Models. Econometrica,
50:1–26.
A. Appendix: Background on model selection criteria
based on the AIC
As in Section 3, let ˆθℓdenote the ML estimator in model Mℓ(ℓ= 1, . . . , L). As shown by
White (1982) this estimator converges in probability to the KL-divergence minimizing
parameter θ∗
ℓunder certain regularity conditions.
This gives the estimated KL-divergences
KL(pℓ(·|·, ˆθℓ), g) =
k
X
i=1
ni
N
Z
log
 
g(y|di)
pℓ(y|di, ˆθℓ)
!
g(y|di)dy, ℓ= 1, . . . , L.
Note that this term is a random variable with expected value
k
X
i=1
ni
N
Z
g(y|di) log(g(y|di))dy −E
Z
g(y|di) log pℓ(y|di, ˆθℓ)dy

24

because here the estimator ˆθℓis considered as ﬁxed. Both the ﬁrst and the second term
within the sum depend on the true density g(y|d), whereas only the second one depends
on the considered model Mℓand its estimator ˆθℓ. Thus, we only need to estimate the
term
QN(Mℓ) := E[Rn] := E
" k
X
i=1
ni
N
Z
g(y|di) log pℓ(y|di, ˆθℓ)dy
#
in order to distinguish the quality of approximations.
For the estimation of QN(Mℓ) we replace the expected value and integral by the mean
depending on the observations: Thus, an estimator for Q(Mℓ) is given by
ˆQN(Mℓ) = 1
N
k
X
i=1
ni
X
j=1
log pℓ(Yij|di, ˆθℓ) = 1
N max
θℓ
log(LN(Mℓ, θℓ)),
where LN(Mℓ, θxℓ) is the likelihood function of model Mℓevaluated at the parameter
θℓ. In principle a model could be chosen from M1, . . . , ML which leads to the largest
value of ˆQN(Mℓ) (ℓ= 1, . . . , 5). However, this naive estimator usually chooses the model
with the largest number of parameters which often leads to an overﬁt of the data. This
property is a consequence of the fact that the log likelihood function is an increasing
function of the dimension dM of the parameter θM. It is even possible to calculate the
approximate bias (see Claeskens and Hjort (2008)) as
E[ ˆQN(Mℓ)] −QN(Mℓ) ≈pen⋆
ℓ
N ,
where pen⋆
ℓ= tr(K(Mℓ)J−1(Mℓ)),
K(Mℓ) =
k
X
i=1
ni
N E
"
∂log pℓ(Y |di, θℓ)
∂θℓ
∂log pℓ(Y |di, θℓ)
∂θℓ
T#
denotes the Fisher information matrix and the matrix J,
J−1(Mℓ) = −
 
k
X
i=1
ni
N E
∂2 log pℓ(Y |di, θℓ)
∂2θℓ
!−1
,
the negative inverse of the expectation of the second derivative of the log likelihood
function. If the considered density pℓand the true density g coincide (i.e. model pℓis
the true one) and certain regularity conditions (c.f. White (1982)) are fulﬁlled, we have
K(Mℓ) = J(Mℓ) and consequently pen∗
ℓ= dMℓ, where dMℓdenotes the dimension of
the parameter θℓ.
In conclusion, a bias corrected estimator for the second part of the KL-divergence
is given by (3.5). As outlined in Section 3.1, the AIC-based criteria from Table 3.1
are based on this estimator Q∗
N(Mℓ) using diﬀerent estimators for the penalty term
25

penℓ,I = pen⋆
ℓ. Note that for the TIC the two matrices K and J−1 and thus p⋆
Mℓare
explicitly estimated by
ˆK(Mℓ) =
k
X
i=1
ni
X
j=1
1
ni
∂log pℓ(yij|di, ˆθℓ)
∂θℓ
 
∂log pℓ(yij|di, ˆθℓ)
∂θℓ
!T
,
and
ˆJ(Mℓ) = −
k
X
i=1
ni
X
j=1
1
ni
∂2 log pℓ(yij|di, ˆθℓ)
∂2θℓ
,
respectively.
The resulting penalty term is therefore given by tr( ˆJ−1(Mℓ) ˆK(Mℓ))
Takeuchi (1976).
26

B. Selection Probabilities
In this Section the probabilities that a selection criterion chooses a response model given
a speciﬁc scenario are displayed in the case where the candidate models are given by the
linear, the quadratic, the Emax and the Sigmoid Emax model.
 
Probability in %
emax
linear
linInt
sigEmax
umbrella
20
40
60
80
A
150
B
150
20
40
60
80
C
150
D
150
emax
linear
linInt
sigEmax
umbrella
A
250
20
40
60
80
B
250
C
250
20
40
60
80
D
250
P(lin|...)
P(quad|...)
P(emax|...)
P(sigEmax|...)
 
Probability in %
emax
linear
linInt
sigEmax
umbrella
20
40
60
80
A
150
B
150
20
40
60
80
C
150
D
150
emax
linear
linInt
sigEmax
umbrella
A
250
20
40
60
80
B
250
C
250
20
40
60
80
D
250
P(lin|...)
P(quad|...)
P(emax|...)
P(sigEmax|...)
Figure B.1: The probability that the AIC (left) and the AICC (right) choose a response
model given a scenario.
 
Probability in %
emax
linear
linInt
sigEmax
umbrella
20
40
60
80
A
150
B
150
20
40
60
80
C
150
D
150
emax
linear
linInt
sigEmax
umbrella
A
250
20
40
60
80
B
250
C
250
20
40
60
80
D
250
P(lin|...)
P(quad|...)
P(emax|...)
P(sigEmax|...)
 
Probability in %
emax
linear
linInt
sigEmax
umbrella
20
40
60
80
A
150
B
150
20
40
60
80
C
150
D
150
emax
linear
linInt
sigEmax
umbrella
A
250
20
40
60
80
B
250
C
250
20
40
60
80
D
250
P(lin|...)
P(quad|...)
P(emax|...)
P(sigEmax|...)
Figure B.2: The probability that the BIC (left) and the BIC2 (right) choose a response
model given a scenario.
27

 
Probability in %
emax
linear
linInt
sigEmax
umbrella
20
40
60
80
A
150
B
150
20
40
60
80
C
150
D
150
emax
linear
linInt
sigEmax
umbrella
A
250
20
40
60
80
B
250
C
250
20
40
60
80
D
250
P(lin|...)
P(quad|...)
P(emax|...)
P(sigEmax|...)
Figure B.3: The probability that the TIC chooses a response model given a scenario.
C. Tables for Simulation Study with ANOVA
AIC
BIC
BIC2
TIC
AICC
Probability
41%
34%
39%
41%
22%
ASMSE(A)
1.52
1.55
1.45
1.52
1.57
ASMSE(B)
1.57
1.57
1.47
1.56
1.60
ASMSE(C)
1.50
1.47
1.40
1.50
1.53
ASMSE(D)
1.51
1.59
1.47
1.51
1.59
ASMSEtd
1.73
2.43
1.96
1.74
2.74
Table C.1: The averages of the standardized mean squared errors taken over all scenarios
for model selection. ANOVA is among the candidate models.
AIC
BIC
BIC2
TIC
AICC
AIC-Boot
BIC-Boot
ASMSE(A)
1.36
1.39
1.31
1.36
1.29
1.56
1.30
ASMSE(B)
1.39
1.40
1.32
1.39
1.30
1.63
1.31
ASMSE(C)
1.34
1.33
1.27
1.34
1.28
1.54
1.25
ASMSE(D)
1.36
1.42
1.32
1.36
1.30
1.53
1.32
ASMSEtd
1.55
1.94
1.64
1.55
1.87
1.28
1.43
Table C.2: The averages of the standardized mean squared errors taken over all scenarios
for model averaging and bootstrap model averaging. ANOVA is among the candidate
models.
28

MSE1
MSE1
MSE2
0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0
0.5
1.0
1.5
2.0
AIC
AICC
BIC
BIC2
TIC
Figure C.1: Comparison of model selection, model averaging and bootstrap for estimating
the dose eﬀects in design C. The Figure shows the SMSE values. Left panel: model
selection versus model averaging. Right panel: model averaging versus bootstrap model
averaging. ANOVA is among the candidate models.
MSE1
MSE1
MSE2
1
2
3
4
5
1
2
3
4
5
1
2
3
4
5
AIC
AICC
BIC
BIC2
TIC
Figure C.2: Comparison of model selection, model averaging and bootstrap model aver-
aging for estimating the target dose. The Figure shows the SMSE. Left panel: model
selection versus model averaging. Right panel: weights based model averaging versus
bootstrap model averaging. ANOVA is among the candidate models.
29

D. Additional Plots for the Example
dose
response
1.20
1.25
1.30
1.35
1.40
1.45
0
20
40
60
80
100
linear
dose
response
1.20
1.25
1.30
1.35
1.40
1.45
0
20
40
60
80
100
quadratic
dose
response
1.20
1.25
1.30
1.35
1.40
1.45
0
20
40
60
80
100
emax
dose
response
1.15
1.20
1.25
1.30
1.35
1.40
1.45
0
20
40
60
80
100
sigEmax
Figure D.1: The ﬁtted candidate models, namely the linear, the quadratic, the Emax, the
Sigmoid Emax and the ANOVA model. The ANOVA model is given by the means at the
diﬀerent dose levels (which are given by the points in every ﬁgure).
30
