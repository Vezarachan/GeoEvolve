Non-Homogeneity Estimation and Universal Kriging
on the Sphere
Authors: Nicholas W. Bussberg∗, a (nbussberg@elon.edu)
Jacob Shieldsb (jacob.shields@elancoah.com)
Chunfeng Huangc (huang48@indiana.edu)
∗Corresponding author.
a Elon University, Department of Mathematics and Statistics, 100 Campus Drive,
Elon, NC 27244
b Elanco Animal Health, 2500 Innovation Way, Greenﬁeld, IN 46140
c Indiana University, Department of Statistics, Informatics East, 919 E 10th St,
Bloomington, IN 47408
Abstract
Kriging is a widely recognized method for making spatial predictions.
On the sphere, popular methods such as ordinary kriging assume that the
spatial process is intrinsically homogeneous. However, intrinsic homogeneity
is too strict in many cases. This research uses intrinsic random function
(IRF) theory to relax the homogeneity assumption. A key component of
modeling IRF processes is estimating the degree of non-homogeneity. A
graphical approach is proposed to accomplish this estimation.
With the
ability to estimate non-homogeneity, an IRF universal kriging procedure can
be developed. Results from simulation studies are provided to demonstrate
the advantage of using IRF universal kriging as opposed to ordinary kriging
when the underlying process is not intrinsically homogeneous.
Keywords: Intrinsic random functions; Non-homogeneity; Universal kriging;
Spatial statistics
arXiv:2107.02871v1  [stat.ME]  6 Jul 2021

1
Introduction
Since the late 1980’s, the ﬁeld of spatial statistics has expanded into almost every
area of applied research. Researchers use spatial models to analyze global temperatures,
determine pubic health and safety, and investigate patterns in the brain. Much
research has been done in Euclidean spaces (e.g., Cressie 1993; Stein 1999; Chil´es
and Delﬁner 2012), but processes on the spherical domain have gained more
attention recently (e.g., Huang et al. 2011; Gneiting 2013; Porcu et al. 2016).
Choosing spherical models is naturally important when modeling processes
on the earth. Using models developed in Euclidean space is appropriate on small
scales where the curvature of the earth does not largely impact the process (Jeong
and Jun 2015). However, if these models are used on the whole sphere, models
should be designed with the spherical geometry in mind, and great circle distances
should be used instead of Euclidean distances (Huang et al. 2011).
In addition to using spherical models, many models also assume homogeneous
or intrinsically homogeneous processes, which is often deemed unrealistic in practice.
Several approaches have been proposed to relax this assumption such as axial
symmetry (Jones 1963; Stein 2007; Huang et al. 2012) and kernel convolution
(Zhu and Wu 2010; Heaton et al. 2014). Huang et al. (2019) extend the notion of
intrinsic random functions (IRF) (Matheron 1973) to the spherical domain, where
monomials in Euclidean spaces annihilated by the allowable measure are replaced
by spherical harmonics on the sphere. The theoretical properties of IRFs on the
sphere are developed, and the connection with the reproducing kernel Hilbert
space is discussed. In particular, Huang et al. (2019) show that an IRF on the
sphere is characterized by its frequency-truncated process.
Based on this theoretical development, this paper provides a method for estimating
the degree of non-homogeneity. Theorem 1 in Huang et al. (2019) shows that a
random process on the sphere is IRFκ if and only if its low-frequency truncated
process is homogeneous. Based on this ﬁndings, a graphical tool for estimating
κ, which is the degree of non-homogeneity on the sphere, is developed in Sect. 2.
Once the degree of non-homogeneity is estimated, it is fairly straightforward
to carry out universal kriging. The procedure for universal kriging is presented
in Sect. 3. Note that Matheron (1973) discussed universal kriging based on the
intrinsic random functions, where various order of monomials can be modeled
while their coefﬁcients do not need to be estimated in the kriging formula. For
example, ordinary kriging is to assume intrinsic stationarity with a constant mean
function, and such constant does not play a role in variogram-based kriging formula.
Higher order kriging beyond ordinary kriging is less common in practice. To the
2

authors best knowledge, a method for estimating the degree of non-stationarity
in Euclidean spaces has yet to be developed. However, on the sphere, the degree
of non-homogeneity of an IRF can be estimated. This paves a way for a truly
universal kriging as Matheron envisioned in 1973.
Then, in Sect. 4, results from simulation studies are presented to show IRF-based
universal kriging can be applied, including the estimate of the degree of non-homogeneity.
Universal kriging is presented in comparison to ordinary kriging and is shown to
be advantageous when the underlying data are not intrinsically homogeneous.
2
Degree of Non-Homogeneity Estimation
Huang et al. (2019) introduced the notion of IRF on the sphere and revealed the
unique theoretical properties of the IRF on the sphere. In particular, a real-valued
continuous (in quadratic mean) random function Z(x),x ∈S2 is an IRF if and only
if its low frequency-truncated process Zκ(x) is homogenous. Here,
Z(x) =
∞
∑
l=0
l
∑
m=−l
Zl,mY m
l (x),
and
Zκ(x) =
∞
∑
l=κ
l
∑
m=−l
Zl,mY m
l (x),
where the real-valued spherical harmonic functions are









Y m
l (x) =
q
2l+1
2π
(l−m)!
(l+m)!Pm
l (cosζ)cos(mψ),
m = 1,...,l,
Y 0
l (x) =
q
2l+1
4π P0
l (cosζ),
Y −m
l
(x) =
q
2l+1
2π
(l−m)!
(l+m)!Pm
l (cosζ)sin(mψ),
m = 1,...,l,
Pm
l (·) are the associated Legendre polynomials, P0
l (·) ≡Pl(·) are the Legendre
polynomials, and x = (ψ,ζ) with longitude ψ ∈[0,2π) and the latitude ζ ∈[0,π].
The coefﬁcients Zl,m are random variables
Zl,m =
Z
S2 Z(x)Y m
l (x)dx.
Then, for this homogenous process Zκ(·), the coefﬁcients are uncorrelated
(Obukhov 1947)
cov(Zl,m,Zl′,m′) = alI(l,l′)I(m,m′),
3

where l,l′ ≥κ,|m|,|m′| ≤l and al ≥0. Using this form, the associated covariance
function of the process Zκ(·) is then
φκ(d(x,y)) = cov(Zκ(x),Zκ(y)) =
∞
∑
l=κ
2l +1
4π
alPl(cos(d(x,y))),
where d(x,y) is the spherical distance between x,y ∈S2. This function plays the
important role of the generalized covariance for IRF theory (Matheron 1973), and
is termed as the intrinsic covariance function (ICF) in this manuscript.
To model processes as IRFκ, both κ and φκ must be estimated. Based on
Theorem 1 in Huang et al. (2019), the low frequency-truncated process Zκ(x) is
homogeneous. Therefore, the further truncated process Zκ+1(x) is also homogenous
with
φκ+1(d(x,y)) =
∞
∑
l=κ+1
2l +1
4π
alPl(cos(d(x,y))).
The difference of these two ICFs is
φκ(d(x,y))−φκ+1(d(x,y)) = 2κ +1
4π
aκPκ(cos(d(x,y))).
This remains true for any additional truncation. In general,
φj(d(x,y))−φ j+1(d(x,y)) = 2 j +1
4π
a jPj(cos(d(x,y))),
j = κ,κ +1,....
Because a j is a constant, then
φj(d(x,y))−φ j+1(d(x,y)) ∝Pj(cos(d(x,y))),
j ≥κ.
Based on this discussion, for any spatial lag h0 = 0 < h1 < ... < hm ≤π,

φ j(hi)−φj+1(hi)−2 j +1
4π
ajPj(coshi)

= 0,
j = κ,κ +1,...,
i = 0,1,...,m.
Therefore, if the estimates
n
ˆφ j(hi)
oi=0,1,...,m
j=κ,κ+1,... could be obtained, one would expect
that
m
∑
i=1

ˆφj(hi)−ˆφ j+1(hi)−2 j +1
4π
a jPj(coshi)
2
(1)
4

to be small and remain small for all j ≥κ.
To ﬁnd ˆφ j(·), a method of moment estimator can be constructed. The full
spatial process Z(x) can be expanded as
Z(x) = ∑
l<j
l
∑
m=−l
Zl,mY m
l (x)+Zj(x),
where Zj(x) is the j-truncated process. When an IRFκ Z(x) is observed, the
low-frequency truncated process can be approximated by the residual process
Zj,r(x) of Z(x) regressed on {Y m
l (·)}l<j. When j ≥κ, Zj(x) is homogenous with
ICF φ j(·). Therefore, a direct method of moment estimator is
ˆφ j(hi) =
1
|Nhi|
∑
(x,y)∈Nhi
Zj,r(x)Zj,r(y),
where Nhi is the set of all pairs (x,y) such that d(x,y) = hi and |Nhi| is the cardinality
of this set. For h0,h1,...,hm, this estimate for ˆφ j(·) satisﬁes Eq. (1) such that
Eq. (1) shall be small and remain small for all j ≥κ.
Note that the summation in Eq. (1) requires an estimate for aj. This is readily
available in ˆφ j(·) by solving
φ j(0)−φ j+1(0) = 2 j +1
4π
aj,
j ≥κ.
This is because the Legendre polynomial Pj(cos(0)) = 1 for d(x,y) = 0. An
estimate for a j could then be derived as
ˆa j =
4π
2 j +1( ˆφj(0)−ˆφj+1(0)).
Combining this with Eq. (1) yields the form
m
∑
i=1
  ˆφj(hi)−ˆφ j+1(hi)−{ ˆφ j(0)−ˆφj+1(0)}Pj(cos(hi))
2
(2)
Using Eq. (2), a criterion for estimating κ can be established. It is ﬁrst important
to recognize that, for j < κ (i.e., prior to the removal of the spherical harmonics of
order less than κ), the residual processes are non-homogeneous. In fact, they are
governed by a reproducing kernel, which includes the ICF and other terms based
on choices of arbitrary chosen points on the sphere (Huang et al. 2019). Thus,
5

when j < κ, the notation ˆφ(·) is not appropriate. A new notation G(·) can be
deﬁned as
G(j,hi) =
1
|Nhi|
∑
(x,y)∈Nhi
Zj,r(x)Zj,r(h).
(3)
When j < κ, G(j,hi) is meaningless, and
M (j) =
m
∑
i=1
 G(j,hi)−G(j +1,hi)−{G(j,0)−G(j +1,0)}Pj(cos(hi))
2 (4)
can be completely arbitrary. However, when j ≥κ,
G(j,hi) = ˆφ j(hi)
(i.e., G(j,hi) is an estimator for the ICF), and then M (j) shall be small and remain
small.
The criterion M (·) can thus be used to construct a graphical procedure for
estimating the degree of non-homogeneity, κ. Based on the previous discussion
of M (j) in Eq. (4), it is clear that plotting M (j) against j should provide an
estimate for κ. The estimate for κ will be the order j when M (j) becomes and
remains small. However, it can take arbitrary values before j reaches the right
order. For example, Figures 1 and 2 shows the results from a simulated IRFκ,
where κ = 2 and 3. (Details of the simulation setup is in Sect. 4. Note: the log
of M (j) was taken in the graphs.) In the IRF2 plot, M (j) is small for all j ≥2,
and is bigger in magnitude for j = 0,1. Thus, the estimate for κ would clearly be
ˆκ = 2. The same pattern appears in the second plot, where an IRF3 is observed.
3
Universal Kriging
Kriging is the most commonly used prediction method in spatial statistics. Matheron
(1973) developed the universal kriging through the IRF theory in Euclidean spaces.
This approach is extended to the sphere in Huang et al. (2019). With the degree of
non-homogeneity estimated in Sect. 2, a practical universal kriging procedure can
be developed. Following Huang et al. (2019), ﬁrst assume that data {(xi,wi),i =
1,...,n} is observed from an IRFκ process Z(x), where
wi = Z(xi)+εi,
6

G
G
G
G
G
G
G
0
1
2
3
4
5
6
−10
−5
0
5
j
log(M(j))
Figure 1: Criterion plot of log(M (j)) vs. varying values of j for a simulated
IRF2 process.
G
G
G
G
G
G
G
0
1
2
3
4
5
6
−10
−5
0
5
10
15
j
log(M(j))
Figure 2: Criterion plot of log(M (j)) vs. varying values of j for a simulated
IRF3 process.
7

Algorithm 1. Universal kriging procedure
1.
Estimate the order of non-homogeneity, ˆκ.
2.
Estimate the ICF, ˆφκ(·).
3.
Compute q,Q,Ψ,φ in Eq. (3).
4.
Obtain η to ﬁnd ˆZ(x0) = ηTw.
εi are uncorrelated measure errors with mean 0 and variance σ2, Z(x) is an IRFκ
process with an ICF φκ(·) and a mean function with unknown coefﬁcients βl,m
being E[Z(x)] = ∑l<κ ∑l
m=−l βl,mY m
l (x). Then, universal kriging at an unsampled
location x0 is ˆZ(x0) = ηTw, where w = (w1,...,wn)T and the coefﬁcients η =
(η1,...,ηn)T can be solved through

(Ψ+σ2I)η +Qρ = φ,
QTη = q,
where Ψ = {φκ(d(xi,xj))}i,j=1,...,n, φ = (φκ(d(x1,x0)),...,φκ(d(xn,x0)))T, ρ is
the Lagrange multiplier of length κ2, Q = {qν(xi)}i=1,...,n,ν=1,...,κ2}, q = (q1(x0),...,qκ2(x0))T.
Here, {qν(x),ν = 1,...,κ2} is a newly arranged lower spherical harmonics {Y m
l (x),l <
κ,|m| ≤l} for simplicity.
Combining this derivation with κ estimation presented in the previous section,
a practical universal kriging procedure can be formed (Algorithm 1).
In this
algorithm, a positive deﬁnite ICF needs to be estimated. To complete the universal
kriging algorithm, the weighted least square procedure for parametric modeling
is adopted (Cressie 1985). Let φκ(h,θ) be a parametric ICF of order κ, where h
is the lag and θ are the parameters. While generalized least squares or ordinary
least squares can be applied, Cressie (1985) proposed the weighted least squares
approach as a good compromise between statistical efﬁciency and computational
demands. That is, to ﬁnd the estimate, minimize
m
∑
i=0
|Nhi|
 G(κ,hi)
φκ(hi,θ) −1
2
,
where G(·,·) and |Nhi| can be found in Eq. 3. In Algorithm 1, κ is naturally
replaced by ˆκ.
8

4
Simulation Study Comparing Ordinary and Universal
Kriging on the Sphere
In the family of universal kriging, ordinary kriging may be the most commonly
used procedure in practice.
Ordinary kriging on the sphere assumes intrinsic
homogeneity (Huang et al. 2011), which is IRF with κ = 1 (i.e., IRF1). Thus, it
is prudent to investigate whether IRF universal kriging offers better predictions at
unobserved locations when the underlying process is not intrinsically homogeneous.
To simulate a Gaussian IRFκ on the sphere, we need its covariance function.
The covariance function can be derived utilizing the connection between IRF and
RKHS. First, denote nil space for the semi-inner product deﬁned in Huang et al.
(2019) as N, where dim(N) = κ2. Then, the associated reproducing kernel for the
covariance function can be written as (Huang et al. 2019).
Hκ(x,y) = φκ(d(x,y))−
κ2
∑
ν=1
{φκ(d(x,τν))pν(y)+φκ(d(y,τν))pν(x)}
+
κ2
∑
ν=1
κ2
∑
µ=1
φκ(d(τν,τµ))pν(x)pν(y)+
κ2
∑
ν=1
pν(x)pν(y),
(5)
where {τ1,...,τκ2} ∈S2 and p1(·),..., pκ2(·) ∈N such that pν(τµ) = I(ν,µ) for
1 ≤ν,µ ≤κ2. This is clearly a non-homogeneous covariance function.
For the simulation studies in this research, the ICFs are simple parametric
functions, where we set al = rl,0 ≤r < 1, so that
φκ(h) =
∞
∑
l=κ
2l +1
4π
rlPl(cosh).
This is the truncated version of a well-known model
∞
∑
l=0
2l +1
4π
rlPl(cos) = 1−r2
4π
(1−2rcos(h)+r2)−3/2.
Other parametric models could have be used. In this study, we use this “simple”
parametric function to demonstrate our κ estimation and universal kriging methods.
Using this parametric model, IRF processes with κ = 2 and 3 were simulated
on 1,500 randomly selected locations on the sphere. The ICFs were both generated
with a parameter r = 0.75. To simulate the full covariance structure, the arbitrary
9

−150
−100
−50
0
50
100
150
−50
0
50
−6
−4
−2
0
2
4
6
Figure 3: Heat map of an IRF2 simulated processes. The arbitrary locations τ
necessary for the simulation are plotted as white triangles.
locations τ from Eq. (5) need to chosen. For the IRF2 simulations, the κ2 = 4
locations were (π/9,π/3),(π/3,5π/6), (2π/3,6π/5), and (8π/9,5π/3). For the
IRF3 simulations, the κ2 = 9 locations were (π/12,π/6), (π/9,π/3),(π/6,2π/3),
(π/3,5π/6),(π/2,π), (2π/3,6π/5),(5π/6,3π/2), (8π/9,5π/3), and (11π/12,9π/5).
Figures 3 and 4 display the simulated data for IRF2 and IRF3, respectively, with
the locations τ shown as white triangles.
The simulated datasets were split into training and testing subsets so that
ordinary kriging and universal kriging predictions could be compared against
known values. For both the IRF2 and IRF3 simulations, 90% of the data were
randomly selected 90% of the data to be the training dataset, and the other 10%
was used as the testing dataset. For the training data, both κ and the ICF were
estimated. Those values were then used to make predictions at the “unobserved”
testing locations with kriging.
For IRF universal kriging, the degree of non-homogeneity κ must ﬁrst be
estimated. Using the graphical procedure for both the IRF2 and IRF3 training
data subsets, the estimates of ˆκ = 2 and 3 were chosen (Figs. 5 and 6, respectively.
Note that Fig. 1 and Fig. 5 are very similar, but Fig. 5 was generated with 90%
of the data whereas Fig. 1 was created with all of the data. A similar comparison
is true for Figs. 2 and 6). For example, in the IRF3 plot, the M (j) values are
10

−150
−100
−50
0
50
100
150
−50
0
50
−100
−50
0
50
100
Figure 4: Heat map of an IRF2 simulated processes. The arbitrary locations τ
necessary for the simulation are plotted as white triangles.
large for j = 0,1, and 2, but the values decrease and become relatively stable at
j ≥3. This is clearly an indication that the process is neither IRF0, IRF1, or IRF2,
and is likely IRF3. Note that in this simulation, the maximum degree j was set at
7. This number can be extended to an arbitrarily larger number. As a maximum
value must be chosen for computational purposes, the implied assumption is that
the underlying process is an IRF, but κ does not exceed the chosen value.
For ordinary kriging, the degree of non-homogeneity is not estimated. The
assumption is an intrinsically homogeneous process, which implies that ˆκ = 1.
Thus, for this study, ˆκ was set to 1 for ordinary kriging.
For both ordinary kriging and universal kriging, the weighted least squares
approach was used to estimate the parameter r, which in turn allows for the
estimation of the ICF. For these simulations, σ2 was assumed to be 0 to focus on
the difference between ordinary kriging and universal kriging in simpler setting.
Perhaps unsurprisingly, the estimates of r were closer to the true value of 0.75
when the degree of non-homogeneity was estimated instead of assumed to be 1
(Table 1). The IRF approach had estimates of ˆr = 0.717 and 0.707 for IRF2
and IRF3, respectively, where the ordinary kriging estimates were ˆr = 0.888 and
0.992.
With the estimates of κ and r, predictions were made for the 10% “unobserved”
11

G
G
G
G
G
G
G
0
1
2
3
4
5
6
−10
−5
0
5
j
log(M(j))
Figure 5: Criterion plot of log(M (j)) for the simulated IRF2 process used in the
kriging simulation study. The plot was generated with the training dataset, which
consisted of a randomly selected 90% of the full dataset.
G
G
G
G
G
G
G
0
1
2
3
4
5
6
−10
−5
0
5
10
15
j
log(M(j))
Figure 6: Criterion plot of log(M (j)) for the simulated IRF3 process used in the
kriging simulation study. The plot was generated with the training dataset, which
consisted of a randomly selected 90% of the full dataset.
12

Table 1: Estimates for κ and r under ordinary kriging (OK) and IRF universal
kriging (UK) using the training data subset. “True κ” represents the order from
which the data were simulated.
The ˆr was determined using weighted least
squares.
The root-mean squared error (RMSE) was calculated by comparing
predictions to the “unobserved” testing subset values.
True κ
Method
ˆκ
ˆr
RMSE
2
UK
2
0.717
0.07
2
OK
1
0.888
10.71
3
UK
3
0.707
0.07
3
OK
1
0.992
47.19
locations corresponding to our testing dataset. The actual values in the testing
dataset were compared against the predictions by calculating the root mean square
error (RMSE). The RMSE between the universal kriging values and the actual
values was only 0.07 for both IRF2 and IRF3, respectively (Table 1). However,
the ordinary kriging RMSE was approximately 11 and 47, respectively, showing
a marked decrease in predictive capability when ˆκ is incorrect. Naturally, the
farther an IRFκ process is from IRF1, the ability of ordinary kriging to make
accurate predictions would be lower.
5
Declarations
The authors do not have any conﬂicts of interests. There was no funding for this
research.
All code is available upon request.
For the author contributions, Drs. Shields and Huang led the development of
the graphical estimation procedure. Drs. Bussberg and Huang led the development
of the universal kriging procedure and associated simulation studies. Dr. Bussberg
led the manuscript development.
References
Chil´es, J.-P. and Delﬁner, P. (2012). Geostatistics: Modeling Spatial Uncertainty.
John Wiley & Sons, Hoboken, NJ, 2nd edition.
13

Cressie, N. (1985). Fitting variogram models by weighted least squares. Journal
of the international Association for mathematical Geology, 17(5):563–586.
Cressie, N. A. (1993). Statistics for Spatial Data. John Wiley & Sons, New York,
NY.
Gneiting, T. (2013).
Strictly and non-strictly positive deﬁnite functions on
spheres. Bernoulli, 19(4):1327–1349.
Heaton, M., Katzfuss, M., Berrett, C., and Nychka, D. (2014).
Constructing
valid spatial processes on the sphere using kernel convolutions. Environmetrics,
25(1):2–15.
Huang, C., Zhang, H., and Robeson, S. M. (2011). On the validity of commonly
used covariance and variogram functions on the sphere.
Mathematical
Geosciences, 43(6):721–733.
Huang, C., Zhang, H., and Robeson, S. M. (2012). A simpliﬁed representation of
the covariance structure of axially symmetric processes on the sphere. Statistics
& Probability Letters, 82(7):1346–1351.
Huang, C., Zhang, H., Robeson, S. M., and Shields, J. (2019). Intrinsic random
functions on the sphere. Statistics & Probability Letters, 146:7–14.
Jeong, J. and Jun, M. (2015). Covariance models on the surface of a sphere: when
does it matter? Stat, 4(1):167–182.
Jones, R. H. (1963). Stochastic processes on a sphere. The Annals of mathematical
statistics, 34(1):213–218.
Matheron, G. (1973).
The intrinsic random functions and their applications.
Advances in applied probability, 5(3):439–468.
Obukhov, A. (1947). Statistically homogeneous ﬁelds on a sphere. Usp. Mat.
Nauk, 2(2):196–198.
Porcu, E., Bevilacqua, M., and Genton, M. G. (2016). Spatio-temporal covariance
and cross-covariance functions of the great circle distance on a sphere. Journal
of the American Statistical Association, 111(514):888–898.
Stein, M. L. (1999). Interpolation of Spatial Data: Some Theory for Kriging.
Springer, New York.
14

Stein, M. L. (2007). Spatial variation of total column ozone on a global scale. The
Annals of Applied Statistics, 1(1):191–210.
Zhu, Z. and Wu, Y. (2010). An efﬁcient algorithm for estimation and prediction
of a class of convolution based spatial nonstationary models.
Journal of
Computational and Graphical Statistics, 19:74–95.
15
