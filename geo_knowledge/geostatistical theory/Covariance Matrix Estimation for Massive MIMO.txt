arXiv:1802.01513v2  [cs.IT]  7 Mar 2018
1
Covariance Matrix Estimation for Massive MIMO
Karthik Upadhya, Student Member, IEEE, Sergiy A. Vorobyov, Fellow, IEEE
Abstract—We propose a novel pilot structure for covariance
matrix estimation in massive multiple-input multiple-output
(MIMO) systems in which each user transmits two pilot se-
quences, with the second pilot sequence multiplied by a random
phase-shift. The covariance matrix of a particular user is ob-
tained by computing the sample cross-correlation of the channel
estimates obtained from the two pilot sequences. This approach
relaxes the requirement that all the users transmit their uplink
pilots over the same set of symbols. We derive expressions for
the achievable rate and the mean-squared error of the covariance
matrix estimate when the proposed method is used with staggered
pilots. The performance of the proposed method is compared with
existing methods through simulations.
Index Terms—Massive MIMO, pilot contamination, staggered
pilots, covariance estimation.
I. INTRODUCTION
Massive multiple-input multiple-output (MIMO) is a varia-
tion of multi-user MIMO (MU-MIMO) that has a large number
of antennas at the base station (BS), which signiﬁcantly
improves the spectral efﬁciency through spatial multiplexing
[1]–[4] at a low cost of simple linear processing at the BS [1],
[5], [6]. However, in practice, the BS needs to obtain channel
state information (CSI) using pilots which have to be reused in
different cells, thereby causing pilot contamination [1]. It has
been argued that pilot contamination, in independent and iden-
tically distributed (i.i.d) Rayleigh fading, puts a fundamental
limit on the asymptotically achievable rate in massive MIMO
systems [1], and pilot decontamination algorithms have been
designed in many works (see [7]–[12] to mention just a few).
It has been recently shown in [13] that the ceiling on the
UL and DL rates due to pilot contamination can be eliminated
under certain loose conditions on the covariance matrices of
the users. However, this method requires estimates of the
covariance matrix at the BS, which have to be obtained from
observations that are made in the presence of pilot contamina-
tion. In [14], two methods have been developed wherein the
users are assigned unique pilots speciﬁcally for estimating the
covariance matrices. In [15], a method for jointly performing
pilot allocation and estimating the covariance matrix has been
proposed. A method for estimating a low-rank covariance
matrix has also been proposed in [16]. A common theme in
all the earlier works is that they require/assume that the users
in all cells transmit their UL pilots simultaneously, which can
be infeasible in practice.
In this letter, we develop a method for estimating the users’
covariance matrices using a pair of pilot sequences, with the
K. Upadhya and S. A. Vorobyov are with the Department of Signal
Processing and Acoustics, Aalto University, Espoo - 02150, Finland. (E-mails:
karthik.upadhya@aalto.ﬁ, svor@ieee.org).
This work was supported in part by the Academy of Finland research grant
No. 299243.
Corresponding Author: Sergiy A. Vorobyov.
second pilot sequence multiplied by a random phase-shift.
The quality of the covariance estimate obtained through the
proposed method using staggered pilots is quantiﬁed using
expressions for its mean-squared error (MSE). The achievable
rate is analyzed numerically when the covariance matrices are
estimated and used with staggered and regular pilots.
Notation: A vector is denoted as a and a matrix as A. The
notations (·)T , (·)∗, (·)H, (·)−1, blkdiag {·}, trace (·), ⌊x⌋
represent the transpose, conjugate, conjugate transpose, matrix
inverse, block diagonal matrix, matrix trace, and largest integer
smaller than x, respectively, while CN(µ, Σ) stands for the
complex Gaussian distribution with mean µ and covariance
matrix Σ.
II. SYSTEM MODEL AND PROBLEM DESCRIPTION
We consider a massive MU-MIMO system with L cells
each having M antennas at the BS and containing K users.
Denoting a user u in cell c as (c, u), the channel vector
between user (c, u) and BS j is represented as hjcu ∈CM and
is distributed as CN (0, Rjcu). The channel is assumed to be
constant for C symbols and the second-order statistics Rjcu
are assumed to be constant for τs blocks each containing C
symbols. The coherence time of the channel is divided into Cu
and Cd symbols for the UL and DL time-slots, respectively.
In [13] and [17], it was shown that the UL and DL rates
increase asymptotically in M when the data is estimated using
a linear minimum mean-squared error (LMMSE) or zero-
forcing (ZF) precoder/combiner that is designed using the
LMMSE channel estimate. If bhjcu is the least-square (LS)
estimate of the channel, the channel estimate obtained using
the LMMSE criterion can be written as
bhLMMSE
jcu
= E

hjcuhH
jcu
	
E
n
bhjjubhH
jju
o−1 bhjju
= RjcuQ−1
ju bhjju
(1)
where Qju ≜E
n
bhjjubhH
jju
o
and Rjcu ≜E

hjcuhH
jcu
	
.
Utilizing (1), the corresponding multi-cell LMMSE com-
bining vector is
vju =
 L−1
X
ℓ=0
K−1
X
k=0
bhLMMSE
jℓk

bhLMMSE
jℓk
H
+Zj
!−1
bhLMMSE
jju
(2)
where Zj ≜
L−1
P
ℓ=0
K−1
P
k=0

Rjℓk −RjℓkQ−1
jk Rjℓk

+σ2IM. From
(1) and (2), it can be observed that obtaining the LMMSE
estimate of the channel and data requires the covariance
matrices Rjℓk, ∀ℓ, k and Qjk, ∀k. In practice, Rjℓk has
to be estimated in the presence of pilot contamination, which
complicates the estimation problem since the estimate bRjℓk is
contaminated by the covariance matrices of users in adjacent
cells that employ the same pilot.

2
Existing methods for covariance matrix estimation employ
regular pilots for both channel and covariance matrix estima-
tion wherein the channel and covariance matrix estimates are
obtained by dedicating a part of the time-frequency resource
for pilot transmission. Under the assumption that the pilot
transmission from all the cells are synchronized1 and that
every cell transmits the same pilots, the received observations
at BS j during pilot transmission in the nth coherence block
can be written as
Y(n)
j
=
L−1
X
ℓ=0
K−1
X
k=0
√µh(n)
jℓkφT
k + W(n)
j
(3)
where Y(n)
j
∈CM×τ are the received observations, φk ∈Cτ
is the pilot sequence transmitted by user k, µ is the uplink
transmit power, and W(n)
j
∈CM×τ is the additive noise at
the BS with each element i.i.d as CN(0, σ2). Assuming that
the pilots φk are taken from the columns of a scaled unitary
matrix Φ ∈Cτ×τ with ΦHΦ = τIτ, the LS estimate of the
channel can be obtained as
bh(n)
jcu=
1
τ√µY(n)
j
φ∗
u = h(n)
jcu +
X
ℓ̸=j
h(n)
jℓu +
W(n)
j
φ∗
m
τ√µ
.
(4)
Since Qju = E
n
bhjjubhH
jju
o
, its estimate can be obtained from
the sample mean of bh(n)
jju over NQ coherence blocks as
bQju =
1
NQ
NQ−1
X
n=0
bh(n)
jju

bh(n)
jju
H
.
(5)
However, as mentioned earlier, estimating individual co-
variance matrices Rjℓk,
∀ℓ, k is challenging, since chan-
nel observations are made in the presence of pilot con-
tamination. In [14], Rjℓk is estimated indirectly through
Qjℓ,−k ≜Qjk −Rjℓk which is the sum covariance matrix of
the channels of all the interfering users using the same pilot as
user (ℓ, k). bQjℓ,−k is estimated separately using NR unique
orthogonal pilots for each k and then subtracted from bQjk to
obtain bRjℓk, i.e.,
bRjℓk = bQjk −bQjℓ,−k .
(6)
When M is larger than NQ and NR, the resulting estimates
of bRjℓk and bQjk have to be regularized in order to ensure
full-rank and positive (semi-)deﬁniteness [14]. For a massive
MIMO system with L cells and K users per cell, estimating
both Rjℓk, ∀ℓ, k and Qjk using this approach would require
LKNR + KNQ UL training symbols. In addition, utilizing
unique pilots for estimating bQjℓ,−k implicitly assumes and
requires that the users in all the L cells transmit UL pilots
simultaneously. While such an assumption is common in mas-
sive MIMO literature, it may not be practically feasible since
it requires that the BSs coordinate the UL pilot transmissions
of their users.
1Pilots which are transmitted simultaneously by the users in all cells are
henceforth referred to as regular pilots.
III. PROPOSED PILOT STRUCTURE AND METHOD FOR
ESTIMATING COVARIANCE MATRICES
In the proposed approach, we assume that the L cells are
divided into T subsets with the tth subset containing Lt
contiguous cells. Here Lt is chosen such that 1 ≤Lt ≤
⌊Cu/2K⌋. The Lt cells within each of the T subsets are
assumed to be able to coordinate their UL pilot transmissions,
whereas the cells in two different subsets transmit pilot and
data asynchronously. Let M : {1, . . . , L} →{1, . . . , T } be
the mapping between a cell and its corresponding subset, and
let t = Mℓ.
User (ℓ, k) transmits the symbol vector s(n)
ℓk ≜ρx(n)
ℓk +λp(n)
ℓk
in the UL in the nth coherence block, where p(n)
ℓk ∈CCu is the
UL pilot, x(n)
ℓk ∈CCu is the UL data, and ρ2 and λ2 are the
fractions of power with which data and pilots are transmitted,
respectively. Then, we assume that the pilot sequence p(n)
ℓk is
comprised of two subsequences and can be written as
p(n)
ℓk ≜

pT
ℓk, ejθt,npT
ℓk
T
(7)
where {θt,n}N
n=1 are N realizations of a random variable Θt.
The random variable Θt is assumed to be independent of the
channel and data vectors and distributed such that {Θt}T
t=1
are mutually independent and E

ejΘt
= 0, ∀t. In addition,
we also assume that θt,n, ∀t, n are known to all the L BSs,
and that the subsequence pℓk is chosen from the columns of
a scaled unitary matrix P, where P is such that PHP =
KICu/2. Also, since Cu ≥2LtK, each user in the Lt cells
from subset t can be assigned a unique pilot pℓk. It has to be
noted that the symbol vector s(n)
ℓk can either contain regular2,
staggered, or superimposed pilots depending on the contents
of pℓk and x(n)
ℓk . With staggered pilots, the users in different
cells stagger their UL pilot transmissions [18], [19], and with
superimposed pilots, the users transmit UL pilots alongside
data [11].
Let Y(n,p)
j
∈CM×Cu/2 for p = 1, 2 be the received
observations at BS j when the ﬁrst and second pilot sub-
sequences are transmitted in the nth coherence block. Then,
Y(n,p)
j
, ∀p = 1, 2 can be written as
Y(n,p)
j
=
L−1
X
ℓ=0
K−1
X
k=0
√µhjℓk

s(n,p)
ℓk
T
+ W(n,p)
j
(8)
where s(n,p)
ℓk
and W(n,p)
j
are the transmitted symbols and
additive noise at the BS during the transmission of the pth
pilot subsequence.
Dropping the index n, for an arbitrary user u in cell
c at BS j, consider the cross correlation between the LS
estimates of the channel obtained from the ﬁrst and second
pilot subsequences, that is,
Rj,bh(1)
cu bh(2)
cu ≜E
hn
Y(1)
j
 λ2pT
cup∗
cu
−1 λp∗
cu
o
×
n
Y(2)
j
 λ2pT
cup∗
cu
−1 λe−jΘMcp∗
cu
oH
. (9)
2Note that with regular pilots, users in all the L cells transmit pilots
simultaneously and the condition Cu ≥2LtK does not apply.

3
Substituting (8) and the deﬁnition of scu into (9), we obtain
Rj,bh(1)
cu bh(2)
cu = E
hn
hjcu + α(1)
cu + ǫ(1)
cu + w(1)
j
o
×
n
hjcu
+e−jΘMcα(2)
cu+e−jΘMcǫ(2)
cu +e−jΘMcw(2)
j
oH
= Rjcu
(10)
where, for p = 1, 2, we have
α(p)
cu ≜
ρ
Kλ
X
ℓ∈Tc
K−1
X
k=0
hjℓk

x(p)
ℓk
T
p∗
cu
(11)
ǫ(p)
cu ≜
1
Kλ
X
ℓ∈T\c
K−1
X
k=0
hjℓk

z(p)
ℓk
T
p∗
cu
(12)
w(p)
j
≜W(p)
j p∗
cu/ (Kλ√µ) .
(13)
Here Tc = {ℓ| Mℓ= Mc} is the set of cells that are in
the same subset as cell c and T\c is its complement, zℓk
is the vector of symbols (either pilots or data) transmitted
asynchronously by a user3 in T\c. In (10), ejΘMc decorrelates
the channel estimation errors resulting from the transmis-
sions from the users in T\c, which in turn causes the cross-
correlation of the channel estimates to become equal to Rjcu.
Using the result in (10), an estimate of Rjcu can be obtained
by the sample cross-correlation of both the channel estimates
averaged over N coherence blocks, i.e.,
bRjcu = 1
N
N
X
n=1
bh(n,1)
jcu

bh(n,2)
jcu
H
(14)
where
bh(n,1)
jcu
= Y(n,1)
j
 λ2pT
cup∗
cu
−1 λp∗
cu
(15)
bh(n,2)
jcu
= Y(n,2)
j
 λ2pT
cup∗
cu
−1 λe−jθMc,np∗
cu .
(16)
It
is
straightforward
to
show
that
the
sample
cross-
correlation converges in probability to the true correlation, i.e.,
bRjcu
P
−−−−→
N→∞Rjcu .
However, for a ﬁnite N, the estimate bRjcu is not necessarily
Hermitian symmetric. Therefore, this matrix can be regularized
by approximating it with a positive semi-deﬁnite matrix. Thus,
we approximate bRjcu with the positive semideﬁnite matrix
closest in Frobenius norm, which can be easily shown to
be bRPSD
jcu
≜UD+UH where D+ is a diagonal matrix that
contains only the positive eigenvalues of the symmetric part
of bRjcu, i.e., bRsym
jcu ≜

bRjcu + bRH
jcu

/2, and U contains the
corresponding eigenvectors.
In order to estimate the channel covariance matrix of a user
(c, u) at an arbitrary BS j, the BS requires only the knowledge
of {θMc,n}N
n=1 and the symbol and subcarrier indices in which
user (c, u) transmits its UL pilots. As a result, unlike in [14]
and [15], the proposed method does not require that all the
users transmit pilots simultaneously4. In fact, as will be shown
in Section V, the proposed method performs well even when
Lt = 1, ∀t, i.e., when none of the BSs coordinate the UL
pilot/data transmissions of their users.
3If a cell in T\c is transmitting in the DL, each BS antenna is treated as a
user.
4The proposed method does not require the users in different cells to
transmit UL pilots over the same set of UL symbols. However, note that
we are still assuming symbol-level synchronization over all the cells.
IV. ESTIMATING COVARIANCE MATRICES USING
STAGGERED PILOTS
The proposed method in Section III can be employed with
either regular, superimposed, or staggered pilots. However, we
will restrict our attention in this section to staggered pilots
since it is a particular case of superimposed pilots and provides
an additional degree of freedom by allowing the pilot and data
powers to be varied [18]–[20]. The estimated channel will be
used in a regularized zero-forcing (RZF) combiner for data
detection, which is given as
vcu =
 
σ2
µ I +
K−1
X
k=0
bhLMMSE
cck

bhLMMSE
cck
H
!−1
bhLMMSE
ccu
. (17)
For covariance matrix estimation using staggered or regular
pilots, each user transmits two K length pilot sequences
within a coherence block, with the second pilot sequence
multiplied by a random phase-shift. For each pilot sequence,
P = blkdiag {Φ, . . . , Φ} where Φ ∈CK×K. A lower bound
on the capacity for user (0, u) can be obtained as
R ≜η1Ψ
su
¯iu

+ η2Ψ
su
˜iu

(18)
where Ψ (x) ≜log2 (1 + x), and
η1 ≜(L −1) K
Cuτs
(τs + N) ; η2 ≜

1−LK
Cu
−NLK
Cuτs

(19)
su ≜ρ2|E

vH
0uh00u
	
|2
(20)
¯iu ≜
L−1
X
ℓ=0
K−1
X
k=0
θℓE

|vH
0uh0ℓk|2	
−ρ2|E

vH
0uh00u
	
|2
+ σ2
µ E

∥v0u∥2	
+
 λ2 −ρ2
(|T0| −1)
X
T0∋c̸=0
K−1
X
k=0
E
nvH
0uh0ck
2o
(21)
˜iu ≜
L−1
X
ℓ=0
K−1
X
k=0
θℓE

|vH
0uh0ℓk|2	
+ σ2
µ E

∥v0u∥2	
−ρ2|E

vH
0uh00u
	
|2 .
(22)
Here θℓ≜
 ρ21{ℓ∈T0} + max

ρ2, λ2	
1{ℓ/∈T0}

. The deriva-
tion of (18) is detailed in Appendix A. Deﬁning Ejcu ≜
Rjcu −bRjcu, the MSE expressions of the covariance matrix
estimates can be obtained in a straightforward manner as
E

∥Ejcu∥2
F
	
= 1
N
M−1
X
r=0
M−1
X
s=0
(grgs + frs)
(23)
where
frs ≜
X
Tc∋ℓ̸=c
K−1
X
k=0
ρ4
K2λ4 | [Rℓk]rs |2 +

1
Kλ2
X
ℓ∈T\c
K−1
X
k=0
[Rℓk]rs

2
(24)
gr ≜[Rcu]rr +
X
Tc∋ℓ̸=c
K−1
X
k=0
ρ2
Kλ2 | [Rℓk]rr |2
+
X
ℓ∈T\c
K−1
X
k=0
1
Kλ2 | [Rℓk]rr |2 +
σ2
Kλ2µ .
(25)

4
0
500
1,000
1,500
2,000
2,500
−14
−12
−10
−8
−6
−4
−2
0
N
Normalized MSE of the Channel Estimate (dB)
LS
Method in [14]
Proposed Method - Lt = 1
Proposed Method - Staggered Pilot
LMMSE
Fig. 1. Normalized MSE of channel estimate of an average user vs. N.
0
500
1,000
1,500
2,000
2,500
12
14
16
18
20
22
24
26
28
30
N
Avg. Sum Rate
LMMSE
Proposed Method - Staggered Pilot
Proposed Method - Lt = 1
Method in [14]
LS
Fig. 2. Achievable rate in the UL vs. N.
0
500
1,000
1,500
2,000
2,500
10
15
20
25
30
35
N
MSE of the Covariance Matrix Estimate (dB)
Method in [14]
Proposed Method - Lt = 1
Proposed Method - Staggered Pilot
Fig. 3. MSE of the estimated covariance matrix of an average user vs. N.
0
500
1,000
1,500
2,000
2,500
17
18
19
20
21
22
23
N
Avg. Sum Rate
LMMSE - Staggered Pilot
LMMSE - Regular Pilot
Proposed Method - Staggered Pilot
Method in [14]
LS
Fig. 4. Achievable rate in the UL vs. N.
V. SIMULATION RESULTS
We compare the normalized MSE of the channel estimate
and the achievable rate of the proposed method with that in
[14].5 Both the methods are simulated for one tier of L = 7
hexagonal cells with the BSs separated by 300m. The perfor-
mance of the methods are evaluated for the users in the central
cell. The SNR at the receiver is 78.6 −37.6 log10 d, where d
is the distance from the BS in metres. The channel statistics
are assumed to be constant over τs = 25000 coherence blocks.
The received paths from a user are assumed to be uniformly
distributed over an angular spread of 20◦, with mean angle of
arrival given by the geographical locations of the users. In all
the plots, the performance metrics are plotted against N. Then,
N = NQ ensures that the same number of coherence blocks
are utilized for estimating the covariance matrix for both the
proposed method and [14]. For the method in [14], NR is
chosen as NR = NQ/10. The normalized MSE is deﬁned
as E
n
∥bhLMMSE
jcu
−hjcu∥2/trace {Rjcu}
o
. For the proposed
method, ρ2 = λ2 = 1.
In Figs. 1, 2, and 3, the performance of the proposed method
is compared with that in [14]. In order to compare only
the covariance matrix estimates, the proposed method utilizes
staggered pilots for N coherence blocks and regular pilots for
the remaining τs −N blocks. Consequently, bQju is estimated
for the proposed method as bQju =
L−1
P
ℓ=0
bRjℓu + (σ2/Kµ)I.
Note that we have used the same simulation setup as in [14]
in which Cu = 100 symbols, each BS has M = 100 antennas
5The code that reproduces the results in this section is available at
https://github.com/karthikupadhya/covarianceEstimation-massiveMIMO.
and contains K = 10 users in its cell which are equispaced on
a circle of radius 120m from the BS. In addition, for staggered
pilots Lt is chosen as 7. For the sake of simplicity, Lt = 1 is
simulated using regular pilots, although the proposed method
would still work if the pilot and data transmissions of different
cells would overlap. From Fig. 3, it can be seen the MSE of
the covariance matrix is signiﬁcantly lower for the proposed
method. Consequently, in Figs. 1 and 2, the MSE and sum
rate performance of the proposed method is signiﬁcantly better
than the method in [14], despite not requiring all users to
transmit the pilots over the same set of symbols.
In Fig. 4, K = 5 users are uniformly distributed across the
entire cell. Each BS has M = 50 antennas and the UL time
slot has Cu = 100 symbols. With the LMMSE method, the
sum-rate with regular pilots is marginally higher than that for
staggered pilots. However, the proposed method offers a higher
throughput in comparison with the method in [14]. Note that
the pre-log factor contributes to the small difference between
the achievable rates of the LMMSE and estimated covariance
matrices.
VI. CONCLUSION
We proposed a novel pilot structure for estimating the
covariance matrix in the presence of pilot contamination,
which has the advantage of not requiring simultaneous UL
pilot transmissions. Using the proposed method along with
staggered pilots, we showed that the proposed method offers
a higher UL throughput and lower MSE than existing schemes.
The performance of the proposed method could be further
improved by optimizing ρ and λ, which we leave as a problem
for future research.

5
APPENDIX
A. Lower Bound on the Channel Capacity for Staggered Pilots
We consider an arbitrary cell with index 0 and with the
associated subset of cells T0. The UL symbols are indexed
from 1 to Cu and without loss of generality, we assume
that the symbols with index cK + 1 to (c + 1)K are used
for pilot transmission by the users in cell c ∈T0. We also
assume that the users in T\0 transmit their symbols with power
µ max

ρ2, λ2	
. This is a worst case scenario since it causes
the maximum interference to the users in cell 0. If 1 ≤t ≤K,
the received observation vector at BS 0 when users in cell
c ∈T0 are transmitting pilots can be written as
h
y(c)i
t =
K−1
X
k=0
√µρh00k
h
x(c)
0k
i
t+
X
T0∋ℓ̸=0
K−1
X
k=0
√µρh0ℓk
h
x(c)
ℓk
i
t
+
K−1
X
k=0
√µλh0ck

φT
ck

t+
X
ℓ/∈T0
K−1
X
k=0
√µ max {ρ, λ} h0ℓk
h
x(c)
ℓk
i
t
+
h
w(c)i
t
(26)
The output of the combiner v0u can be written as
vH
0u
h
y(c)i
t = √µρE

vH
0uh00u
	 h
x(c)
0u
i
t
+ √µρ
 vH
0uh00u −E

vH
0uh00u
	 h
x(c)
0u
i
t + e(c)
t
(27)
where
e(c)
t
≜
X
k̸=u
√µρvH
0uh00k
h
x(c)
0k
i
t +
K−1
X
k=0
√µλvH
0uh0ck

φT
ck

t
+
X
ℓ/∈T0
K−1
X
k=0
√µ max {ρ, λ} vH
0uh0ℓk
h
x(c)
ℓk
i
t
+
X
T0∋ℓ̸=0
K−1
X
k=0
√µρvH
0uh0ℓk
h
x(c)
ℓk
i
t + vH
0uw .
(28)
Noting in (27) that the ﬁrst term is uncorrelated with the
subsequent terms, the signal and interference powers can be
obtained as
su = µρ2|E

vH
0uh00u
	
|2
(29)
h
i(c)
u
i
t = µ
X
ℓ̸=c
K−1
X
k=0
θℓE

|vH
0uh0ℓk|2	
−µρ2|E

vH
0uh00u
	
|2
+ σ2E

∥v0u∥2	
+ µλ2E




K−1
X
k=0
vH
0uh0ck

φT
ck

t

2

(30)
Now, if Cu > L0K, there are Cu −L0K symbols in the
UL time-slot wherein none of the users in the L0 cells
are transmitting UL pilots. The interference power in these
symbols can be obtained in a straightforward manner as
˜iu = µ
L−1
X
ℓ=0
K−1
X
k=0
θℓE

|vH
0uh0ℓk|2	
−µρ2|E

vH
0uh00u
	
|2
+ σ2E

∥v0u∥2	
.
(31)
Therefore, a lower bound on the achievable rate can be
obtained as
SE0u =
N
Cuτs

X
T0∋c̸=0
2K
X
t=1
Ψ


su
h
i(c)
u
i
t

+ δ2KΨ
su
˜iu


+ (τs −N)
Cuτs

X
T0∋c̸=0
K
X
t=1
Ψ


su
h
i(c)
u
i
t

+ δKΨ
su
˜iu


(32)
where δx = max {Cu −L0x, 0}. The ﬁrst two terms corre-
spond to the throughput in the N coherence blocks in which
2K pilots are transmitted by each user for estimating the
covariance matrix and the last two terms correspond to the
remaining τs −N blocks where only K pilots are used for
estimating the channel. Since log2 (1 + 1/x) is convex in
x, using Jensen’s inequality a lower bound on (32) can be
obtained as
SE0u = η1Ψ
su
¯iu

+ η2Ψ
su
˜iu

(33)
where
¯iu =
1
2 (|T0| −1)
X
T0∋c̸=0
K
X
t=1
h
i(c)
u
i
t
(34)
= µ
L−1
X
ℓ=0
K−1
X
k=0
θℓE

|vH
0uh0ℓk|2	
−µρ2|E

vH
0uh00u
	
|2
+ σ2E

∥v0u∥2	
+ µ
 λ2 −ρ2
(|T0| −1)
X
T0∋c̸=0
K−1
X
k=0
E
nvH
0uh0ck
2o
(35)
η1 = (L −1) K
Cuτs
(τs + N)
(36)
η2 =

1 −LK
Cu
−NLK
Cuτs

.
(37)
REFERENCES
[1] T. Marzetta, “Noncooperative cellular wireless with unlimited numbers
of base station antennas,” IEEE Trans. Wireless Commun., vol. 9, no. 11,
pp. 3590–3600, Nov. 2010.
[2] E. Larsson, O. Edfors, F. Tufvesson, and T. Marzetta, “Massive MIMO
for next generation wireless systems,” IEEE Commun. Mag., vol. 52,
no. 2, pp. 186–195, Feb. 2014.
[3] L. Lu, G. Li, A. Swindlehurst, A. Ashikhmin, and R. Zhang, “An
overview of massive MIMO: Beneﬁts and challenges,” IEEE J. Sel.
Topics Signal Process., vol. 8, no. 5, pp. 742–758, Oct. 2014.
[4] F. Rusek, D. Persson, B. K. Lau, E. Larsson, T. Marzetta, O. Edfors,
and F. Tufvesson, “Scaling up MIMO: Opportunities and challenges with
very large arrays,” IEEE Signal Process. Mag., vol. 30, no. 1, pp. 40–60,
Jan. 2013.
[5] H. Yang and T. Marzetta, “Performance of conjugate and zero-forcing
beamforming in large-scale antenna systems,” IEEE J. Sel. Areas Com-
mun., vol. 31, no. 2, pp. 172–179, Feb. 2013.
[6] J. Hoydis, S. ten Brink, and M. Debbah, “Massive MIMO in the UL/DL
of cellular networks: How many antennas do we need?” IEEE J. Sel.
Areas Commun., vol. 31, no. 2, pp. 160–171, Feb. 2013.
[7] R. Muller, L. Cottatellucci, and M. Vehkapera, “Blind pilot decontami-
nation,” IEEE J. Sel. Topics Signal Process., vol. 8, no. 5, pp. 773–786,
Oct. 2014.
[8] E. Bj¨ornson, E. G. Larsson, and M. Debbah, “Massive MIMO for
maximal spectral efﬁciency: How many users and pilots should be
allocated?” IEEE Trans. Wireless Commun., vol. 15, no. 2, pp. 1293–
1308, Feb. 2016.

6
[9] H. Yin, D. Gesbert, M. Filippou, and Y. Liu, “A coordinated approach
to channel estimation in large-scale multiple-antenna systems,” IEEE J.
Sel. Areas Commun., vol. 31, no. 2, pp. 264–273, Feb. 2013.
[10] K. Upadhya, S. A. Vorobyov, and M. Vehkapera, “Superimposed pilots:
An alternative pilot structure to mitigate pilot contamination in massive
MIMO,” in Proc. IEEE Int. Conf. on Acoustics, Speech and Signal
Processing (ICASSP), Shanghai, Mar. 2016, pp. 3366–3370.
[11] ——, “Superimposed pilots are superior for mitigating pilot contamina-
tion in massive MIMO,” IEEE Trans. Signal Process., vol. 65, no. 11,
pp. 2917–2932, Jun. 2017.
[12] J. Jose, A. Ashikhmin, T. Marzetta, and S. Vishwanath, “Pilot contami-
nation and precoding in multi-cell TDD systems,” IEEE Trans. Wireless
Commun., vol. 10, no. 8, pp. 2640–2651, Aug. 2011.
[13] E. Bj¨ornson, J. Hoydis, and L. Sanguinetti, “Massive MIMO has
unlimited capacity,” IEEE Trans. Wireless Commun., To be published.
[Online]. Available: http://arxiv.org/abs/1705.00538
[14] E. Bj¨ornson, L. Sanguinetti, and M. Debbah, “Massive MIMO with
imperfect channel covariance information,” in Proc. Asilomar Conf. on
Signals, Systems and Computers, Nov. 2016, pp. 974–978.
[15] D. Neumann, K. Shibli, M. Joham, and W. Utschick, “Joint covariance
matrix estimation and pilot allocation in massive MIMO systems,” in
Proc. IEEE Int. Conf. on Communications (ICC), May 2017, pp. 1–6.
[16] S. Haghighatshoar and G. Caire, “Massive MIMO pilot decontamination
and channel interpolation via wideband sparse channel estimation,”
arXiv, 2017. [Online]. Available: http://arxiv.org/abs/1702.07207
[17] E. Bj¨ornson, J. Hoydis, and L. Sanguinetti, “Pilot contamination is not
a fundamental asymptotic limitation in massive MIMO,” in Proc. IEEE
Int. Conf. on Communications (ICC), May 2017, pp. 1–6.
[18] W. A. W. M. Mahyiddin, P. A. Martin, and P. J. Smith, “Performance
of synchronized and unsynchronized pilots in ﬁnite massive MIMO
systems,” IEEE Trans. Wireless Commun., vol. 14, no. 12, pp. 6763–
6776, Dec. 2015.
[19] D. Kong, D. Qu, K. Luo, and T. Jiang, “Channel estimation under
staggered frame structure for massive MIMO system,” IEEE Trans.
Wireless Commun., vol. 15, no. 2, pp. 1469–1479, Feb. 2016.
[20] K.
Upadhya,
S.
A.
Vorobyov,
and
M.
Vehkapera,
“Downlink
performance of superimposed pilots in massive MIMO systems,”
Submitted to IEEE Trans. Wireless Commun. [Online]. Available:
https://arxiv.org/pdf/1606.04476.pdf
